{"version":3,"sources":["cui-ng.js"],"names":["angular","module","provider","preferenceArray","listOfLocaleCodesAndNames","setLocalePreference","newPreferenceArray","setLocaleCodesAndNames","newPreferenceObject","getLocaleCodesAndNames","getInternationalizedName","preferedLanguage","languageObjectArray","languageObjectToUse","_","find","languageObject","lang","undefined","text","value","console","log","i","length","$get","paginationOptions","userValue","setPaginationOptions","valueArray","getPaginationOptions","setUserValue","localStorage","setItem","e","getUserValue","parseInt","getItem","factory","$timeout","alias","fn","closure","apply","arguments","PubSub","topics","subUid","subscribe","topic","callback","once","token","obj","push","subscribeOnce","publish","args","that","subscribers","len","unsubscribe","t","prop","tf","hasOwnProperty","splice","on","trigger","off","filter","LocaleService","$cuiI18n","getLocaleCode","directive","$q","$parse","$http","$sce","$templateCache","$interpolate","KEY_DW","KEY_RT","KEY_UP","KEY_LF","KEY_ES","KEY_EN","KEY_TAB","MIN_LENGTH","MAX_LENGTH","PAUSE","BLUR_TIMEOUT","REQUIRED_CLASS","TEXT_SEARCHING","TEXT_NORESULTS","TEMPLATE_URL","put","link","scope","elem","attrs","ctrl","inputField","minlength","searchTimer","hideTimer","requiredClassName","responseFormatter","validState","httpCanceller","dd","querySelector","isScrollOn","mousedownOn","unbindInitialValue","displaySearching","displayNoResults","event","target","id","document","body","addEventListener","clickoutHandlerForDropdown","className","currentIndex","focusFirst","searching","$watch","newval","handleInputChange","fieldRequired","oldval","inputName","$setValidity","$on","elementId","initial","searchStr","extractTitle","callOrAssign","originalObject","error","handleRequired","hideResults","removeEventListener","ie8EventNormalizer","which","keyCode","selectedObject","callFunctionOrIdentity","data","setInputString","str","clearSelected","clearResults","titleField","split","map","field","extractValue","join","key","keys","result","findMatchString","matches","re","RegExp","replace","match","toString","matchClass","trustAsHtml","valid","notEmpty","keyupHandler","preventDefault","showDropdown","initResults","searchTimerComplete","$apply","val","cancel","pause","handleOverrideSuggestions","overrideSuggestions","cancelHttpRequest","dropdownRowOffsetHeight","row","css","getComputedStyle","offsetHeight","marginTop","marginBottom","dropdownHeight","getBoundingClientRect","top","maxHeight","dropdownRow","querySelectorAll","dropdownRowTop","paddingTop","dropdownScrollTopTo","offset","scrollTop","updateInputField","current","results","title","keydownHandler","rowTop","selectResult","bottom","$digest","httpSuccessCallbackGen","responseData","status","headers","config","processResults","remoteUrlDataField","httpErrorCallback","errorRes","remoteUrlErrorCallback","resolve","getRemoteResults","params","url","remoteUrl","encodeURIComponent","remoteUrlRequestFormatter","remoteUrlRequestWithCredentials","withCredentials","defer","timeout","promise","get","success","getRemoteResultsWithCustomHandler","remoteApiHandler","then","catch","getLocalResults","s","searchFields","parseInput","localData","toLowerCase","indexOf","checkExactMatch","description","image","formattedText","formattedDesc","descriptionField","imageField","autoMatch","desc","showAll","onFocusHandler","focusIn","focusOut","resetHideResults","hoverRow","index","inputChangeHandler","inputChanged","fieldRequiredClass","initialValue","inputType","type","textSearching","textNoResults","maxlength","overflowY","restrict","require","disableInput","remoteUrlResponseFormatter","placeholder","inputClass","templateUrl","element","compile","tElement","startSym","startSymbol","endSym","endSymbol","interpolatedHtml","html","toggledClass","$id","elementClass","attr","checkIfToggled","toggled","toggleClass","toggleOn","toggleOff","$filter","cuiAvatar","cuiAvatarNames","cuiAvatarEmail","pre","selectors","$elem","colorClassPrefix","cuiAvatarColorClassPrefix","colorCount","cuiAvatarColorCount","cuiI18nFilter","isDefined","cuiAvatarCuii18nFilter","maxNumberOfInitials","cuiAvatarMaxNumInitials","watchers","newAvatar","update","newNameArray","newEmail","helpers","isColorClassApplied","classList","applyRandomColorClass","classNumberToApply","Math","floor","random","add","colorClassAdded","getInitialsToDisplay","internationalizedName","nameToDisplay","forEach","nameSection","toUpperCase","render","nameBackground","initials","innerHTML","$initials","childNodes","applyImage","imgSrc","remove","$image","style","backgroundImage","img","Image","src","onload","hashedEmail","md5","transclude","errorIf","loadingIf","successIf","disableIf","errorMessage","loadingMessage","successMessage","buttonClick","template","$compile","ngModel","options","constraints","newScope","dropdownScope","cuiDropdown","initScope","ngRequired","required","$validators","$viewValue","initWatcher","class","dropdownWrapperClass","dropdownClass","dropdownItemClass","attachment","targetAttachment","defaultConstraints","to","returnValue","displayValue","defaultOption","defaultOptionValue","$cuiDropdown","$body","dropdownClick","reassignModel","languageChange","handleLanguageChange","model","newModel","oldModel","indexInReturnValues","findIndex","getOptionReturnValues","newOptions","oldOptions","setInitialInputValue","currentValueBox","equals","toggleDropdown","$dropdown","dropdown","destroyDropdown","$destroy","detach","handleKeyup","getOptionDisplayValues","displayValues","$eval","displayScope","object","returnValues","returnScope","getDropdownItem","ngClick","$new","replaceWith","append","width","outerWidth","Tether","clone","innerScope","expandableBody","hide","toggleBody","animate","toggleExpand","tagName","labels","expand","expanded","collapse","newValue","oldValue","iconSets","iconSet","namespace","path","viewBox","getIconSets","getIconSet","Error","$cuiIcon","icon","cuiSvgIcon","preserveaspectratio","svgClass","useClass","viewbox","iconNamespace","iconId","newSvg","$","cuiPopoverHelpers","getResetStyles","getAttachmentFromPosition","position","invertAttachmentPartial","partial","parsePositionArray","positionArray","genericPositions","positions","Object","assign","parseOffset","splitOffset","verticalOffset","getOffsetAndUnitsOfOffset","horizontalOffset","parseAttachment","verticalAttachment","horizontalAttachment","getTetherOffset","amount","units","invertAttachment","offsetPartial","window","getPointerOffset","opts","offsetBetweenPointerAndContent","popoverHeight","popoverWidth","pointerHeight","pointerWidth","containerHeight","containerWidth","distanceBetweenTargetAndPopover","contentOffset","contentOffsetCompensation","topMargin","containerPadding","getContainerPaddings","pointerOffset","transform","ceil","parseFloat","right","left","getPointerBorderStyles","transparentHorizontalBorder","transparentVerticalBorder","getPointerStyles","colorOfPopoverBackground","stylesOfVisibleBorder","getPointer","$pointer","getPopoverMargins","margin","padding","paddingBottom","paddingRight","paddingLeft","verticalPadding","heightOfContainer","horizontalPadding","widthOfContainer","CuiPopoverHelpers","$interval","self","popoverTether","repositionedTether","tetherAttachmentInterval","targetElementPositionInterval","elementHtmlInterval","elementHtml","cuiPopoverConfig","positionInUse","trialPosition","cuiPopover","init","opacity","popoverPositions","popoverContainer","_this","targetModifier","outerHeight","popoverOffsetAttribute","popoverOffset","targetOffset","targetAndPopoverOffset","getTetherOptions","$container","newMode","contains","elemHtml","newHtml","targetElementPosition","targetPosition","$target","newPosition","oldPosition","scopeDestroy","destroy","$contentBox","contentBox","positionIndex","cloneElem","newContentBox","tryAnotherPosition","$cuiResizeHandler","$window","showIf","breakpoint","elementHandler","innerWidth","$evalAsync","getScreenState","customBreakpoint","getBreakpoint","resizeHandler","throttle","callHandlers","setHandler","onresize","destroyElement","resizeProvider","resizeHandlerFunctions","scopeId","handlerFunction","handler","getHandler","setBreakpoint","$pagination","cuiTableConfig","iElem","iAttrs","paginate","requiredOptions","requiredOption","initPageChangeHandler","pageChangeHandler","page","onPageChange","pageSize","newPageSize","oldPageSize","count","newRecordCount","oldRecordCount","reRenderPaginate","cancelWatcher","sorting","sortingCallbacks","cuiTableHeader","translatedHeader","header","noop","invertSortingDirection","sortType","headerCallbackHandler","sortBy","shouldShowCaret","defaults","cuiTreeNest0Class","cuiTreeNestXClass","cuiTreeLeafWrapper","cuiTreeLastLeafClass","cuiTreeBranchWrapper","cuiTreeLastBranchClass","cuiTreeNestPrefix","cuiTreeHelpers","getDisplayValue","cuiTreeLeafDisplay","propertiesToDisplay","getClassListForNestingLevel","nesting","getElements","objects","leafClickCallback","$node","$leafInner","$leafWrapper","children","$branchWrapper","cuiTree","$tree","cuiTreeLeafClickCallback","renderTree","tree","unbind","newTree","$rootScope","$document","numberOfSteps","invalidForm","mobileStack","$steps","bar","$indicatorContainer","clickableIndicators","minimumPadding","snap","$mobileSteps","$cuiExpandableTitle","$stepIndicatorContainer","currentStep","Number","attributes","step","wizardFinished","next","state","goToState","updateIndicators","updateBar","updateStep","calculateWhereToScroll","previous","goToStep","$broadcast","nextWithErrorChecking","form","nextState","$valid","$error","errorField","$setTouched","isNaN","createIndicators","createBar","createMobileStack","makeSureTheresRoom","watchForWindowResize","listenForLanguageChange","observeStepAttr","stepTitles","stepIcons","defaultString","stepStates","icons","div","cursor","compiled","$indicators","$bar","$barFill","scrollWidth","offsetLeft","ngIncludeSrc","newElement","debounce","func","wait","immediate","context","later","callNow","clearTimeout","setTimeout","getIndicatorsWidth","totalWidth","getIndicatorContainerWidth","clientWidth","onlyShowCurrentIndicator","showAllIndicators","indicatorsWidth","indicatorContainerWidth","max","bind","wizardOffset","titleHeight","clientHeight","snapOffset","scrollTo","bodyOffset","$set","$observe","newStep","cuiWizard","property","dirtyValidation","mobileStackBreakingPoint","$wizard","isFormValid","setErrorFieldsToDirty","setErrorFieldsToTouched","$setDirty","getStepInfo","$step","stepTitle","getIconMarkup","iconMarkup","getNgClickForIndicator","stepNumber","stepState","getIndicatorMarkup","indicatorClass","each","indicator","thereIsRoomForIndicators","reRender","stepsCollapsed","removeClass","addClass","mobileMode","$expandables","expandable","scrollToStep","firstExpandableTitle","firstExpandableOffset","scrollHeight","goToSate","windowResize","indicators","compiledIndicator","steps","stepInfo","expandableClass","insertBefore","appendTo","parent","oldStep","indicatorContainer","resize","customError","customErrorLoading","ele","promises","$modelValue","checkFunction","errorName","checkFunctionReturn","all","res","err","focus","condition","focusDelay","focusIf","display","saveCallback","tempEditCallback","hideSaveButton","inlineEdit","valueClass","labelClass","wrapperClass","edit","functions","toggleEdit","editChangeCallback","matchModels","editInput","saveInput","setDisplayValue","parseKeyCode","editMode","getLabel","label","name","getInput","optionsExpression","Array","checkIfMatch","values","newValues","oldValues","OffClickFilterCache","filters","offClickFilter","x","trim","listeners","touchMove","targetInFilter","elms","elmsLen","currentElem","containsTarget","compareDocumentPosition","Boolean","offClickEventHandler","srcElement","listener","elm","concat","cb","$event","offClick","elmId","removeWatcher","offClickIf","newVal","filterCache","onEnter","resultsPerPage","attachRerenderTo","resizeInterval","currentPage","normalizePage","updateConfig","pageContainer","updateConfigAndReRender","$paginate","pageClass","activePageClass","ellipsesClass","previousClass","previousNextClass","nextClass","pageContainerClass","ellipsesButton","ellipses","previousButton","nextButton","hidePagination","newCount","oldCount","newPage","oldPage","paginateResize","numberOfPages","getNumberOfPages","howManyPagesWeCanShow","getWidthOfAPage","getWidthOfElement","pageNumber","getAvailableSpaceForPages","paginateWidth","previousWidth","nextWidth","handleStepChange","whatEllipsesToShow","goToPage","$pageContainer","intervals","hidePaginationUnderMin","active","activeClass","button","pagesXToY","y","pages","pageNumbers","ellipsesPoint","ellipsesPointLeft","firstEllipsesPoint","secondEllipsesPoint","policies","info","CuiPasswordInfo","escape","validators","lowercase","modelValue","viewValue","getValidators","complex","test","uppercase","number","special","numberOfUsedClasses","allowLowerChars","allowUpperChars","allowSpecialChars","allowNumChars","requiredNumberOfCharClasses","lowercaseNotAllowed","uppercaseNotAllowed","numberNotAllowed","specialNotAllowed","disallowedChars","disallowedChar","disallowedWords","word","min","parsedPolicies","validator","passwordValidators","trueFunction","CuiPasswordValidators","policy","parse","newParsedPolicies","policyRulesObject","policyKey","CuiPasswordPolicies","passwordValidation","passwordValidationKey","newPasswordValidationRules","validationName","$validate","ngMessages","$watchCollection","newPasswordInfo","newPasswordPolicies","newErrorObject","errors","selected","selectClass","KEYS","backspace","tab","enter","space","up","down","delete","comma","MAX_SAFE_INTEGER","SUPPORTED_INPUT_TYPES","tagsInputConfig","tiUtil","TagList","events","onTagAdding","onTagRemoving","getTagText","setTagText","tagIsValid","tag","safeToString","displayProperty","tagText","minLength","maxLength","allowedTagsPattern","findInObjectArray","items","keyProperty","$tag","addText","replaceSpacesWithDashes","clearSelection","select","selectPrior","selectNext","removeSelected","validateType","tags","onTagAdded","onInvalidTag","onTagRemoved","onTagClicked","controller","$scope","$attrs","$element","simplePubSub","load","String","tabindex","removeTagSymbol","fromCharCode","addOnEnter","addOnSpace","addOnComma","addOnBlur","addOnPaste","pasteSplitPattern","enableEditingLastTag","minTags","maxTags","allowLeftoverText","addFromAutocompleteOnly","spellcheck","tagList","handleUndefinedResult","registerAutocomplete","input","addTag","focusInput","getTags","getCurrentTagText","newTag","getOptions","registerTagItem","removeTag","disabled","ngModelCtrl","hotkeys","validationOptions","setElementValidity","hasFocus","$isEmpty","invalid","track","makeObjectArray","eventHandlers","keydown","blur","activeElement","lostFocusToBrowserWindow","lostFocusToChildElement","paste","getTextData","clipboardData","originalEvent","getData","host","click","triggerHandler","addKeys","shouldAdd","shouldRemove","shouldSelect","shouldEditLastTag","isModifierOn","tagsInputCtrl","tagsInput","$$template","$$removeTagSymbol","$getDisplayText","$removeTag","$index","SuggestionList","loadFn","getDifference","lastPromise","getTagId","array1","array2","item","a","b","defaultComparer","reset","visible","query","show","selectFirstMatch","when","$query","slice","maxResultsToShow","debounceDelay","scrollToElement","root","eq","elementTop","elementHeight","parentHeight","parentScrollTop","source","highlightMatchedText","loadOnDownArrow","loadOnEmpty","loadOnFocus","suggestionList","registerAutocompleteMatch","getQuery","shouldLoadSuggestions","addSuggestionByIndex","addSuggestion","added","copy","handled","stopImmediatePropagation","autoCompleteCtrl","autoComplete","$parent","$highlight","safeHighlight","transcludeFn","threshold","getTextAutosizeThreshold","span","originalValue","isString","$parsers","unshift","$formatters","tiBindAttrs","globalDefaults","interpolationStatus","autosizeThreshold","setDefaults","setActiveInterpolation","setTextAutosizeThreshold","converters","defaultValidator","localDefault","converter","getDefault","updateValue","globalValue","delay","timeoutId","array","isArray","isObject","newArray","comparer","some","escapeRegexChars","encodeHTML","expression","isUndefined","valueIfUndefined","shiftKey","ctrlKey","altKey","metaKey","names","handlers","every","run","tether","$state","uiSrefActiveForClasses","handleStateChange","toState","uiSrefActiveFor","unsub","parentState","uiSref","applyActiveClassIfNestedState","uiSrefActiveNested","stateName","toParams","fromState","fromParams","go","notify","authorize","routing","userEntitlements","loginRequiredState","nonAuthState","authorized","access","loginRequired","requiredEntitlements","entitlementType","loweredPermissions","hasPermission","permission","cuiAccess","notAuthorizedClasses","initalDisplay","giveAuth","removeAuth"],"mappings":"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","file":"cui-ng.js","sourcesContent":["\n\n// cui-ng build Thu Feb 02 2017 15:24:31\n\n;(function(angular){\n    'use strict'\n    angular.module('cui-ng',[])\n\nangular.module('cui-ng')\n.provider('$cuiI18n',[function(){\n    var preferenceArray,listOfLocaleCodesAndNames;\n\n    this.setLocalePreference=function(newPreferenceArray){\n        preferenceArray=newPreferenceArray;\n    };\n\n    this.setLocaleCodesAndNames=function(newPreferenceObject){\n        listOfLocaleCodesAndNames=newPreferenceObject;\n    };\n\n    this.getLocaleCodesAndNames=function(){\n        return listOfLocaleCodesAndNames;\n    };\n\n    this.getInternationalizedName=function(preferedLanguage,languageObjectArray){\n        var languageObjectToUse;\n        languageObjectToUse = _.find(languageObjectArray,function(languageObject){\n            return languageObject.lang===preferedLanguage;\n        })\n        if (languageObjectToUse!=undefined) return languageObjectToUse.text || languageObjectToUse.value; // if the language being used by the user has a translation\n        else {\n            if(!preferenceArray) { // if a preference array hasn't been set\n                console.log('You need to configure you prefered language array with cuiI18n.setLocalePreference');\n                return;\n            }\n            for(var i=0;i <= preferenceArray.length;i++){\n                languageObjectToUse = _.find(languageObjectArray,function(languageObject){\n                    return languageObject.lang===preferenceArray[i];\n                });\n                if(languageObjectToUse!=undefined) return languageObjectToUse.text || languageObjectToUse.value;\n            }\n        }\n    };\n\n    this.$get = function(){\n        return this;\n    };\n}]);\n\nangular.module('cui-ng')\n.provider('$pagination', [function() {\n    let paginationOptions;\n    let userValue;\n\n    this.setPaginationOptions = (valueArray) => {\n        paginationOptions = valueArray;\n    };\n\n    this.getPaginationOptions = () => {\n        return paginationOptions\n    };\n\n    this.setUserValue = (value) => { // sets the user value so that other pages that use that directive will have that value saved\n        try {\n            localStorage.setItem('cui.resultsPerPage',value);\n        }\n        catch (e){ }\n        userValue = value;\n    };\n\n    this.getUserValue = () => {\n        try {\n            userValue = parseInt(localStorage.getItem('cui.resultsPerPage'));\n        }\n        catch (e){ }\n        return userValue;\n    }\n\n    this.$get = () => this;\n}])\n\n\nangular.module('cui-ng')\n.factory('PubSub', ['$timeout', function ($timeout) {\n    /**\n     * Alias a method while keeping the context correct,\n     * to allow for overwriting of target method.\n     *\n     * @param {String} fn The name of the target method.\n     * @returns {Function} The aliased method.\n     */\n    function alias(fn) {\n        return function closure () {\n            return this[fn].apply(this, arguments);\n        };\n    }\n\n    var PubSub = {\n        topics: {},    // Storage for topics that can be broadcast or listened to.\n        subUid: -1     // A topic identifier.\n    };\n\n    /**\n     * Subscribe to events of interest with a specific topic name and a\n     * callback function, to be executed when the topic/event is observed.\n     *\n     * @param topic {String} The topic name.\n     * @param callback {Function} Callback function to execute on event.\n     * @param once {Boolean} Checks if event will be triggered only one time (optional).\n     * @returns number token\n     */\n    PubSub.subscribe = function (topic, callback, once) {\n        var token = (this.subUid += 1),\n            obj = {};\n\n        if (!this.topics[topic]) {\n            this.topics[topic] = [];\n        }\n\n        obj.token = token;\n        obj.callback = callback;\n        obj.once = !!once;\n\n        this.topics[topic].push(obj);\n\n        return token;\n    };\n\n    /**\n     * Subscribe to events of interest setting a flag\n     * indicating the event will be published only one time.\n     *\n     * @param topic {String} The topic name.\n     * @param callback {Function} Callback function to execute on event.\n     */\n    PubSub.subscribeOnce = function (topic, callback) {\n        return this.subscribe(topic, callback, true);\n    };\n\n    /**\n     * Publish or broadcast events of interest with a specific\n     * topic name and arguments such as the data to pass along.\n     *\n     * @param topic {String} The topic name.\n     * @param args {Object || Array} The data to be passed.\n     * @return bool false if topic does not exist.\n     * @returns bool true if topic exists and event is published.\n     */\n    PubSub.publish = function (topic, args) {\n        var that = this,\n            subscribers,\n            len;\n\n        if (!this.topics[topic]) {\n            return false;\n        }\n\n        $timeout(function () {\n            subscribers = that.topics[topic];\n            len = subscribers ? subscribers.length : 0;\n\n            while (len) {\n                len -= 1;\n                subscribers[len].callback(topic, args);\n\n                // Unsubscribe from event based on tokenized reference,\n                // if subscriber's property once is set to true.\n                if (subscribers[len].once === true) {\n                    that.unsubscribe(subscribers[len].token);\n                }\n            }\n        }, 0);\n\n        return true;\n    };\n\n    /**\n     * Unsubscribe from a specific topic, based on  the topic name,\n     * or based on a tokenized reference to the subscription.\n     *\n     * @param t {String || Object} Topic name or subscription referenece.\n     * @returns {*} bool false if argument passed does not match a subscribed event.\n     */\n    PubSub.unsubscribe = function (t) {\n        var prop,\n            len,\n            tf = false;\n\n        for (prop in this.topics) {\n            if (this.topics.hasOwnProperty(prop)) {\n                if (this.topics[prop]) {\n                    len = this.topics[prop].length;\n\n                    while (len) {\n                        len -= 1;\n\n                        // If t is a tokenized reference to the subscription.\n                        // Removes one subscription from the array.\n                        if (this.topics[prop][len].token === t) {\n                            this.topics[prop].splice(len, 1);\n                            return t;\n                        }\n\n                        // If t is the event type.\n                        // Removes all the subscriptions that match the event type.\n                        if (prop === t) {\n                            this.topics[prop].splice(len, 1);\n                            tf = true;\n                        }\n                    }\n\n                    if (tf === true) {\n                        return t;\n                    }\n                }\n            }\n        }\n\n        return false;\n    };\n\n    /**\n     * Alias for public methods.\n     * subscribe     -> on\n     * subscribeOnce -> once\n     * publish       -> trigger\n     * unsubscribe   -> off\n     */\n    PubSub.on = alias('subscribe');\n    PubSub.once = alias('subscribeOnce');\n    PubSub.trigger = alias('publish');\n    PubSub.off = alias('unsubscribe');\n\n    return PubSub;\n}]);\n\nangular.module('cui-ng')\n.filter('cuiI18n',['LocaleService','$cuiI18n',function(LocaleService,$cuiI18n){\n    return function(languageObjectArray){\n        return $cuiI18n.getInternationalizedName(LocaleService.getLocaleCode(),languageObjectArray);\n    }\n}]);\n\nangular.module('cui-ng')\n.directive('autoComplete', ['$q', '$parse', '$http', '$sce', '$timeout', '$templateCache', '$interpolate', function ($q, $parse, $http, $sce, $timeout, $templateCache, $interpolate) {\n    // keyboard events\n    var KEY_DW  = 40;\n    var KEY_RT  = 39;\n    var KEY_UP  = 38;\n    var KEY_LF  = 37;\n    var KEY_ES  = 27;\n    var KEY_EN  = 13;\n    var KEY_TAB =  9;\n\n    var MIN_LENGTH = 3;\n    var MAX_LENGTH = 524288;  // the default max length per the html maxlength attribute\n    var PAUSE = 500;\n    var BLUR_TIMEOUT = 200;\n\n    // string constants\n    var REQUIRED_CLASS = 'autocomplete-required';\n    var TEXT_SEARCHING = 'Searching...';\n    var TEXT_NORESULTS = 'No results found';\n    var TEMPLATE_URL = '/angucomplete-alt/index.html';\n\n    // Set the default template for this directive\n    $templateCache.put(TEMPLATE_URL,\n        '<div class=\"angucomplete-holder\" ng-class=\"{\\'angucomplete-dropdown-visible\\': showDropdown}\">' +\n        '  <input id=\"{{id}}_value\" name=\"{{inputName}}\" ng-class=\"{\\'ng-valid\\': notEmpty}\" ng-model=\"searchStr\" ng-disabled=\"disableInput\" type=\"{{inputType}}\" placeholder=\"{{placeholder}}\" maxlength=\"{{maxlength}}\" ng-focus=\"onFocusHandler()\" class=\"{{inputClass}}\" ng-focus=\"resetHideResults()\" ng-blur=\"hideResults($event)\" autocapitalize=\"off\" autocorrect=\"off\" autocomplete=\"off\" ng-change=\"inputChangeHandler(searchStr)\"/>' +\n        '  <div id=\"{{id}}_dropdown\" class=\"angucomplete-dropdown\" ng-show=\"showDropdown\">' +\n        '    <div class=\"angucomplete-searching\" ng-show=\"searching\" ng-bind=\"textSearching\"></div>' +\n        '    <div class=\"angucomplete-searching\" ng-show=\"!searching && (!results || results.length == 0)\" ng-bind=\"textNoResults\"></div>' +\n        '    <div class=\"angucomplete-row\" ng-repeat=\"result in results\" ng-click=\"selectResult(result)\" ng-mouseenter=\"hoverRow($index)\" ng-class=\"{\\'angucomplete-selected-row\\': $index == currentIndex}\">' +\n        '      <div ng-if=\"imageField\" class=\"angucomplete-image-holder\">' +\n        '        <img ng-if=\"result.image && result.image != \\'\\'\" ng-src=\"{{result.image}}\" class=\"angucomplete-image\"/>' +\n        '        <div ng-if=\"!result.image && result.image != \\'\\'\" class=\"angucomplete-image-default\"></div>' +\n        '      </div>' +\n        '      <div class=\"angucomplete-title\" ng-if=\"matchClass\" ng-bind-html=\"result.title\"></div>' +\n        '      <div class=\"angucomplete-title\" ng-if=\"!matchClass\">{{ result.title }}</div>' +\n        '      <div ng-if=\"matchClass && result.description && result.description != \\'\\'\" class=\"angucomplete-description\" ng-bind-html=\"result.description\"></div>' +\n        '      <div ng-if=\"!matchClass && result.description && result.description != \\'\\'\" class=\"angucomplete-description\">{{result.description}}</div>' +\n        '    </div>' +\n        '  </div>' +\n        '</div>'\n    );\n\n    function link(scope, elem, attrs, ctrl) {\n      var inputField = elem.find('input');\n      var minlength = MIN_LENGTH;\n      var searchTimer = null;\n      var hideTimer;\n      var requiredClassName = REQUIRED_CLASS;\n      var responseFormatter;\n      var validState = null;\n      var httpCanceller = null;\n      var dd = elem[0].querySelector('.angucomplete-dropdown');\n      var isScrollOn = false;\n      var mousedownOn = null;\n      var unbindInitialValue;\n      var displaySearching;\n      var displayNoResults;\n\n      elem.on('mousedown', function(event) {\n        if (event.target.id) {\n          mousedownOn = event.target.id;\n          if (mousedownOn === scope.id + '_dropdown') {\n            document.body.addEventListener('click', clickoutHandlerForDropdown);\n          }\n        }\n        else {\n          mousedownOn = event.target.className;\n        }\n      });\n\n      scope.currentIndex = scope.focusFirst ? 0 : null;\n      scope.searching = false;\n      unbindInitialValue = scope.$watch('initialValue', function(newval) {\n        if (newval) {\n          // remove scope listener\n          unbindInitialValue();\n          // change input\n          handleInputChange(newval, true);\n        }\n      });\n\n      if(attrs.fieldRequired!==undefined){\n        scope.$watch('fieldRequired', function(newval, oldval) {\n          if (!newval || newval==={}) {\n            ctrl[scope.inputName].$setValidity('required', false);\n          }\n          else if (newval && newval!=={}){\n            ctrl[scope.inputName].$setValidity('required', true);\n          }\n        });\n      }\n\n      scope.$on('angucomplete-alt:changeInput', function (event, elementId, newval) {\n        if (!!elementId && elementId === scope.id) {\n          handleInputChange(newval);\n        }\n      });\n\n      function handleInputChange(newval, initial) {\n        if (newval) {\n          if (typeof newval === 'object') {\n            scope.searchStr = extractTitle(newval);\n            callOrAssign({originalObject: newval});\n          } else if (typeof newval === 'string' && newval.length > 0) {\n            scope.searchStr = newval;\n          } else {\n            if (console && console.error) {\n              console.error('Tried to set ' + (!!initial ? 'initial' : '') + ' value of angucomplete to', newval, 'which is an invalid value');\n            }\n          }\n\n          handleRequired(true);\n        }\n      }\n\n      // #194 dropdown list not consistent in collapsing (bug).\n      function clickoutHandlerForDropdown(event) {\n        mousedownOn = null;\n        scope.hideResults(event);\n        document.body.removeEventListener('click', clickoutHandlerForDropdown);\n      }\n\n      // for IE8 quirkiness about event.which\n      function ie8EventNormalizer(event) {\n        return event.which ? event.which : event.keyCode;\n      }\n\n      function callOrAssign(value) {\n        if (typeof scope.selectedObject === 'function') {\n          scope.selectedObject(value);\n        }\n        else {\n          scope.selectedObject = value;\n        }\n\n        if (value) {\n          handleRequired(true);\n        }\n        else {\n          handleRequired(false);\n        }\n      }\n\n      function callFunctionOrIdentity(fn) {\n        return function(data) {\n          return scope[fn] ? scope[fn](data) : data;\n        };\n      }\n\n      function setInputString(str) {\n        callOrAssign({originalObject: str});\n\n        if (scope.clearSelected) {\n          scope.searchStr = null;\n        }\n        clearResults();\n      }\n\n      function extractTitle(data) {\n        // split title fields and run extractValue for each and join with ' '\n        return scope.titleField.split(',')\n          .map(function(field) {\n            return extractValue(data, field);\n          })\n          .join(' ');\n      }\n\n      function extractValue(obj, key) {\n        var keys, result;\n        if (key) {\n          keys= key.split('.');\n          result = obj;\n          for (var i = 0; i < keys.length; i++) {\n            result = result[keys[i]];\n          }\n        }\n        else {\n          result = obj;\n        }\n        return result;\n      }\n\n      function findMatchString(target, str) {\n        var result, matches, re;\n        // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions\n        // Escape user input to be treated as a literal string within a regular expression\n        re = new RegExp(str.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'), 'i');\n        if (!target) { return; }\n        if (!target.match || !target.replace) { target = target.toString(); }\n        matches = target.match(re);\n        if (matches) {\n          result = target.replace(re,\n              '<span class=\"'+ scope.matchClass +'\">'+ matches[0] +'</span>');\n        }\n        else {\n          result = target;\n        }\n        return $sce.trustAsHtml(result);\n      }\n\n      function handleRequired(valid) {\n        scope.notEmpty = valid;\n        validState = scope.searchStr;\n      }\n\n      function keyupHandler(event) {\n        var which = ie8EventNormalizer(event);\n        if (which === KEY_LF || which === KEY_RT) {\n          // do nothing\n          return;\n        }\n\n        if (which === KEY_UP || which === KEY_EN) {\n          event.preventDefault();\n        }\n        else if (which === KEY_DW) {\n          event.preventDefault();\n          if (!scope.showDropdown && scope.searchStr && scope.searchStr.length >= minlength) {\n            initResults();\n            scope.searching = true;\n            searchTimerComplete(scope.searchStr);\n          }\n        }\n        else if (which === KEY_ES) {\n          clearResults();\n          scope.$apply(function() {\n            inputField.val(scope.searchStr);\n          });\n        }\n        else {\n          if (minlength === 0 && !scope.searchStr) {\n            return;\n          }\n\n          if (!scope.searchStr || scope.searchStr === '') {\n            scope.showDropdown = false;\n          } else if (scope.searchStr.length >= minlength) {\n            initResults();\n\n            if (searchTimer) {\n              $timeout.cancel(searchTimer);\n            }\n\n            scope.searching = true;\n\n            searchTimer = $timeout(function() {\n              searchTimerComplete(scope.searchStr);\n            }, scope.pause);\n          }\n\n          if (validState && validState !== scope.searchStr && !scope.clearSelected) {\n            scope.$apply(function() {\n              callOrAssign();\n            });\n          }\n        }\n      }\n\n      function handleOverrideSuggestions(event) {\n        if (scope.overrideSuggestions &&\n            !(scope.selectedObject && scope.selectedObject.originalObject === scope.searchStr)) {\n          if (event) {\n            event.preventDefault();\n          }\n\n          // cancel search timer\n          $timeout.cancel(searchTimer);\n          // cancel http request\n          cancelHttpRequest();\n\n          setInputString(scope.searchStr);\n        }\n      }\n\n      function dropdownRowOffsetHeight(row) {\n        var css = getComputedStyle(row);\n        return row.offsetHeight +\n          parseInt(css.marginTop, 10) + parseInt(css.marginBottom, 10);\n      }\n\n      function dropdownHeight() {\n        return dd.getBoundingClientRect().top +\n          parseInt(getComputedStyle(dd).maxHeight, 10);\n      }\n\n      function dropdownRow() {\n        return elem[0].querySelectorAll('.angucomplete-row')[scope.currentIndex];\n      }\n\n      function dropdownRowTop() {\n        return dropdownRow().getBoundingClientRect().top -\n          (dd.getBoundingClientRect().top +\n           parseInt(getComputedStyle(dd).paddingTop, 10));\n      }\n\n      function dropdownScrollTopTo(offset) {\n        dd.scrollTop = dd.scrollTop + offset;\n      }\n\n      function updateInputField(){\n        var current = scope.results[scope.currentIndex];\n        if (scope.matchClass) {\n          inputField.val(extractTitle(current.originalObject));\n        }\n        else {\n          inputField.val(current.title);\n        }\n      }\n\n      function keydownHandler(event) {\n        var which = ie8EventNormalizer(event);\n        var row = null;\n        var rowTop = null;\n\n        if (which === KEY_EN && scope.results) {\n          if (scope.currentIndex >= 0 && scope.currentIndex < scope.results.length) {\n            event.preventDefault();\n            scope.selectResult(scope.results[scope.currentIndex]);\n          } else {\n            handleOverrideSuggestions(event);\n            clearResults();\n          }\n          scope.$apply();\n        } else if (which === KEY_DW && scope.results) {\n          event.preventDefault();\n          if ((scope.currentIndex + 1) < scope.results.length && scope.showDropdown) {\n            scope.$apply(function() {\n              scope.currentIndex ++;\n              updateInputField();\n            });\n\n            if (isScrollOn) {\n              row = dropdownRow();\n              if (dropdownHeight() < row.getBoundingClientRect().bottom) {\n                dropdownScrollTopTo(dropdownRowOffsetHeight(row));\n              }\n            }\n          }\n        } else if (which === KEY_UP && scope.results) {\n          event.preventDefault();\n          if (scope.currentIndex >= 1) {\n            scope.$apply(function() {\n              scope.currentIndex --;\n              updateInputField();\n            });\n\n            if (isScrollOn) {\n              rowTop = dropdownRowTop();\n              if (rowTop < 0) {\n                dropdownScrollTopTo(rowTop - 1);\n              }\n            }\n          }\n          else if (scope.currentIndex === 0) {\n            scope.$apply(function() {\n              scope.currentIndex = -1;\n              inputField.val(scope.searchStr);\n            });\n          }\n        } else if (which === KEY_TAB) {\n          if (scope.results && scope.results.length > 0 && scope.showDropdown) {\n            if (scope.currentIndex === -1 && scope.overrideSuggestions) {\n              // intentionally not sending event so that it does not\n              // prevent default tab behavior\n              handleOverrideSuggestions();\n            }\n            else {\n              if (scope.currentIndex === -1) {\n                scope.currentIndex = 0;\n              }\n              scope.selectResult(scope.results[scope.currentIndex]);\n              scope.$digest();\n            }\n          }\n          else {\n            // no results\n            // intentionally not sending event so that it does not\n            // prevent default tab behavior\n            if (scope.searchStr && scope.searchStr.length > 0) {\n              handleOverrideSuggestions();\n            }\n          }\n        } else if (which === KEY_ES) {\n          // This is very specific to IE10/11 #272\n          // without this, IE clears the input text\n          event.preventDefault();\n        }\n      }\n\n      function httpSuccessCallbackGen(str) {\n        return function(responseData, status, headers, config) {\n          // normalize return obejct from promise\n          if (!status && !headers && !config && responseData.data) {\n            responseData = responseData.data;\n          }\n          scope.searching = false;\n          processResults(\n            extractValue(responseFormatter(responseData), scope.remoteUrlDataField),\n            str);\n        };\n      }\n\n      function httpErrorCallback(errorRes, status, headers, config) {\n        // cancelled/aborted\n        if (status === 0 || status === -1) { return; }\n\n        // normalize return obejct from promise\n        if (!status && !headers && !config) {\n          status = errorRes.status;\n        }\n        if (scope.remoteUrlErrorCallback) {\n          scope.remoteUrlErrorCallback(errorRes, status, headers, config);\n        }\n        else {\n          if (console && console.error) {\n            console.error('http error');\n          }\n        }\n      }\n\n      function cancelHttpRequest() {\n        if (httpCanceller) {\n          httpCanceller.resolve();\n        }\n      }\n\n      function getRemoteResults(str) {\n        var params = {},\n            url = scope.remoteUrl + encodeURIComponent(str);\n        if (scope.remoteUrlRequestFormatter) {\n          params = {params: scope.remoteUrlRequestFormatter(str)};\n          url = scope.remoteUrl;\n        }\n        if (!!scope.remoteUrlRequestWithCredentials) {\n          params.withCredentials = true;\n        }\n        cancelHttpRequest();\n        httpCanceller = $q.defer();\n        params.timeout = httpCanceller.promise;\n        $http.get(url, params)\n          .success(httpSuccessCallbackGen(str))\n          .error(httpErrorCallback);\n      }\n\n      function getRemoteResultsWithCustomHandler(str) {\n        cancelHttpRequest();\n\n        httpCanceller = $q.defer();\n\n        scope.remoteApiHandler(str, httpCanceller.promise)\n          .then(httpSuccessCallbackGen(str))\n          .catch(httpErrorCallback);\n\n        /* IE8 compatible\n        scope.remoteApiHandler(str, httpCanceller.promise)\n          ['then'](httpSuccessCallbackGen(str))\n          ['catch'](httpErrorCallback);\n        */\n      }\n\n      function clearResults() {\n        scope.showDropdown = false;\n        scope.results = [];\n        if (dd) {\n          dd.scrollTop = 0;\n        }\n      }\n\n      function initResults() {\n        scope.showDropdown = displaySearching;\n        scope.currentIndex = scope.focusFirst ? 0 : -1;\n        scope.results = [];\n      }\n\n      function getLocalResults(str) {\n        var i, match, s, value,\n            searchFields = scope.searchFields.split(','),\n            matches = [];\n        if (typeof scope.parseInput() !== 'undefined') {\n          str = scope.parseInput()(str);\n        }\n        for (i = 0; i < scope.localData.length; i++) {\n          match = false;\n\n          for (s = 0; s < searchFields.length; s++) {\n            value = extractValue(scope.localData[i], searchFields[s]) || '';\n            match = match || (value.toString().toLowerCase().indexOf(str.toString().toLowerCase()) >= 0);\n          }\n\n          if (match) {\n            matches[matches.length] = scope.localData[i];\n          }\n        }\n\n        scope.searching = false;\n        processResults(matches, str);\n      }\n\n      function checkExactMatch(result, obj, str){\n        if (!str) { return false; }\n        for(var key in obj){\n          if(obj[key].toLowerCase() === str.toLowerCase()){\n            scope.selectResult(result);\n            return true;\n          }\n        }\n        return false;\n      }\n\n      function searchTimerComplete(str) {\n        // Begin the search\n        if (!str || str.length < minlength) {\n          return;\n        }\n        if (scope.localData) {\n          scope.$apply(function() {\n            getLocalResults(str);\n          });\n        }\n        else if (scope.remoteApiHandler) {\n          getRemoteResultsWithCustomHandler(str);\n        } else {\n          getRemoteResults(str);\n        }\n      }\n\n      function processResults(responseData, str) {\n        var i, description, image, text, formattedText, formattedDesc;\n\n        if (responseData && responseData.length > 0) {\n          scope.results = [];\n\n          for (i = 0; i < responseData.length; i++) {\n            if (scope.titleField && scope.titleField !== '') {\n              text = formattedText = extractTitle(responseData[i]);\n            }\n\n            description = '';\n            if (scope.descriptionField) {\n              description = formattedDesc = extractValue(responseData[i], scope.descriptionField);\n            }\n\n            image = '';\n            if (scope.imageField) {\n              image = extractValue(responseData[i], scope.imageField);\n            }\n\n            if (scope.matchClass) {\n              formattedText = findMatchString(text, str);\n              formattedDesc = findMatchString(description, str);\n            }\n\n            scope.results[scope.results.length] = {\n              title: formattedText,\n              description: formattedDesc,\n              image: image,\n              originalObject: responseData[i]\n            };\n          }\n\n        } else {\n          scope.results = [];\n        }\n\n        if (scope.autoMatch && scope.results.length === 1 &&\n            checkExactMatch(scope.results[0],\n              {title: text, desc: description || ''}, scope.searchStr)) {\n          scope.showDropdown = false;\n        } else if (scope.results.length === 0 && !displayNoResults) {\n          scope.showDropdown = false;\n        } else {\n          scope.showDropdown = true;\n        }\n      }\n\n      function showAll() {\n        if (scope.localData) {\n          processResults(scope.localData, '');\n        }\n        else if (scope.remoteApiHandler) {\n          getRemoteResultsWithCustomHandler('');\n        }\n        else {\n          getRemoteResults('');\n        }\n      }\n\n      scope.onFocusHandler = function() {\n        if (scope.focusIn) {\n          scope.focusIn();\n        }\n        if (minlength === 0 && (!scope.searchStr || scope.searchStr.length === 0)) {\n          scope.currentIndex = scope.focusFirst ? 0 : scope.currentIndex;\n          scope.showDropdown = true;\n          showAll();\n        }\n      };\n\n      scope.hideResults = function() {\n        if (mousedownOn &&\n            (mousedownOn === scope.id + '_dropdown' ||\n             mousedownOn.indexOf('angucomplete') >= 0)) {\n          mousedownOn = null;\n        }\n        else {\n          hideTimer = $timeout(function() {\n            clearResults();\n            scope.$apply(function() {\n              if (scope.searchStr && scope.searchStr.length > 0) {\n                inputField.val(scope.searchStr);\n              }\n            });\n          }, BLUR_TIMEOUT);\n          cancelHttpRequest();\n\n          if (scope.focusOut) {\n            scope.focusOut();\n          }\n\n          if (scope.overrideSuggestions) {\n            if (scope.searchStr && scope.searchStr.length > 0 && scope.currentIndex === -1) {\n              handleOverrideSuggestions();\n            }\n          }\n        }\n      };\n\n      scope.resetHideResults = function() {\n        if (hideTimer) {\n          $timeout.cancel(hideTimer);\n        }\n      };\n\n      scope.hoverRow = function(index) {\n        scope.currentIndex = index;\n      };\n\n      scope.selectResult = function(result) {\n        // Restore original values\n        if (scope.matchClass) {\n          result.title = extractTitle(result.originalObject);\n          result.description = extractValue(result.originalObject, scope.descriptionField);\n        }\n\n        if (scope.clearSelected) {\n          scope.searchStr = null;\n        }\n        else {\n          scope.searchStr = result.title;\n        }\n        callOrAssign(result);\n        clearResults();\n      };\n\n      scope.inputChangeHandler = function(str) {\n        if (str.length < minlength) {\n          cancelHttpRequest();\n          clearResults();\n        }\n        else if (str.length === 0 && minlength === 0) {\n          scope.searching = false;\n          showAll();\n        }\n\n        if (scope.inputChanged) {\n          str = scope.inputChanged(str);\n        }\n        return str;\n      };\n\n      // check required\n      if (scope.fieldRequiredClass && scope.fieldRequiredClass !== '') {\n        requiredClassName = scope.fieldRequiredClass;\n      }\n\n      // check min length\n      if (scope.minlength && scope.minlength !== '') {\n        minlength = parseInt(scope.minlength, 10);\n      }\n\n      // check pause time\n      if (!scope.pause) {\n        scope.pause = PAUSE;\n      }\n\n      // check clearSelected\n      if (!scope.clearSelected) {\n        scope.clearSelected = false;\n      }\n\n      // check override suggestions\n      if (!scope.overrideSuggestions) {\n        scope.overrideSuggestions = false;\n      }\n\n      // check required field\n      if (scope.fieldRequired && ctrl) {\n        // check initial value, if given, set validitity to true\n        if (scope.initialValue) {\n          handleRequired(true);\n        }\n        else {\n          handleRequired(false);\n        }\n      }\n\n      scope.inputType = attrs.type ? attrs.type : 'text';\n\n      // set strings for \"Searching...\" and \"No results\"\n      scope.textSearching = attrs.textSearching ? attrs.textSearching : TEXT_SEARCHING;\n      scope.textNoResults = attrs.textNoResults ? attrs.textNoResults : TEXT_NORESULTS;\n      displaySearching = scope.textSearching === 'false' ? false : true;\n      displayNoResults = scope.textNoResults === 'false' ? false : true;\n\n      // set max length (default to maxlength deault from html\n      scope.maxlength = attrs.maxlength ? attrs.maxlength : MAX_LENGTH;\n\n      // register events\n      inputField.on('keydown', keydownHandler);\n      inputField.on('keyup', keyupHandler);\n\n      // set response formatter\n      responseFormatter = callFunctionOrIdentity('remoteUrlResponseFormatter');\n\n      // set isScrollOn\n      $timeout(function() {\n        var css = getComputedStyle(dd);\n        isScrollOn = css.maxHeight && css.overflowY === 'auto';\n      });\n    }\n\n    return {\n      restrict: 'EA',\n      require: '^?form',\n      scope: {\n        selectedObject: '=',\n        disableInput: '=',\n        initialValue: '=',\n        localData: '=',\n        remoteUrlRequestFormatter: '=',\n        remoteUrlRequestWithCredentials: '@',\n        remoteUrlResponseFormatter: '=',\n        remoteUrlErrorCallback: '=',\n        remoteApiHandler: '=',\n        id: '@',\n        type: '@',\n        placeholder: '@',\n        remoteUrl: '@',\n        remoteUrlDataField: '@',\n        titleField: '@',\n        descriptionField: '@',\n        imageField: '@',\n        inputClass: '@',\n        pause: '@',\n        searchFields: '@',\n        minlength: '@',\n        matchClass: '@',\n        clearSelected: '@',\n        overrideSuggestions: '@',\n        fieldRequired: '=',\n        fieldRequiredClass: '@',\n        inputChanged: '=',\n        autoMatch: '@',\n        focusOut: '&',\n        focusIn: '&',\n        inputName: '@',\n        focusFirst: '@',\n        parseInput: '&'\n      },\n      templateUrl: function(element, attrs) {\n        return attrs.templateUrl || TEMPLATE_URL;\n      },\n      compile: function(tElement) {\n        var startSym = $interpolate.startSymbol();\n        var endSym = $interpolate.endSymbol();\n        if (!(startSym === '{{' && endSym === '}}')) {\n          var interpolatedHtml = tElement.html()\n            .replace(/\\{\\{/g, startSym)\n            .replace(/\\}\\}/g, endSym);\n          tElement.html(interpolatedHtml);\n        }\n        return link;\n      }\n    };\n}]);\n\n\n\n\n\nangular.module('cui-ng')\n.directive('classToggle', () => {\n    return {\n        restrict: 'EAC',\n        scope: true,\n        link: (scope,elem,attrs) => {\n            // assign a default \"toggled\" class\n            const toggledClass = attrs.toggledClass || 'class-toggle-' + scope.$id\n            const elementClass = () => elem.attr('class') || ''\n            const checkIfToggled = (elementClass) => {\n                scope.toggled = elementClass.indexOf(toggledClass) >= 0\n            }\n\n            scope.toggleClass = () => {\n                elem.toggleClass(toggledClass)\n            }\n            scope.toggleOn = () => {\n                if(!scope.toggled) scope.toggleClass()\n            }\n            scope.toggleOff = () => {\n                if(scope.toggled) scope.toggleClass()\n            }\n\n            scope.$watch(elementClass, checkIfToggled)\n        }\n    }\n})\n\n\nangular.module('cui-ng')\n.directive('cuiAvatar', ($http, $filter) => {\n    return{\n        restrict: 'A',\n        scope: {\n            cuiAvatar: '=',\n            cuiAvatarNames: '=',\n            cuiAvatarEmail: '='\n        },\n        compile: () => {\n            return {\n                pre: (scope, elem, attrs) => {\n                    const cuiAvatar = {\n                        selectors: {\n                            $elem: angular.element(elem[0])\n                        },\n                        config: {\n                            colorClassPrefix: attrs.cuiAvatarColorClassPrefix || false,\n                            colorCount: attrs.cuiAvatarColorCount || 0,\n                            cuiI18nFilter: angular.isDefined(attrs.cuiAvatarCuii18nFilter) || false,\n                            maxNumberOfInitials: attrs.cuiAvatarMaxNumInitials || 2\n                        },\n                        watchers: () => {\n                           scope.$watch('cuiAvatar', (newAvatar) => {\n                               if (newAvatar) cuiAvatar.update()\n                           })\n                            scope.$watch('cuiAvatarNames', (newNameArray) => {\n                               if (newNameArray) cuiAvatar.update()\n                           })\n                           scope.$watch('cuiAvatarEmail', (newEmail) => {\n                                if (newEmail) cuiAvatar.update()\n                           })\n                        },\n                        helpers: {\n                            isColorClassApplied: () => {\n                                return _.find(cuiAvatar.selectors.$elem[0].classList, (className) => className.indexOf(cuiAvatar.config.colorClassPrefix)>-1 )\n                            },\n                            applyRandomColorClass: () => {\n                                const classNumberToApply = Math.floor(Math.random() * cuiAvatar.config.colorCount + 1)\n                                cuiAvatar.selectors.$elem[0].classList.add(cuiAvatar.config.colorClassPrefix + classNumberToApply)\n                                cuiAvatar.config.colorClassAdded = cuiAvatar.config.colorClassPrefix + classNumberToApply\n                            },\n                            getInitialsToDisplay: () => {\n                                let internationalizedName\n                                let nameToDisplay = ''\n                                if (cuiAvatar.config.cuiI18nFilter) {\n                                    internationalizedName = $filter('cuiI18n')(scope.cuiAvatarNames).split(' ')\n                                }\n                                (internationalizedName || scope.cuiAvatarNames).forEach((nameSection, i) => {\n                                    if (i < cuiAvatar.config.maxNumberOfInitials) {\n                                        if (!nameSection) return\n                                        nameToDisplay += nameSection[0].toUpperCase()\n                                    }\n                                })\n                                return nameToDisplay\n                            }\n                        },\n                        render: {\n                            nameBackground: () => {\n                                if (cuiAvatar.config.colorClassPrefix) {\n                                    if (cuiAvatar.config.colorCount===0) {\n                                        throw 'For cui-avatar if you specify color class prefix you must specify the a cui-avatar-color-count'\n                                    }\n\n                                    if (cuiAvatar.helpers.isColorClassApplied()) return\n                                    else cuiAvatar.helpers.applyRandomColorClass()\n                                }\n                            },\n                            initials: () => {\n                                if (!scope.cuiAvatarNames) return\n                                cuiAvatar.selectors.$elem[0].innerHTML = `<div class=\"cui-avatar__initials\"></div>`\n                                cuiAvatar.selectors.$initials = angular.element(cuiAvatar.selectors.$elem[0].childNodes[0])\n                                cuiAvatar.selectors.$initials[0].innerHTML = cuiAvatar.helpers.getInitialsToDisplay()\n                            },\n                            image: () => {\n                                const applyImage = (imgSrc) => {\n                                    // remove the random color class added before applying an image\n                                    if(cuiAvatar.config.colorClassAdded) cuiAvatar.selectors.$elem[0].classList.remove(cuiAvatar.config.colorClassAdded)\n                                    cuiAvatar.selectors.$elem[0].innerHTML = `<div class=\"cui-avatar__image-container\"></div>`\n                                    cuiAvatar.selectors.$image = angular.element(cuiAvatar.selectors.$elem[0].childNodes[0])\n                                    cuiAvatar.selectors.$image[0].style.backgroundImage = `url(\"${imgSrc}\")`\n                                }\n                                let img = new Image();\n                                if(scope.cuiAvatar && scope.cuiAvatar!==''){\n                                    img.src = scope.cuiAvatar\n                                    img.onload = applyImage(img.src)\n                                }\n                                else if (scope.cuiAvatarEmail) {\n                                    const hashedEmail = md5(scope.cuiAvatarEmail)\n                                    // ?d=404 tells gravatar not to give me a default gravatar\n                                    $http.get(`https://www.gravatar.com/avatar/${hashedEmail}?d=404`)\n                                    .then(res => { // If the user has a gravatar account and has set a picture\n                                        img.src = `https://www.gravatar.com/avatar/${hashedEmail}`\n                                        img.onload = applyImage(img.src)\n                                    })\n                                }\n                                else return\n                            }\n                        },\n                        update: () => {\n                            cuiAvatar.render.nameBackground()\n                            cuiAvatar.render.initials()\n                            cuiAvatar.render.image()\n                        }\n                    }\n                    cuiAvatar.render.nameBackground()\n                    cuiAvatar.render.initials()\n                    cuiAvatar.render.image()\n                    cuiAvatar.watchers()\n                }\n            }\n        }\n    }\n})\n\nangular.module('cui-ng')\n.directive('cuiButton', () => ({\n    restrict: 'E',\n    transclude: true,\n    scope: {\n        errorIf: '=',\n        loadingIf: '=',\n        successIf: '=',\n        disableIf: '=',\n        errorMessage: '@',\n        loadingMessage: '@',\n        successMessage: '@',\n        buttonClick: '&'\n    },\n    link: (scope, elem, attrs) => {\n      attrs.hasOwnProperty('errorMessage') ? scope.errorMessage = attrs['errorMessage'] : scope.errorMessage = 'Error'\n      attrs.hasOwnProperty('loadingMessage') ? scope.loadingMessage = attrs['loadingMessage'] : scope.loadingMessage = 'Loading'\n      attrs.hasOwnProperty('successMessage') ? scope.successMessage = attrs['successMessage'] : scope.successMessage = 'Success'\n    },\n    template: `\n        <button class=\"cui-button cui-button--error-alt\" ng-if=\"errorIf\" ng-click=\"buttonClick()\" ng-disabled=\"disableIf\">\n          {{errorMessage}}\n        </button>\n        <button class=\"cui-button cui-button--loading-alt\" ng-if=\"loadingIf\" ng-disabled=\"disableIf\">\n          <span>{{loadingMessage}}</span>\n          <div class=\"cui-button__ellipses\"></div>\n          <div class=\"cui-button__ellipses\"></div>\n          <div class=\"cui-button__ellipses\"></div>\n        </button>\n        <button class=\"cui-button cui-button--success\" ng-if=\"successIf\" ng-disabled=\"disableIf\">\n          {{successMessage}}\n          <svg class=\"cui-button__check\" width=\"21px\" height=\"16px\" viewBox=\"0 0 21 16\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n              <title>check</title>\n              <g id=\"check\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\">\n                  <path d=\"M0.824056194,14.5726523 C1.60584855,15.3483885 2.86333934,15.3420834 3.63455864,14.5567179 L11.8587648,6.18165837 C12.62917,5.39712184 13.9014742,5.37922301 14.6979727,6.13923477 L17.3615817,8.68082663 C18.1592277,9.44193325 19.4283055,9.41819274 20.1974828,8.62642494 L19.932337,8.89935798 C20.700916,8.10820614 20.673432,6.84262122 19.8821394,6.08333201 L14.6486407,1.06149931 C13.8523384,0.297402956 12.5724404,0.323089801 11.8099641,1.09847731 L1.07504371,12.0151757 C0.303588289,12.7996944 0.31135936,14.063927 1.09376039,14.8402672 L0.824056194,14.5726523 Z\" fill=\"currentColor\" transform=\"translate(10.500000, 7.826229) rotate(-180.000000) translate(-10.500000, -7.826229) \"></path>\n              </g>\n          </svg>\n        </button>\n        <ng-transclude ng-if=\"!loadingIf && !errorIf && !successIf\" ng-click=\"buttonClick()\" ng-disabled=\"disableIf\">\n        </ng-translude>\n    `\n}))\n\n\nangular.module('cui-ng')\n.directive('cuiDropdown', ($compile) => {\n    return {\n        require: 'ngModel',\n        restrict: 'E',\n        scope: {\n            ngModel: '=',\n            options: '&',\n            constraints: '&'\n        },\n        link: (scope, elem, attrs, ctrl) => {\n            const id = scope.$id\n            const inputName = (`cuiDropdown${id}`)\n            let newScope\n            let dropdownScope\n            let currentIndex\n\n            const cuiDropdown = {\n                initScope: () => {\n                    if (attrs.ngRequired || attrs.required) {\n                        ctrl.$validators['required'] = () => ctrl.$viewValue !== null\n                    }\n                    angular.forEach(cuiDropdown.watchers, (initWatcher) => {\n                        initWatcher()\n                    })\n                    angular.forEach(cuiDropdown.scope, (value, key) => {\n                        scope[key] = value\n                    })\n                },\n                config: {\n                    inputClass: attrs.class || 'cui-dropdown',\n                    dropdownWrapperClass: attrs.dropdownClass || 'cui-dropdown__wrapper',\n                    dropdownItemClass: attrs.dropdownItemClass || 'cui-dropdown__item',\n                    attachment: attrs.attachment || 'top left',\n                    targetAttachment: attrs.targetAttachment || 'top left',\n                    offset: attrs.offset || '0 0',\n                    defaultConstraints: [{ to: 'window', attachment: 'together none'}],\n                    returnValue: attrs.returnValue,\n                    displayValue: attrs.displayValue,\n                    required: attrs.ngRequired || attrs.required || false,\n                    defaultOption: angular.isDefined(attrs.defaultOption),\n                    defaultOptionValue: attrs.defaultOption || '(\"select-one\" | translate)'\n                },\n                selectors: {\n                    $cuiDropdown: angular.element(elem),\n                    $body: angular.element(document.body)\n                },\n                watchers: {\n                    dropdownClick: () => {\n                        // each dropdown item broadcasts the cui-dropdown scope id and passes the index of the choice\n                        scope.$on(id.toString(), cuiDropdown.helpers.reassignModel)\n                    },\n                    languageChange: () => {\n                        scope.$on('languageChange', cuiDropdown.helpers.handleLanguageChange)\n                    },\n                    model: () => {\n                        scope.$watch('ngModel', (newModel, oldModel) => {\n                            if(oldModel !== undefined) {\n                                let indexInReturnValues = _.findIndex(cuiDropdown.helpers.getOptionReturnValues(), returnValue => {\n                                    return returnValue === newModel\n                                })\n                                // if the new model isn't one of the return values assign the default / first option\n                                if (indexInReturnValues === -1) indexInReturnValues = 0\n                                cuiDropdown.helpers.reassignModel(null, indexInReturnValues)\n                            }\n                        })\n                    },\n                    options: () => {\n                        scope.$watch(scope.options, (newOptions, oldOptions) => {\n                            if (newOptions) {\n                                cuiDropdown.helpers.setInitialInputValue()\n                                cuiDropdown.render.currentValueBox()\n                            }\n                        },(newOptions, oldOptions) => !angular.equals(newOptions, oldOptions))\n                    }\n                },\n                scope: {\n                    toggleDropdown: () => {\n                        if (!cuiDropdown.selectors.$dropdown) cuiDropdown.render.dropdown()\n                        else cuiDropdown.scope.destroyDropdown()\n                    },\n                    destroyDropdown: () => {\n                        if (cuiDropdown.selectors.$dropdown) {\n                            dropdownScope.$destroy()\n                            cuiDropdown.selectors.$dropdown.detach()\n                            cuiDropdown.selectors.$dropdown = null\n                        }\n                    },\n                    handleKeyup: (keyCode) => {\n                        if ((keyCode == '38' || keyCode == '40') && !cuiDropdown.selectors.$dropdown) {\n                          cuiDropdown.scope.toggleDropdown()\n                        }\n                    }\n                },\n                helpers: {\n                    getOptionDisplayValues: () => {\n                        let displayValues = []\n                        const { defaultOption, defaultOptionValue, displayValue } = cuiDropdown.config\n                        if (defaultOption) displayValues.push(scope.$eval(defaultOptionValue)) // push an empty return option for error handling\n                        angular.forEach(scope.options(), (value, key) => {\n                            if (!displayValue) displayValues.push(value)\n                            else {\n                                const displayScope = {\n                                    object: value,\n                                    value,\n                                    key\n                                }\n                                displayValues.push(scope.$eval(displayValue,displayScope))\n                            }\n                        })\n                        return displayValues\n                    },\n                    getOptionReturnValues: () => {\n                        let returnValues = []\n                        const { defaultOption, returnValue } = cuiDropdown.config\n                        if(defaultOption) returnValues.push(null) // if there's a default option it won't have any return value\n                        angular.forEach(scope.options(),(value, key) => {\n                            if (!returnValue) returnValues.push(value)\n\n                            else {\n                                const returnScope = {\n                                    object : value,\n                                    value,\n                                    key\n                                }\n                                returnValues.push(scope.$eval(returnValue,returnScope))\n                            }\n                        })\n                        return returnValues\n                    },\n                    getDropdownItem: (index,displayValue) => {\n                        const ngClick = `$root.$broadcast('${id}', ${index})`;\n                        return $compile(\n                            `<div class=\"${cuiDropdown.config.dropdownItemClass}\" ng-click=\"${ngClick}\" tabindex=\"0\">\n                                ${displayValue}\n                            </div>`\n                        )(scope)\n                    },\n                    setInitialInputValue: () => {\n                        const displayValues = cuiDropdown.helpers.getOptionDisplayValues()\n                        const returnValues = cuiDropdown.helpers.getOptionReturnValues()\n                        if (!scope.ngModel) {\n                            scope.displayValue = displayValues[0]\n                            scope.ngModel = returnValues[0]\n                            currentIndex = 0\n                            return\n                        }\n                        const index = _.findIndex(returnValues, value => angular.equals(value, scope.ngModel))\n                        if (index > -1) {\n                            scope.displayValue = displayValues[index]\n                            currentIndex = index\n                        } else {\n                            scope.displayValue = displayValues[0]\n                            scope.ngModel = returnValues[0]\n                            currentIndex = 0\n                        }\n                    },\n                    reassignModel: (e, index) => {\n                        if (typeof index === 'number') {\n                          currentIndex = index\n                        } else {\n                          index = currentIndex\n                        }\n                        const displayValues = cuiDropdown.helpers.getOptionDisplayValues()\n                        const returnValues=cuiDropdown.helpers.getOptionReturnValues()\n                        scope.displayValue = displayValues[index]\n                        scope.ngModel = returnValues[index]\n                        cuiDropdown.scope.destroyDropdown()\n                    },\n                    handleLanguageChange: () => {\n                        cuiDropdown.helpers.reassignModel()\n                    }\n                },\n                render: {\n                    currentValueBox: () => {\n                        if(newScope) newScope.$destroy() // this makes sure that if the input has been rendered once the off click handler is removed\n                        newScope = scope.$new()\n                        const element = $compile(\n                            `<div class=\"${cuiDropdown.config.inputClass}\" tabindex=\"0\" ng-keyup=\"handleKeyup($event.keyCode)\" ng-click=\"toggleDropdown()\" off-click=\"destroyDropdown()\" id=\"cui-dropdown-${id}\">\n                                {{displayValue}}\n                            </div>`\n                        )(newScope)\n                        cuiDropdown.selectors.$cuiDropdown.replaceWith(element)\n                        cuiDropdown.selectors.$cuiDropdown = element\n                    },\n                    dropdown: () => {\n                        if(dropdownScope) dropdownScope.$destroy()\n                        dropdownScope = scope.$new()\n                        const dropdown = $compile(\n                            `<div class=\"${cuiDropdown.config.dropdownWrapperClass}\" tabindex=\"0\" off-click-filter=\"'#cui-dropdown-${id}'\"></div>`\n                        )(dropdownScope)\n                        const displayValues = cuiDropdown.helpers.getOptionDisplayValues()\n                        displayValues.forEach((value, i) => {\n                            dropdown.append(cuiDropdown.helpers.getDropdownItem(i, value))\n                        })\n                        dropdown.width(cuiDropdown.selectors.$cuiDropdown.outerWidth() - 60)\n                        cuiDropdown.selectors.$dropdown = dropdown\n                        cuiDropdown.selectors.$body.append(dropdown)\n                        new Tether({\n                            element: cuiDropdown.selectors.$dropdown[0],\n                            target: cuiDropdown.selectors.$cuiDropdown[0],\n                            attachment: cuiDropdown.config.attachment,\n                            targetAttachment: cuiDropdown.config.targetAttachment,\n                            constraints: scope.constraints() || cuiDropdown.config.defaultConstraints\n                        })\n                    }\n                }\n            }\n            cuiDropdown.initScope()\n        }\n    }\n})\n\nangular.module('cui-ng')\n.directive('cuiExpandable',($compile) => {\n    return {\n        restrict: 'E',\n        transclude: true,\n        link: (scope, elem, attrs, ctrl, transclude) => {\n            const newScope = scope.$new()\n            scope.$on('$destroy',() => newScope.$destroy())\n\n            transclude(newScope, (clone, innerScope) => {\n                elem.append(clone)\n            })\n\n            const expandableBody = angular.element(elem[0].querySelector('cui-expandable-body'))\n            expandableBody.hide() // hide the body by default\n\n            const toggleClass = () => {\n                elem.toggleClass('expanded')\n            }\n            const toggleBody = () => {\n                expandableBody.animate({'height':'toggle'}, parseInt(elem.attr('transition-speed') || 300) ,'linear')\n            }\n\n            newScope.toggleExpand = (event) => {\n                // this way labels won't toggle expand twice\n                if(event && event.target.tagName==='INPUT' && event.target.labels && event.target.labels.length > 0 ) return;\n                toggleClass();\n            }\n            newScope.expand = () => {\n                if(!newScope.expanded) toggleClass();\n            }\n            newScope.collapse = () => {\n                if(newScope.expanded) toggleClass()\n            }\n            newScope.$watch(() => elem.attr('class') || '' , (newValue,oldValue) => {\n                if(oldValue === newValue && newValue.indexOf('expanded') > -1 ){ // if the element the expanded class put in by default\n                    newScope.expanded = true\n                    toggleBody()\n                }\n                else if(newValue.indexOf('expanded') === -1){\n                    if(newScope.expanded===true) toggleBody()\n                    newScope.expanded=false\n                }\n                else{\n                    if(newScope.expanded===false) toggleBody()\n                    newScope.expanded=true\n                }\n            })\n        }\n    }\n})\n\nangular.module('cui-ng')\n.provider('$cuiIcon', function () {\n    let iconSets = {}\n\n    this.iconSet = (namespace, path, viewBox) => {\n        iconSets[namespace] = { path, viewBox }\n    }\n\n    this.getIconSets = () => iconSets\n\n    this.getIconSet = (namespace) => {\n        if (!iconSets[namespace]) {\n            throw new Error(`The icon collection with the namespace ${namespace} is not yet defined in the $cuiIcon provider.`)\n        }\n        return iconSets[namespace]\n    }\n\n    this.$get = function () {\n        return this\n    }\n})\n\nangular.module('cui-ng')\n.directive('cuiIcon', ($cuiIcon) => {\n    return {\n        restrict: 'E',\n        scope: {},\n        link: (scope, elem, attrs) => {\n            const icon = attrs.cuiSvgIcon\n            let viewBox\n            let preserveaspectratio\n            let svgClass\n            let useClass\n            let path\n\n            attrs.preserveaspectratio\n                ? preserveaspectratio = `preserveAspectRatio=\"${attrs.preserveaspectratio}\"`\n                : preserveaspectratio = ''\n            attrs.svgClass\n                ? svgClass = `class=\"${attrs.svgClass}\"`\n                : svgClass = ''\n            attrs.viewbox\n                ? viewBox=`viewBox=\"${attrs.viewbox}\"`\n                : viewBox = ''\n            attrs.useClass\n                ? useClass = `class=\"${attrs.useClass}\"`\n                : useClass = ''\n\n            if (icon && icon.indexOf('.svg') >- 1) { // if the path is directly specified\n                path = icon\n            } else if (icon) { // if the icon is pointing at a namespace put into the provider\n                const [ iconNamespace, iconId ] = icon.split(':')\n                path = $cuiIcon.getIconSet(iconNamespace).path + '#' + iconId\n                if(viewBox==='' && $cuiIcon.getIconSet(iconNamespace).viewBox){\n                    viewBox=`viewBox=\"${ $cuiIcon.getIconSet(iconNamespace).viewBox }\"`\n                }\n            } else throw new Error('You need to define a cui-svg-icon attribute for cui-icon')\n\n            const newSvg = $(\n                `<svg xmlns=\"http://www.w3.org/2000/svg\" ${preserveaspectratio} ${svgClass} ${viewBox}>\n                    <use xlink:href=\"${path}\" ${useClass}></use>\n                </svg>`\n            )\n\n            angular.element(elem).replaceWith(newSvg)\n        }\n    }\n})\n\nangular.module('cui-ng')\n.factory('CuiPopoverHelpers',() => {\n    const cuiPopoverHelpers = {\n        getResetStyles : () => {\n            return {\n                'margin-right': '',\n                'margin-left': '',\n                'margin-bottom': '',\n                'margin-top': '',\n                'left': '',\n                'top': '',\n                'bottom': '',\n                'right': ''\n            }\n        },\n        getAttachmentFromPosition : (position) => {\n            switch (position) {\n                case 'top':\n                    return 'bottom center'\n                case 'bottom':\n                    return 'top center'\n                case 'right':\n                    return 'middle left'\n                case 'left':\n                    return 'middle right'\n            }\n        },\n        invertAttachmentPartial : (partial) => {\n            switch (partial) {\n                case 'top':\n                    return 'bottom'\n                case 'bottom':\n                    return 'top'\n                case 'left':\n                    return 'right'\n                case 'right':\n                    return 'left'\n            }\n        },\n        parsePositionArray : (positionArray) => {\n            const genericPositions = [\n                {position: 'bottom'},\n                {position: 'top'},\n                {position: 'right'},\n                {position: 'left'}\n            ] // these are objects to facilitate the reposition function\n            let positions = []\n            if (typeof positionArray==='undefined') {\n                positions.push.apply(positions, genericPositions)\n            }\n            else {\n                positionArray.forEach((position, i) => {\n                    switch(position){\n                        case 'any':\n                            positions.push.apply(positions, genericPositions)\n                            break\n                        case 'invert':\n                            positions.push(\n                                Object.assign({}, positionArray[i-1], {\n                                    position: cuiPopoverHelpers.invertAttachmentPartial(positionArray[i-1].position)\n                                })\n                            )\n                            break\n                        default:\n                            positions.push(position)\n                    }\n                })\n            }\n            return positions\n        },\n        parseOffset : (offset) => {\n            const splitOffset = offset.split(' ')\n            const verticalOffset = cuiPopoverHelpers.getOffsetAndUnitsOfOffset(splitOffset[0])\n            const horizontalOffset = cuiPopoverHelpers.getOffsetAndUnitsOfOffset(splitOffset[1])\n            return { verticalOffset, horizontalOffset }\n        },\n        parseAttachment : (attachment) => {\n            const [ verticalAttachment , horizontalAttachment ] = attachment.split(' ')\n            return { verticalAttachment, horizontalAttachment }\n        },\n        getTetherOffset: (position, offset) => {\n            const { verticalOffset , horizontalOffset } = cuiPopoverHelpers.parseOffset(offset)\n\n            switch (position){\n                case 'top':\n                case 'bottom':\n                    return '0 ' + (horizontalOffset.amount * -1) + horizontalOffset.units\n                default:\n                    return (verticalOffset.amount * -1) + verticalOffset.units + ' 0'\n            }\n        },\n        invertAttachment: (attachment) => {\n            const { verticalAttachment, horizontalAttachment } = cuiPopoverHelpers.parseAttachment(attachment)\n            return invertAttachmentPartial(verticalAttachment) + ' ' + invertAttachmentPartial(horizontalAttachment)\n        },\n        getOffsetAndUnitsOfOffset: (offsetPartial) => {\n            let amount\n            let units\n            switch (offsetPartial.indexOf('%')) {\n                case -1 :\n                    amount  = window.parseInt(offsetPartial.split('px')[0])\n                    units = 'px'\n                    break\n                default :\n                    amount = window.parseInt(offsetPartial.split('%')[0])\n                    units = '%'\n            }\n            return { amount, units }\n        },\n        getPointerOffset: (opts) => {\n            const { position, offsetBetweenPointerAndContent, popoverHeight, popoverWidth, pointerHeight, pointerWidth, containerHeight, containerWidth, distanceBetweenTargetAndPopover } = opts\n            const contentOffset = cuiPopoverHelpers.getOffsetAndUnitsOfOffset(offsetBetweenPointerAndContent)\n            const contentOffsetCompensation = () => {\n                switch (position) {\n                    case 'top':\n                    case 'bottom':\n                        return {\n                            'margin-left': '50%',\n                            'left': (contentOffset.amount * -1) + contentOffset.units\n                        }\n                    case 'left':\n                    case 'right':\n                        switch (contentOffset.amount) {\n                            case 0:\n                                return {\n                                    'top': '50%'\n                                }\n                            default:\n                                let topMargin\n                                contentOffset.units === '%'\n                                    ? topMargin = containerHeight * ((contentOffset.amount * -1) /100)\n                                    : topMargin = contentOffset.amount + contentOffset.units\n                                return {\n                                    'top': '50%',\n                                    'margin-top': topMargin\n                                }\n                        }\n                }\n            }\n\n            const containerPadding = cuiPopoverHelpers.getContainerPaddings(opts)\n            const pointerOffset = () => {\n                switch (position) {\n                    case 'top':\n                        return {\n                            bottom: '1px',\n                            transform: 'translate(-50%,' + (-Math.ceil(parseFloat(containerPadding['padding-bottom'])) + pointerHeight) + 'px)'\n                        }\n                    case 'bottom':\n                        return {\n                            top: '1px',\n                            transform: 'translate(-50%,' + (Math.ceil(parseFloat(containerPadding['padding-top'])) - pointerHeight) + 'px)'\n                        }\n                    case 'left':\n                        return {\n                            right: (parseFloat(containerPadding['padding-right']) - pointerHeight) + 'px',\n                            transform: 'translate(-1px,-50%)'\n                        }\n                    case 'right':\n                        return {\n                            left: (parseFloat(containerPadding['padding-left']) - pointerHeight) + 'px',\n                            transform: 'translate(1px,-50%)'\n                        }\n                }\n            }\n\n            return Object.assign({}, cuiPopoverHelpers.getResetStyles(), pointerOffset(), contentOffsetCompensation())\n        },\n        getPointerBorderStyles: (opts) => {\n            const { position,pointerHeight,pointerWidth } = opts\n            const transparentHorizontalBorder = pointerWidth + 'px solid transparent'\n            const transparentVerticalBorder = pointerHeight + 'px solid transparent'\n            if (position === 'top' || position === 'bottom') {\n                return {\n                    'border-right': transparentHorizontalBorder,\n                    'border-left': transparentHorizontalBorder,\n                    'border-bottom': transparentVerticalBorder,\n                    'border-top': transparentVerticalBorder\n                }\n            } else return {\n                'border-right': transparentVerticalBorder,\n                'border-left': transparentVerticalBorder,\n                'border-bottom': transparentHorizontalBorder,\n                'border-top': transparentHorizontalBorder\n            }\n        },\n        getPointerStyles: (opts) => {\n            const { element, position, offsetBetweenPointerAndContent, popoverHeight, popoverWidth, pointerHeight, pointerWidth, containerHeight, containerWidth, distanceBetweenTargetAndPopover } = opts\n            const colorOfPopoverBackground = element.css('backgroundColor'),\n                stylesOfVisibleBorder = pointerHeight + 'px solid ' + colorOfPopoverBackground\n\n            return Object.assign({position: 'absolute'},\n                    cuiPopoverHelpers.getPointerOffset(opts),\n                    cuiPopoverHelpers.getPointerBorderStyles(opts),\n                    {\n                        [ 'border-' + position ]: stylesOfVisibleBorder\n                    }\n                )\n        },\n        getPointer: (opts) => {\n            const $pointer = $('<span class=\"cui-popover__pointer\"></span>')\n            $pointer.css(cuiPopoverHelpers.getPointerStyles(opts))\n            return $pointer\n        },\n        getPopoverMargins: (position, pointerHeight) => {\n            const margin = pointerHeight + 'px'\n            return {\n                'margin-top': position === 'bottom' ? margin : '',\n                'margin-right': position === 'left' ? margin : '',\n                'margin-bottom': position === 'top' ? margin : '',\n                'margin-left': position === 'right' ? margin : ''\n            }\n        },\n        getContainerPaddings: (opts) => {\n            const { position, offsetBetweenPointerAndContent, popoverHeight, popoverWidth, pointerHeight, distanceBetweenTargetAndPopover } = opts\n            const padding = cuiPopoverHelpers.getOffsetAndUnitsOfOffset(distanceBetweenTargetAndPopover)\n\n            let [ paddingTop, paddingBottom, paddingRight, paddingLeft ] = ['', '', '', '']\n\n            if (position === 'top' || position === 'bottom') {\n               let verticalPadding\n               switch (padding.units) {\n                   default: // 'px' or ''\n                       verticalPadding = padding.amount + padding.units\n                       break\n                   case '%':\n                       const heightOfContainer = popoverHeight + pointerHeight\n                       verticalPadding = heightOfContainer * (padding.amount / 100) + 'px'\n                }\n                position === 'top'\n                    ? paddingBottom = verticalPadding\n                    : paddingTop = verticalPadding\n            } else {\n                let horizontalPadding\n                switch (padding.units) {\n                    default: // 'px' or ''\n                        horizontalPadding = padding.amount + padding.units\n                        break\n                    case '%':\n                        const widthOfContainer = popoverWidth + pointerHeight\n                        horizontalPadding = widthOfContainer * (padding.amount / 100) + 'px'\n                }\n                position === 'left'\n                    ? paddingRight = horizontalPadding\n                    : paddingLeft = horizontalPadding\n            }\n\n            return {\n                'padding-top': paddingTop || '',\n                'padding-right': paddingRight || '',\n                'padding-bottom': paddingBottom || '',\n                'padding-left': paddingLeft || '',\n            }\n        }\n    }\n\n    return cuiPopoverHelpers\n\n})\n\n\nangular.module('cui-ng')\n.directive('cuiPopover', (CuiPopoverHelpers, $compile, $timeout, $interval) => {\n    return {\n        restrict: 'EA',\n        compile: () => {\n            return {\n                pre: (scope, elem, attrs) => {\n                    let self\n                    let popoverTether=[],repositionedTether, tetherAttachmentInterval, targetElementPositionInterval, elementHtmlInterval, elementHtml, cuiPopoverConfig = {}, positions, positionInUse, trialPosition\n\n                    const cuiPopover = {\n                        init:function(){\n                            elem.css({opacity:'0', 'pointer-events':'none', position:'fixed', right:'0'}) // hide the original element.\n\n                            self=this\n                            positionInUse = 0 // using the default position when we init\n                            if(!attrs.popoverPositions) throw new Error('You must define popover-positions for the cui-popover directive.')\n                            positions = scope.$eval(attrs.popoverPositions)\n                            positions = CuiPopoverHelpers.parsePositionArray(positions)\n                            self.config(positions[positionInUse])\n                            self.selectors[positionInUse]={}\n                            $timeout(()=> self.render.popoverContainer(positionInUse))\n\n                            angular.forEach(self.watchers, (initWatcher) => {\n                                initWatcher()\n                            })\n                        },\n                        config:(opts) => {\n                                const _this = cuiPopoverConfig\n                                _this.element = elem\n                                _this.target = attrs.target\n                                _this.targetModifier = attrs.targetModifier || undefined\n\n                                _this.pointerHeight = attrs.pointerHeight && window.parseInt(attrs.pointerHeight) || 14\n                                _this.pointerWidth = attrs.pointerWidth && window.parseInt(attrs.pointerWidth) || 9\n\n                                _this.popoverWidth = elem.outerWidth()\n                                _this.popoverHeight = elem.outerHeight()\n\n                                _this.position = opts.position\n                                const popoverOffsetAttribute = (opts && opts.popoverOffset || attrs.popoverOffset || '0 0').split(' ')\n                                const offsetBetweenPointerAndContent = (opts && opts.contentOffset || attrs.contentOffset || '0')\n\n                                let offset, targetOffset, targetAndPopoverOffset, pointerOffset, containerWidth, containerHeight\n\n                                if(_this.position === 'top' || _this.position === 'bottom'){\n                                    [ targetAndPopoverOffset, pointerOffset ] = popoverOffsetAttribute\n                                    offset = ['0', offsetBetweenPointerAndContent].join(' ')\n                                    targetOffset = ['0', pointerOffset].join(' ')\n                                    containerWidth = _this.popoverWidth\n                                    containerHeight = _this.popoverHeight + _this.pointerHeight\n                                }\n                                else {\n                                    [ pointerOffset, targetAndPopoverOffset ] = popoverOffsetAttribute\n                                    offset = [offsetBetweenPointerAndContent, '0'].join(' ')\n                                    targetOffset = [pointerOffset,'0'].join(' ')\n                                    containerWidth = _this.popoverWidth + _this.pointerHeight\n                                    containerHeight = _this.popoverHeight\n                                }\n\n                                _this.distanceBetweenTargetAndPopover = targetAndPopoverOffset\n                                _this.offsetBetweenPointerAndContent = offsetBetweenPointerAndContent\n                                _this.offset = offset\n                                _this.targetOffset = targetOffset\n                                _this.containerHeight = containerHeight\n                                _this.containerWidth = containerWidth\n\n                                _this.attachment = CuiPopoverHelpers.getAttachmentFromPosition(_this.position)\n                                _this.targetAttachment = CuiPopoverHelpers.getAttachmentFromPosition(CuiPopoverHelpers.invertAttachmentPartial(_this.position))\n                        },\n                        helpers: {\n                            getTetherOptions:( element = self.selectors.$container[0], opts ) => {\n                                const { target, position, offset, targetOffset, targetModifier, attachment, targetAttachment } = opts\n                                return {\n                                    target,\n                                    targetModifier,\n                                    attachment,\n                                    targetAttachment,\n                                    targetOffset,\n                                    offset : CuiPopoverHelpers.getTetherOffset(position,offset),\n                                    element : element,\n                                    constraints:  [{ to: 'window', attachment: 'none none' }]\n                                }\n                            }\n                        },\n                        watchers:{\n                            position:() => {\n                                tetherAttachmentInterval = $interval(() => {\n                                    if(!popoverTether[positionInUse] || !popoverTether[positionInUse].element) return\n                                    if(positions.length === 1) self.newMode('normal')\n                                    else {\n                                        if(popoverTether[positionInUse].element.classList.contains('tether-out-of-bounds')) self.newMode('try-another')\n                                        else self.newMode('normal')\n                                    }\n                                }, 100)\n                            },\n                            elementHtml:() => {\n                                elementHtmlInterval=$interval(()=>{\n                                    let elemHtml = elem.html()\n                                    if(elemHtml !== elementHtml) { // if the element html is different than what we have cached\n                                        elementHtml = elemHtml\n                                        cuiPopover.render.newHtml()\n                                    }\n                                }, 100)\n                            },\n                            targetElementPosition:() => {\n                                targetElementPositionInterval=$interval(() => {\n                                    scope.targetPosition = self.selectors.$target.offset()\n                                }, 50)\n\n                                scope.$watch('targetPosition',(newPosition) => {\n                                    newPosition && popoverTether[positionInUse].position()\n                                },(newPosition,oldPosition) => newPosition.top !== oldPosition.top || newPosition.left !== oldPosition.left )\n                            },\n                            scopeDestroy:() => {\n                                scope.$on('$destroy',() => {\n                                    $interval.cancel(tetherAttachmentInterval)\n                                    $interval.cancel(targetElementPositionInterval)\n                                    $interval.cancel(elementHtmlInterval)\n                                    popoverTether[positionInUse].destroy()\n                                    self.selectors[positionInUse].$contentBox && self.selectors[positionInUse].$contentBox.detach()\n                                    self.selectors[positionInUse].$container && self.selectors[positionInUse].$container.detach()\n                                    self.selectors[positionInUse].$pointer && self.selectors[positionInUse].$pointer.detach()\n                                })\n                            }\n                        },\n                        selectors:{\n                            $target:angular.element(document.querySelector(attrs.target))\n                        },\n                        render:{\n                            contentBox: (positionIndex) => {\n                                const { getPointer, getPopoverMargins, getContainerPaddings } = CuiPopoverHelpers\n                                const opts = cuiPopoverConfig\n\n                                const cloneElem = angular.element(elem).clone(true,true)\n                                cloneElem.css({opacity:'','pointer-events':'',position:'',right:''})\n                                // append the cui-popover to the container and apply the margins to make room for the pointer\n                                cloneElem.css(getPopoverMargins(opts.position, opts.pointerHeight))\n\n                                if (self.selectors[positionIndex].$contentBox) {\n                                    self.selectors[positionIndex].$contentBox.detach()\n                                }\n                                self.selectors[positionIndex].$container.append(cloneElem)\n                                const newContentBox = self.selectors[positionIndex].$container[0].childNodes[1]\n                                self.selectors[positionIndex].$contentBox = angular.element(newContentBox)\n                            },\n                            popoverContainer:(positionIndex) => {\n                                const { getPointer, getPopoverMargins, getContainerPaddings } = CuiPopoverHelpers\n                                const opts = cuiPopoverConfig\n                                const $container = $('<div class=\"cui-popover__container\"></div>')\n                                const $pointer = getPointer(opts)\n\n                                // apply stylings to the container\n                                $container.css(getContainerPaddings(opts))\n                                self.selectors[positionIndex].$container = $container\n                                self.selectors[positionIndex].$container[0].style.opacity = '0'\n\n                                // append the pointer to the container\n                                $container.append($pointer)\n                                self.selectors[positionIndex].$pointer = $pointer\n\n                                // render the actual content of the popover\n                                cuiPopover.render.contentBox(positionIndex)\n\n                                angular.element(document.body).append($container)\n                                popoverTether[positionIndex] = new Tether(self.helpers.getTetherOptions($container,opts))\n\n                            },\n                            newHtml:() => {\n                                cuiPopover.render.contentBox(positionInUse)\n                            }\n                        },\n                        newMode:(newMode) => {\n                            const { getPointer, getPopoverMargins, getContainerPaddings } = CuiPopoverHelpers\n                            const opts = cuiPopoverConfig\n                            switch(newMode){\n                                case 'normal': // if we can show the popover in the current position\n                                    if(self.selectors[positionInUse].$container[0].style.opacity === '0'){\n                                        $timeout(()=>{\n                                            popoverTether[positionInUse].position()\n                                            self.selectors[positionInUse].$container[0].style.opacity = '1'\n                                        })\n                                    }\n                                    break\n                                case 'try-another':\n                                    self.tryAnotherPosition()\n                                    break\n                            }\n                        },\n                        tryAnotherPosition:() => {\n                            if(typeof trialPosition === 'undefined' && positionInUse===0) trialPosition = 1\n                            else if(typeof trialPosition === 'undefined') trialPosition = 0\n                            else trialPosition ++\n\n                            if(trialPosition === positionInUse) return\n                            if(trialPosition === positions.length) {\n                                trialPosition = undefined // next tryAnotherPosition will try the first position in the array of positions provided\n                                return\n                            }\n\n                            if(trialPosition === positions.length-1){ // if we reached the last position\n                                if(positions[trialPosition] === 'hide') { // and none of them were able to show and 'hide' was passed as last fallback, hide element.\n                                    if(self.selectors[positionInUse].$container[0].style.opacity === '0') self.selectors[positionInUse].$container[0].style.opacity = '1'\n                                    trialPosition = undefined\n                                    return\n                                }\n                            }\n\n                            if(typeof self.selectors[trialPosition]!=='undefined') delete self.selectors[trialPosition]\n                            self.selectors[trialPosition]={}\n                            const opts = positions[trialPosition]\n                            self.config(opts)\n                            self.render.popoverContainer(trialPosition)\n\n\n                            if(!popoverTether[trialPosition].element.classList.contains('tether-out-of-bounds')){ // if the new element isn't OOB then use it.\n                                self.selectors[positionInUse].$container.detach()\n                                popoverTether[positionInUse].destroy()\n                                delete self.selectors[positionInUse]\n                                positionInUse = trialPosition\n                                trialPosition = undefined\n                                if(self.selectors[positionInUse].$container[0].style.opacity === '0') self.selectors[positionInUse].$container[0].style.opacity = '1'\n                            }\n                            else { // else just remove all references to it and this function will run again by itself\n                                self.selectors[trialPosition].$container.detach()\n                                popoverTether[trialPosition].destroy()\n                                delete self.selectors[trialPosition]\n                            }\n\n                        }\n                    }\n                    cuiPopover.init()\n                }\n            }\n        }\n    }\n})\n\nangular.module('cui-ng')\n.directive('cuiResizeHandler', ($cuiResizeHandler, $window) => {\n\treturn {\n\t\trestrict: 'E',\n\t\ttransclude: true,\n\t\tscope: {\n\t\t\tshowIf: '=',\n\t\t\tbreakpoint: '='\n\t\t},\n\t\tlink: (scope, elem, attrs) => {\n\t\t\tconst elementHandler = (breakpoint) => {\n\t\t\t\tif (scope.breakpoint) {\n\t\t\t\t\tif (attrs.hasOwnProperty('mobile') && $window.innerWidth < scope.breakpoint) scope.showIf = true\n\t\t\t\t\telse if (attrs.hasOwnProperty('desktop') && $window.innerWidth >= scope.breakpoint) scope.showIf = true\n\t\t\t\t\telse scope.showIf = false\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tif (attrs.hasOwnProperty('mobile') && $window.innerWidth < breakpoint) scope.showIf = true\n\t\t\t\t\telse if (attrs.hasOwnProperty('desktop') && $window.innerWidth >= breakpoint) scope.showIf = true\n\t\t\t\t\telse scope.showIf = false\n\t\t\t\t}\n\t\t\t\tscope.$evalAsync(scope)\n\t\t\t}\n\n\t\t\tconst getScreenState = (customBreakpoint) => {\n\t\t\t\tif (customBreakpoint) {\n\t\t\t\t\tif ($window.innerWidth < customBreakpoint) return 'mobile'\n\t\t\t\t\telse return 'desktop'\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tif ($window.innerWidth < $cuiResizeHandler.breakpoint) return 'mobile'\n\t\t\t\t\telse return 'desktop'\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst getBreakpoint = () => {\n\t\t\t\tif (scope.breakpoint) return scope.breakpoint\n\t\t\t\telse return $cuiResizeHandler.breakpoint\n\t\t\t}\n\t\t\n\t\t\tconst resizeHandler = _.throttle(function() {\n\t\t\t\t$cuiResizeHandler.callHandlers()\n\t\t\t}, 300)\n\n\t\t\t$cuiResizeHandler.setHandler(scope.$id, elementHandler, getBreakpoint())\n\t\t\t$cuiResizeHandler.callHandlers()\n\t\t\t$window.onresize = resizeHandler\n\n\t\t\tscope.$on('$destroy', () => {\n\t\t\t\t$cuiResizeHandler.destroyElement(scope.$id)\n\t\t\t})\n\t\t},\n\t\ttemplate: `\n\t\t\t<div ng-if=\"showIf\"><ng-transclude></ng-transclude></div>\n\t\t`\n\t}\n})\n\n\nangular.module('cui-ng')\n.provider('$cuiResizeHandler', function() {\n\n\tconst resizeProvider = {}\n\tconst resizeHandlerFunctions = {}\n\n\tthis.breakpoint = 700\n\n\tthis.setHandler = (scopeId, handlerFunction, breakpoint) => {\n\t\tresizeHandlerFunctions[scopeId] = {\n\t\t\thandler: handlerFunction,\n\t\t\tbreakpoint: breakpoint\n\t\t}\n\t}\n\n\tthis.getHandler = (scopeId) => {\n\t\treturn resizeHandlerFunctions[scopeId]\n\t}\n\n\tthis.callHandlers = () => {\n\t\tfor (let key in resizeHandlerFunctions) {\n\t\t\tresizeHandlerFunctions[key].handler(resizeHandlerFunctions[key].breakpoint)\n\t\t}\n\t}\n\n\tthis.destroyElement = (scopeId) => {\n\t\tdelete resizeHandlerFunctions[scopeId]\n\t}\n\n\tthis.setBreakpoint = (breakpoint) => {\n\t\tthis.breakpoint = breakpoint\n\t}\n\n\tthis.getBreakpoint = () => {\n\t\treturn this.breakpoint\n\t}\n\n\tthis.$get = () => {\n\t\treturn this\n\t}\n})\n\n\nangular.module('cui-ng')\n.directive('cuiTable', ($pagination, $q) => ({\n    restrict: 'E',\n    transclude: true,\n    scope: {\n        cuiTableConfig: '=?'\n    },\n    link: (scope, iElem, iAttrs) => {\n\n        const initScope = () => {\n            if (!scope.cuiTableConfig) scope.cuiTableConfig = {}\n\n            if (scope.cuiTableConfig.paginate) {\n                const requiredOptions = ['recordCount', 'pageSize', 'initialPage', 'onPageChange']\n                try {\n                    requiredOptions.forEach(requiredOption => {\n                        if (scope.cuiTableConfig[requiredOption] == undefined) {\n                            throw new Error(`Cui-table error : if pagination is enabled then cui-table-config must have .${ requiredOption }`)\n                        }\n                    })\n                } \n                catch (e) {\n                    throw new Error(e)\n                }\n            }\n        }\n\n        try {\n            initScope()\n        } \n        catch (e) {\n            console.error(e)\n            return\n        }\n\n        const initPageChangeHandler = () => {\n            scope.cuiTableConfig.pageChangeHandler = (page) => {\n                scope.cuiTableConfig.onPageChange(page, scope.cuiTableConfig.pageSize)\n            }\n        }\n\n        const watchers = {\n            pageSize: scope.$watch('cuiTableConfig.pageSize', (newPageSize, oldPageSize) => {\n                if (!scope.cuiTableConfig.hasOwnProperty('pageChangeHandler')) initPageChangeHandler()\n                if (newPageSize && oldPageSize && newPageSize !== oldPageSize) {\n                    scope.cuiTableConfig.pageChangeHandler(1)\n                }\n            }),\n            count: scope.$watch('cuiTableConfig.recordCount', (newRecordCount, oldRecordCount) => {\n                if (!scope.cuiTableConfig.hasOwnProperty('pageChangeHandler')) initPageChangeHandler()\n                if (newRecordCount && oldRecordCount && newRecordCount !== oldRecordCount) {\n                    scope.cuiTableConfig.pageChangeHandler(1)\n                    scope.cuiTableConfig.reRenderPaginate()\n                }\n            })\n        }\n\n        scope.$on('$destroy', () => {\n            angular.forEach(watchers, (cancelWatcher) => { cancelWatcher() })\n        })\n\n    },\n    template: `\n        <div>\n            <div class=\"cui-flex-table\">\n                <ng-transclude></ng-transclude>\n            </div>\n            <div class=\"cui-paginate__container\" ng-if=\"cuiTableConfig.paginate\">\n                <span class=\"cui-paginate__results-label\">\n                    {{'cui-num-results-page' | translate}}\n                </span>\n                <results-per-page class=\"cui-paginate__select\" ng-model=\"cuiTableConfig.pageSize\"></results-per-page>\n                <paginate class=\"cui-paginate\"\n                    results-per-page=\"cuiTableConfig.pageSize\"\n                    count=\"cuiTableConfig.recordCount\"\n                    on-page-change=\"cuiTableConfig.pageChangeHandler\"\n                    ng-model=\"cuiTableConfig.initalPage\"\n                    attach-rerender-to=\"cuiTableConfig.reRenderPaginate\">\n                </paginate>\n            </div>\n        </div>\n    `\n}))\n\n\nangular.module('cui-ng')\n.directive('cuiTableHeader', ($filter) => ({\n    restrict: 'E',\n    scope: {\n        headers: '=',\n        sorting: '=?',\n        sortingCallbacks: '=?'\n    },\n    link: (scope) => {\n        if (scope.sortingCallbacks) {\n            scope.cuiTableHeader = {}\n            scope.headers.forEach(header => {\n                let translatedHeader = $filter('translate')(header).toLowerCase()\n                scope.cuiTableHeader[translatedHeader + 'Callback'] = scope.sortingCallbacks[translatedHeader] || angular.noop\n            })\n            scope.cuiTableHeader.invertSortingDirection = () => {\n                if (scope.sorting.sortType === 'asc') {\n                    scope.sorting.sortType = 'desc'\n                    return 'desc'\n                }\n                else {\n                    scope.sorting.sortType = 'asc'\n                    return 'asc'\n                }\n            }\n        }\n\n        scope.headerCallbackHandler = (header) => {\n            let translatedHeader = $filter('translate')(header).toLowerCase()\n            if (scope.sorting && scope.sortingCallbacks) {\n                if (!scope.sorting.hasOwnProperty('sortType')) scope.sorting['sortType'] = 'asc'\n                if (scope.sorting.sortBy === translatedHeader) scope.cuiTableHeader.invertSortingDirection()\n                scope.cuiTableHeader[translatedHeader + 'Callback']()\n            }\n        }\n\n        scope.shouldShowCaret = (header) => {\n            if (scope.sorting && scope.sortingCallbacks) {\n                let translatedHeader = $filter('translate')(header).toLowerCase()\n                if (scope.sorting.sortBy === translatedHeader) return true\n                else return false\n            }\n        }\n    },\n    template: `\n        <div class=\"cui-flex-table__th cui-flex-table__th--c\">\n            <div class=\"cui-flex-table__avatar-col\" ng-click=\"headerCallbackHandler(headers[0])\">\n                <span class=\"cui-flex-table__th-container\">\n                    {{headers[0] | translate}}\n                    <svg class=\"cui-flex-table__th-arrow\"\n                        viewBox=\"0 0 216 146\"\n                        ng-if=\"shouldShowCaret(headers[0])\"\n                        ng-class=\"'cui-flex-table__th-arrow--' + sorting.sortType\"\n                    >\n                        <use xmlns:xlink=\"http://www.w3.org/1999/xlink\" xlink:href=\"node_modules/@covisint/cui-icons/dist/font-awesome/font-awesome-out.svg#arrowhead5\" class=\"svg\"></use>\n                    </svg>\n                </span>\n            </div>\n\n            <div class=\"cui-flex-table__mobile-stack\">\n                <div class=\"cui-flex-table__left\"></div>\n                <div ng-class=\"{'cui-flex-table__middle':$middle, 'cui-flex-table__right':$last}\" \n                    ng-repeat=\"header in headers\" \n                    ng-click=\"headerCallbackHandler(header)\"\n                    ng-if=\"!$first\"\n                >\n                    {{header | translate}}\n                    <svg class=\"cui-flex-table__th-arrow\" style=\"position:inherit\"\n                        viewBox=\"0 0 216 146\"\n                        ng-if=\"shouldShowCaret(header)\"\n                        ng-class=\"'cui-flex-table__th-arrow--' + sorting.sortType\">\n                        <use xmlns:xlink=\"http://www.w3.org/1999/xlink\" xlink:href=\"node_modules/@covisint/cui-icons/dist/font-awesome/font-awesome-out.svg#arrowhead5\" class=\"svg\"></use>\n                    </svg>\n                </div>\n            </div>\n        </div>\n    `\n}))\n\n\nangular.module('cui-ng')\n.directive('cuiTableRow', () => ({\n    restrict: 'E',\n    transclude: true,\n    template: `<ng-transclude></ng-transclude>`\n}))\n\n\nconst defaults = {\n    cuiTreeNest0Class : 'cui-tree--nesting-0',\n    cuiTreeNestXClass : 'cui-tree--nested',\n    cuiTreeLeafWrapper: '<div class=\"cui-tree__leaf\"></div>',\n    cuiTreeLastLeafClass : 'cui-tree__leaf--last',\n    cuiTreeBranchWrapper: '<div class=\"cui-tree__branch\"></div>',\n    cuiTreeLastBranchClass : 'cui-tree__branch--last',\n    cuiTreeNestPrefix : 'cui-tree--nesting-'\n};\n\nconst cuiTreeHelpers = {\n    getDisplayValue:(scope, opts, object) => {\n        const { cuiTreeLeafDisplay } = opts;\n        let propertiesToDisplay = cuiTreeLeafDisplay.split('+');\n\n        return scope.$eval(cuiTreeLeafDisplay, { object });\n    },\n    getClassListForNestingLevel: (opts,nesting) => {\n        const { cuiTreeNestPrefix, cuiTreeNest0Class, cuiTreeNestXClass } = opts;\n        let classList = [];\n        switch (nesting){\n            case 0:\n                classList.push( cuiTreeNest0Class || defaults.cuiTreeNest0Class );\n                break;\n            default:\n                classList.push((cuiTreeNestPrefix || defaults.cuiTreeNestPrefix) + nesting);\n                classList.push( cuiTreeNestXClass || defaults.cuiTreeNestXClass );\n        };\n        return classList;\n    },\n    getElements : (scope, opts, objects, leafClickCallback, nesting=0) => {\n        const { getElements, getDisplayValue, getClassListForNestingLevel } = cuiTreeHelpers;\n        const { cuiTreeBranchWrapper, cuiTreeLeafWrapper, cuiTreeLastLeafClass, cuiTreeLastBranchClass } = opts;\n        let $node = $(`<div></div>`);\n        getClassListForNestingLevel(opts,nesting).forEach(className => $node[0].classList.add(className));\n        objects.forEach((object,i) => {\n            const $leafInner = $(`<span>${ getDisplayValue(scope, opts, object) }</span>`);\n            const $leafWrapper = $(cuiTreeLeafWrapper || defaults.cuiTreeLeafWrapper);\n            if(leafClickCallback) $leafWrapper[0].addEventListener(\"click\",function(e){ leafClickCallback(object,this,e) },true);\n            $leafWrapper.append($leafInner);\n            if(i === objects.length-1) $leafWrapper[0].classList.add(cuiTreeLastLeafClass || defaults.cuiTreeLastLeafClass); // add class to last leaf of each indent level.\n            if(object.children) { // if it has children creat a new branch for the leaf and it's children\n                const $branchWrapper = $(cuiTreeBranchWrapper || defaults.cuiTreeBranchWrapper).append($leafWrapper);\n                if(i === objects.length-1) $branchWrapper[0].classList.add(cuiTreeLastBranchClass || defaults.cuiTreeLastBranchClass);\n                $branchWrapper.append(getElements(scope, opts, object.children, leafClickCallback, nesting + 1)); // recursively gets the child nodes\n                $node.append($branchWrapper);\n            }\n            else {\n                $node.append($leafWrapper);\n            }\n        });\n        return $node;\n    }\n};\n\nconst cuiTree = {\n    pre: (scope,elem,attrs) => {\n        let $tree;\n        const leafClickCallback = scope.$eval(attrs.cuiTreeLeafClickCallback);\n\n        const renderTree = (tree) => {\n            if($tree) {\n                $tree.detach();\n                $tree.children().unbind();\n            }\n            $tree = cuiTreeHelpers.getElements(scope, attrs, tree, leafClickCallback);\n            elem.append($tree);\n        };\n\n        scope.$watch(()=>scope.$eval(attrs.cuiTree),(newTree)=>{\n            if(newTree) renderTree(newTree);\n        },true);\n\n        scope.$on('$destroy',()=>{\n            $tree.children().unbind();\n        });\n    }\n};\n\nangular.module('cui-ng')\n.directive('cuiTree',[()=>{\n    return {\n        restrict:'A',\n        scope: true,\n        compile: ()=>{\n            return cuiTree;\n        }\n    }\n}]);\n\nangular.module('cui-ng')\n.directive('cuiWizardProto',['$timeout','$compile','$window','$rootScope','$document',\n    function($timeout,$compile,$window,$rootScope,$document){\n    return{\n        restrict: 'E',\n        scope: true,\n        link:function(scope,elem,attrs){\n            var numberOfSteps,invalidForm,mobileStack,$steps,bar,$indicatorContainer,clickableIndicators,minimumPadding,\n                snap,$body,$mobileSteps,$cuiExpandableTitle,$stepIndicatorContainer;\n\n            var init = function(){\n                invalidForm=[];\n                mobileStack=attrs.mobileStack!==undefined;\n                $steps=angular.element(elem[0].querySelectorAll('step'));\n                numberOfSteps=$steps.length;\n                bar=(attrs.bar!==undefined && numberOfSteps!==1);\n                $indicatorContainer=angular.element(elem[0].querySelector('indicator-container'));\n                $indicatorContainer.append('<div class=\"cui-steps\"></div>');\n                $stepIndicatorContainer=angular.element($indicatorContainer[0].querySelector('.cui-steps'));\n                $window=angular.element($window);\n                scope.currentStep=Number(elem[0].attributes.step.value);\n                clickableIndicators=attrs.clickableIndicators;\n                minimumPadding=attrs.minimumPadding;\n                snap=angular.element(document.querySelector('snap-content'));\n                $body=angular.element('body');\n                scope.wizardFinished=false;\n                scope.next=function(state){\n                    if(state) scope.goToState(state);\n                    else {\n                        scope.currentStep++;\n                        updateIndicators();\n                        updateBar();\n                        updateStep();\n                    }\n                    if(!scope.wizardFinished && scope.currentStep===numberOfSteps) scope.wizardFinished=true;\n                    calculateWhereToScroll();\n                };\n                scope.previous=function(state){\n                    if(state){\n                        scope.goToState(state);\n                    }\n                    else{\n                        scope.currentStep--;\n                        updateIndicators();\n                        updateBar();\n                        updateStep();\n                    }\n                    calculateWhereToScroll();\n                };\n                scope.goToStep=function(step){\n                    if(step===scope.currentStep) return;\n                    scope.currentStep=step;\n                    updateIndicators();\n                    updateBar();\n                    updateStep();\n                    calculateWhereToScroll();\n                    if(!scope.wizardFinished && scope.currentStep===numberOfSteps) scope.wizardFinished=true;\n                };\n                scope.goToState=function(state){\n                    if(state==='default') return;\n                    $rootScope.$broadcast('stepChange',{state:state});\n                };\n                scope.nextWithErrorChecking=function(form,nextState){\n                    if(!form.$valid){\n                        angular.forEach(form.$error, function (field) {\n                            angular.forEach(field, function(errorField){\n                                errorField.$setTouched();\n                            });\n                        });\n                        invalidForm[scope.currentStep]=true;\n                    }\n                    else{\n                        invalidForm[scope.currentStep]=false;\n                        calculateWhereToScroll();\n                        if(nextState){\n                            scope.goToState(nextState);\n                        }\n                        else{scope.next();}\n                    }\n                };\n                if(isNaN(scope.currentStep)) scope.currentStep=1; // check if step is not a number, only runs once\n                else if(scope.currentStep>numberOfSteps) scope.currentStep=numberOfSteps;\n                else if(scope.currentStep<1) scope.currentStep=1;\n                createIndicators();\n                createBar();\n                if(mobileStack) createMobileStack();\n                if(bar) updateBar();\n                updateIndicators();\n                makeSureTheresRoom();\n                watchForWindowResize();\n                listenForLanguageChange();\n                observeStepAttr();\n            },\n            // creates indicators inside of <indicator-container>\n            createIndicators = function(){\n                var stepTitles=[],\n                    stepIcons=[];\n                scope.defaultString='default';\n                scope.stepStates=[];\n                for(var i=0;i < numberOfSteps;i++){\n                    stepTitles[i]=$steps[i].attributes.title.value;\n                    if($steps[i].attributes.state){\n                        scope.stepStates[i]='' + $steps[i].attributes.state.value + '';\n                    }\n                    if($steps[i].attributes.icon){\n                        stepIcons[i]='' + $steps[i].attributes.icon.value + '';\n                    }\n                }\n                scope.icons=[];\n                stepTitles.forEach(function(e,i){\n                    var div;\n                    if(stepIcons[i]!==undefined){\n                        if(stepIcons[i].indexOf('.')>-1){\n                            scope.icons[i]='<div class=\"icon-container\"><div class=\"icon\"><img src=\"' +  stepIcons[i] + '\" class=\"cui-icon-rotate\"/></div></div>';\n                        }\n                        else{\n                            scope.icons[i]='<div class=\"icon-container\"><div class=\"icon\"><cui-icon cui-svg-icon=\"' + stepIcons[i] + '\" svg-class=\"cui-icon-rotate\"></cui-icon></div></div>'; // adding svg-class for now until new wizard is out.\n                        }\n                    }\n                    if(clickableIndicators!==undefined && scope.icons[i]!==undefined){\n                        div=angular.element('<span class=\"step-indicator\" id=\"cui-wizard-ref-pointer-'+ i + '\" ng-click=\"goToStep(' +\n                            (i+1) + ');goToState(\\'' + (scope.stepStates[i] || scope.defaultString) + '\\')\">' +\n                        stepTitles[i] + scope.icons[i] + '</span>');\n                        div[0].style.cursor='pointer';\n                    }\n                    else if(clickableIndicators!==undefined && !scope.icons[i]){\n                        div=angular.element('<span class=\"step-indicator\" id=\"cui-wizard-ref-pointer-'+ i + '\" ng-click=\"goToStep(' +\n                            (i+1) + ');goToState(\\'' + (scope.stepStates[i] || scope.defaultString) + '\\')\">' +\n                        stepTitles[i] + '</span>');\n                        div[0].style.cursor='pointer';\n                    }\n                    else{\n                        div=angular.element('<span class=\"step-indicator\" id=\"cui-wizard-ref-pointer-'+ i + '\">' + stepTitles[i] +\n                        (scope.icons[i]? (scope.icons[i]) : ('')) +\n                        '</span>');\n                    }\n                    var compiled=$compile(div)(scope);\n                    $stepIndicatorContainer.append(compiled);\n                });\n                scope.$indicators=angular.element(elem[0].querySelectorAll('.step-indicator'));\n            },\n            createBar = function(){\n                //create a bar\n                if(bar){\n                    angular.element($indicatorContainer).append('<div class=\"steps-bar\"></div>');\n                    scope.$bar=$('.steps-bar');\n                    scope.$bar[0].innerHTML='<div class=\"steps-bar-fill\"></div>';\n                    scope.$barFill=$('.steps-bar-fill');\n                }\n            },\n            // updates the current active indicator. Removes active class from other elements.\n            updateIndicators = function(){\n                $timeout(function(){\n                    for(var i=0; i<$steps.length ; i++){\n                        $steps[i].classList.remove('active');\n                        scope.$indicators[i].classList.remove('active');\n                        if(mobileStack){ $mobileSteps[i].classList.remove('expanded'); }\n                        if(i<(scope.currentStep-1)){\n                            scope.$indicators[i].classList.add('visited');\n                            if(mobileStack){ $mobileSteps[i].classList.add('visited'); }\n                        }\n                        else{\n                            scope.$indicators[i].classList.remove('visited');\n                            if(mobileStack){ $mobileSteps[i].classList.remove('visited'); }\n                        }\n                    }\n                    $steps[scope.currentStep-1].classList.add('active');\n                    scope.$indicators[scope.currentStep-1].classList.add('active');\n                    if(mobileStack){ $mobileSteps[scope.currentStep-1].classList.add('expanded'); }\n                });\n            },\n            updateBar = function(){\n                if(!bar) return;\n                $timeout(function(){\n                    scope.$bar[0].style.left=scope.$indicators[0].scrollWidth/2+'px';\n                    scope.$bar[0].style.right=scope.$indicators[scope.$indicators.length-1].scrollWidth/2+'px';\n                    if(scope.currentStep==1){\n                        scope.$barFill[0].style.width='0px';\n                    }\n                    else{\n                        scope.$barFill[0].style.width=scope.$indicators[scope.currentStep-1].offsetLeft-(scope.$indicators[0].scrollWidth/2) +\n                        (scope.$indicators[scope.currentStep-1].scrollWidth/2)+'px';\n                    }\n                });\n            },\n            createMobileStack = function(){\n                angular.forEach($steps,function(step,i){\n                    var ngIncludeSrc;\n                    if(step.innerHTML.indexOf('<!-- ngInclude:')>-1){\n                      ngIncludeSrc=step.innerHTML.split('<!-- ngInclude:')[1].split(' -->')[0];\n                    }\n                    step.classList.add('desktop-element');\n                    var newElement=$compile(\n                        '<cui-expandable class=\"cui-expandable mobile-element\">' +\n                        '<cui-expandable-title class=\"cui-expandable__title\"' +\n                        (clickableIndicators!==undefined? 'ng-click=\"goToStep(' +\n                        (i+1) + ');goToState(\\'' + (scope.stepStates[i] || scope.defaultString) + '\\')\">' : '>') +\n                        (scope.icons[i]? scope.icons[i] : '') + '<span>' + step.title + '</span></cui-expandable-title>' +\n                        '<cui-expandable-body class=\"cui-expandable__body\">' +\n                        (ngIncludeSrc? '<div ng-include=\"' + ngIncludeSrc + '\"></div>' : step.innerHTML) + '</cui-expandable-body>' +\n                        '</cui-expandable>')(scope);\n                    angular.element(elem[0]).append(newElement);\n                });\n                $mobileSteps=angular.element(elem[0].querySelectorAll('cui-expandable.mobile-element'));\n            },\n            debounce = function(func, wait, immediate) {\n                var timeout;\n                return function() {\n                    var context = this, args = arguments;\n                    var later = function() {\n                        timeout = null;\n                        if (!immediate) {func.apply(context, args);}\n                    };\n                    var callNow = immediate && !timeout;\n                    clearTimeout(timeout);\n                    timeout = setTimeout(later, wait);\n                    if (callNow) func.apply(context, args);\n                };\n            },\n            getIndicatorsWidth = function(){\n                var totalWidth=0;\n                for(var i=0 ; i<numberOfSteps ; i++){\n                    totalWidth += scope.$indicators[i].scrollWidth;\n                }\n                //adds the minimum padding between the steps.\n                return totalWidth+((Number(minimumPadding) || 0)*(numberOfSteps-1));\n            },\n            getIndicatorContainerWidth = function(){\n                return $indicatorContainer[0].clientWidth;\n            },\n            onlyShowCurrentIndicator = function(){\n                $indicatorContainer[0].classList.add('small');\n                updateBar();\n            },\n            showAllIndicators = function(){\n                $indicatorContainer[0].classList.remove('small');\n                updateBar();\n            },\n            //makes sure there's still room for the step indicators, has a debounce on it so it\n            //doesn't fire too often.\n            makeSureTheresRoom = debounce(function(){\n                updateBar();\n                var indicatorsWidth=getIndicatorsWidth();\n                var indicatorContainerWidth=getIndicatorContainerWidth();\n                if((indicatorContainerWidth < indicatorsWidth) &&\n                        (indicatorContainerWidth < (Math.max((scope.indicatorsWidth || 0),indicatorsWidth)))){\n                    scope.indicatorsWidth=indicatorsWidth;\n                    onlyShowCurrentIndicator();\n                }\n                else if(indicatorContainerWidth > scope.indicatorsWidth){\n                    showAllIndicators();\n                }\n            }, 40),\n            watchForWindowResize = function(){\n                $window.bind('resize',function(){\n                    makeSureTheresRoom();\n                });\n            },\n            listenForLanguageChange = function(){\n                scope.$on('languageChange',function(){\n                    showAllIndicators();\n                    makeSureTheresRoom();\n                });\n            },\n            calculateWhereToScroll = function(){\n                var wizardOffset;\n                $cuiExpandableTitle=angular.element(elem[0].querySelector('cui-expandable.mobile-element>cui-expandable-title'))\n                if($cuiExpandableTitle.length!==0) {\n                    var titleHeight=$cuiExpandableTitle[0].clientHeight;\n                }\n                else var titleHeight=0;\n                if(snap.length!==0){\n                    var snapOffset=snap.scrollTop();\n                    wizardOffset=elem[0].getBoundingClientRect().top;\n                    scrollTo(snapOffset+wizardOffset+(titleHeight*(scope.currentStep-1)));\n                }\n                else{\n                    var bodyOffset=$body.scrollTop();\n                    wizardOffset=elem[0].getBoundingClientRect().top;\n                    scrollTo(bodyOffset+wizardOffset+(titleHeight*(scope.currentStep-1)));\n                }\n            },\n            scrollTo = function(position){\n                if(snap.length!==0) snap.animate({scrollTop:position},300,'linear');\n                else $body.animate({scrollTop:position},300,'linear');\n            },\n            updateStep = function(){\n                attrs.$set('step',scope.currentStep);\n            },\n            observeStepAttr = function(){\n                attrs.$observe('step',function(newStep){\n                    if(isNaN(newStep)){\n                        scope.currentStep=1;\n                    }\n                    else if(newStep>numberOfSteps){\n                        scope.currentStep=numberOfSteps;\n                    }\n                    else if(newStep<1){\n                        scope.currentStep=1;\n                    }\n                    else{\n                        scope.currentStep=newStep;\n                    }\n                    updateIndicators();\n                });\n            };\n            init();\n        }\n    };\n}]);\n\nangular.module('cui-ng')\n.directive('cuiWizard',['$timeout','$compile','$window','$rootScope',($timeout,$compile,$window,$rootScope) => {\n    return{\n        restrict: 'E',\n        scope: true,\n        link:(scope,elem,attrs) => {\n            const cuiWizard={\n                initScope:() => {\n                    Object.keys(cuiWizard.scope).forEach(function(property){\n                        scope[property]=cuiWizard.scope[property];\n                    });\n                },\n                config: {\n                    bar: attrs.bar !== undefined,\n                    clickableIndicators: attrs.clickableIndicators !== undefined,\n                    dirtyValidation: attrs.dirtyValidation !== undefined,\n                    minimumPadding: attrs.minimumPadding || 0,\n                    mobileStack: attrs.mobileStack !== undefined,\n                    mobileStackBreakingPoint: parseInt(attrs.mobileStack)\n                },\n                selectors:{\n                    $wizard:angular.element(elem[0]),\n                    $steps:angular.element(elem[0].querySelectorAll('step')),\n                    $indicatorContainer:angular.element(elem[0].querySelectorAll('indicator-container')),\n                    $window:angular.element($window),\n                    $body:angular.element('body')\n                },\n                helpers: {\n                    isFormValid: (form) => {\n                        // Custom dirty-validation behavior\n                        if (cuiWizard.config.dirtyValidation && !form.$valid) {\n                            cuiWizard.helpers.setErrorFieldsToDirty(form);\n                            return false;\n                        }\n                        // Default behavior\n                        else if (!form.$valid) {\n                            cuiWizard.helpers.setErrorFieldsToTouched(form);\n                            return false;\n                        }\n                        return true;\n                    },\n                    setErrorFieldsToDirty: (form) => {\n                        angular.forEach(form.$error, (field) => {\n                            angular.forEach(field, (errorField) => {\n                                errorField.$setDirty();\n                            });\n                        });\n                    },\n                    setErrorFieldsToTouched:(form)=>{\n                        angular.forEach(form.$error, (field) => {\n                            angular.forEach(field, (errorField) => {\n                                errorField.$setTouched();\n                            });\n                        });\n                    },\n                    getStepInfo:(step) => { // step goes from 0 to numberOfSteps\n                        const $step = cuiWizard.selectors.$steps[step];\n                        return {\n                            stepTitle: $step.attributes['step-title'].value,\n                            icon: $step.attributes.icon ? $step.attributes.icon.value : false,\n                            state: $step.attributes.state ? $step.attributes.state.value : false\n                        };\n                    },\n                    getIconMarkup:(icon) => {\n                        if(!icon) return '';\n                        let iconMarkup;\n                        switch (icon.indexOf('.')){\n                            case -1:\n                                iconMarkup = `<cui-icon cui-svg-icon=\"${icon}\" svg-class=\"icon-svg\"></cui-icon>`;\n                                break;\n                            default:\n                                iconMarkup = `<img src=\"${icon}\" class=\"cui-icon-rotate\"/>`;\n                        };\n\n                        return `<div class=\"icon-container\">\n                                    <div class=\"icon\">\n                                        ${iconMarkup}\n                                    </div>\n                                </div>`\n                    },\n                    getNgClickForIndicator:(stepNumber,stepState) => { // stepNUmber from 0 to numberOfSteps\n                        if(!cuiWizard.config.clickableIndicators) return '';\n                        else return `ng-click=\"goToStep(${stepNumber+1}${',' + stepState || ''})\"`;\n                    },\n                    getIndicatorMarkup:(stepNumber) => { // stepNUmber from 0 to numberOfSteps\n                        const step = cuiWizard.helpers.getStepInfo(stepNumber);\n                        let indicatorClass;\n                        stepNumber+1 === cuiWizard.scope.currentStep ? indicatorClass='active' : stepNumber+1 < cuiWizard.scope.currentStep ? indicatorClass='visited' : indicatorClass='';\n                        return `<span class=\"step-indicator ${indicatorClass}\" ${cuiWizard.helpers.getNgClickForIndicator(stepNumber,step.state)}>\n                                    <span class=\"step-indicator__title\">${step.stepTitle}</span> ${cuiWizard.helpers.getIconMarkup(step.icon)}\n                                </span>`;\n                    },\n                    getIndicatorsWidth:() => {\n                        let totalWidth = 0;\n                        cuiWizard.selectors.$indicators.each((i,indicator) => {\n                            totalWidth += $(indicator).width();\n                        });\n                        return totalWidth;\n                    },\n                    thereIsRoomForIndicators:() => {\n                        if((cuiWizard.helpers.getIndicatorsWidth() + (cuiWizard.config.minimumPadding * ( cuiWizard.config.numberOfSteps-1 ))) <\n                            cuiWizard.selectors.$indicatorContainer.width()) return true;\n                        return false;\n                    },\n                    debounce:function(func, wait, immediate){\n                        let timeout;\n                        return function() {\n                            const context = this, args = arguments;\n                            const later = () => {\n                                timeout = null;\n                                if (!immediate) {func.apply(context, args);}\n                            };\n                            const callNow = immediate && !timeout;\n                            clearTimeout(timeout);\n                            timeout = setTimeout(later, wait);\n                            if (callNow) func.apply(context, args);\n                        };\n                    },\n                    resizeHandler:() => {\n                        cuiWizard.helpers.debounce(() => {\n                            if(cuiWizard.config.bar) cuiWizard.reRender.bar(cuiWizard.scope.currentStep);\n                            if(cuiWizard.helpers.thereIsRoomForIndicators() && cuiWizard.config.stepsCollapsed) {\n                                cuiWizard.config.stepsCollapsed = false;\n                                cuiWizard.selectors.$indicatorContainer.removeClass('small');\n                            }\n                            else if(!cuiWizard.helpers.thereIsRoomForIndicators() && !cuiWizard.config.stepsCollapsed) {\n                                cuiWizard.config.stepsCollapsed = true;\n                                cuiWizard.selectors.$indicatorContainer.addClass('small');\n                            }\n                            if(cuiWizard.config.mobileStack && (cuiWizard.selectors.$window.width() <= cuiWizard.config.mobileStackBreakingPoint) && !cuiWizard.config.mobileMode){\n                                cuiWizard.selectors.$expandables.forEach((expandable,e) => {\n                                    expandable.attr('transition-speed',300);\n                                    expandable.addClass('mobile-element');\n                                });\n                                cuiWizard.config.mobileMode = true;\n                            }\n                            else if(cuiWizard.config.mobileStack && (cuiWizard.selectors.$window.width() > cuiWizard.config.mobileStackBreakingPoint) && cuiWizard.config.mobileMode){\n                                cuiWizard.selectors.$expandables.forEach((expandable,e) => {\n                                    expandable.attr('transition-speed',0);\n                                    expandable.removeClass('mobile-element');\n                                });\n                                cuiWizard.config.mobileMode = false;\n                            }\n                        },200)();\n                    },\n                    scrollToStep:(newStep) => {\n                        const firstExpandableTitle = angular.element(cuiWizard.selectors.$expandables[0].children()[0]);\n                        const firstExpandableOffset = firstExpandableTitle.offset();\n                        const titleHeight=firstExpandableTitle[0].scrollHeight;\n                        cuiWizard.selectors.$body.animate({ scrollTop: firstExpandableOffset.top + (titleHeight * (newStep-1)) } , 300 , 'linear');\n                    }\n                },\n                scope:{\n                    currentStep : Number(elem[0].attributes.step.value),\n                    wizardFinished : false,\n                    next:(state) => { // state is optional\n                        if(state) cuiWizard.scope.goToState(state);\n                        else cuiWizard.update(cuiWizard.scope.currentStep + 1);\n                    },\n                    nextWithErrorChecking:(form,state) => {\n                        if(cuiWizard.helpers.isFormValid(form)) cuiWizard.scope.next(state);\n                    },\n                    previous:(state) => {\n                        if(state) cuiWizard.scope.goToSate(state);\n                        else cuiWizard.update(cuiWizard.scope.currentStep-1);\n                    },\n                    goToStep:(newStep,state) => {\n                        if(newStep===cuiWizard.scope.currentStep) return;\n                        if(state) cuiWizard.scope.goToState(state);\n                        cuiWizard.update(newStep);\n                    },\n                    goToState:(state) => {\n                        $rootScope.$broadcast('stepChange',{ state, element:elem });\n                    }\n                },\n                watchers:{\n                    init:() => {\n                        cuiWizard.watchers.windowResize();\n                        cuiWizard.watchers.languageChange();\n                    },\n                    windowResize:() => {\n                        cuiWizard.selectors.$window.bind('resize',cuiWizard.helpers.resizeHandler);\n                    },\n                    languageChange:() => {\n                        scope.$on('languageChange',() => {\n                            if(cuiWizard.helpers.thereIsRoomForIndicators() && cuiWizard.config.stepsCollapsed) {\n                                cuiWizard.config.stepsCollapsed=false;\n                                cuiWizard.selectors.$indicatorContainer.removeClass('small');\n                            }\n                            else if(!cuiWizard.helpers.thereIsRoomForIndicators() && !cuiWizard.config.stepsCollapsed) {\n                                cuiWizard.config.stepsCollapsed=true;\n                                cuiWizard.selectors.$indicatorContainer.addClass('small');\n                            }\n                            if(cuiWizard.config.bar) cuiWizard.reRender.bar(cuiWizard.scope.currentStep);\n                        });\n                    }\n                },\n                render:{\n                    indicators:() => {\n                        cuiWizard.selectors.$indicatorContainer.append(`<div class=\"cui-steps\"></div>`);\n                        cuiWizard.selectors.$stepIndicatorContainer=angular.element(cuiWizard.selectors.$indicatorContainer[0].querySelector('.cui-steps'));\n                        cuiWizard.selectors.$steps.each((i,step) => {\n                            const indicator = angular.element(cuiWizard.helpers.getIndicatorMarkup(i)),\n                                compiledIndicator = $compile(indicator)(scope);\n                            cuiWizard.selectors.$stepIndicatorContainer.append(compiledIndicator);\n                        });\n                        cuiWizard.selectors.$indicators = angular.element(cuiWizard.selectors.$stepIndicatorContainer[0].querySelectorAll('.step-indicator'));\n                        cuiWizard.config.numberOfSteps = cuiWizard.selectors.$indicators.length;\n                    },\n                    bar:() => {\n                      $timeout(() => {\n                        cuiWizard.selectors.$indicatorContainer.append(`<div class=\"steps-bar\"><div class=\"steps-bar-fill\"></div></div>`);\n                        cuiWizard.selectors.$bar = angular.element(cuiWizard.selectors.$indicatorContainer[0].querySelector('.steps-bar'));\n                        cuiWizard.selectors.$barFill = angular.element(cuiWizard.selectors.$indicatorContainer[0].querySelector('.steps-bar-fill'));\n                        cuiWizard.selectors.$bar[0].style.left = cuiWizard.selectors.$indicators[0].scrollWidth/2 + 'px'; // bar starts at the center point of the 1st inicator\n                        cuiWizard.selectors.$bar[0].style.right = cuiWizard.selectors.$indicators[cuiWizard.config.numberOfSteps-1].scrollWidth/2 + 'px'; // ends at center of last indicator\n                        if(cuiWizard.scope.currentStep===1) cuiWizard.selectors.$barFill[0].style.width = '0px';\n                        else {\n                            cuiWizard.selectors.$barFill[0].style.width=cuiWizard.selectors.$indicators[cuiWizard.scope.currentStep-1].offsetLeft - (cuiWizard.selectors.$indicators[0]. scrollWidth/2) + (cuiWizard.selectors.$indicators[cuiWizard.scope.currentStep-1].scrollWidth/2) + 'px';\n                        }\n                      });\n                    },\n                    steps:() => {\n                        if(!cuiWizard.config.mobileStack) return;\n                        cuiWizard.selectors.$expandables=[];\n                        cuiWizard.selectors.$steps.each((i,step) => {\n                            const stepInfo = cuiWizard.helpers.getStepInfo(i);\n                            let expandableClass='';\n                            if(cuiWizard.scope.currentStep===i+1) {\n                                $(step).addClass('active');\n                                expandableClass='expanded';\n                            }\n                            const expandable=$($compile( // compile a new expandable\n                                `<cui-expandable class=\"cui-expandable cui-expandable--wizard ${expandableClass}\" transition-speed=\"0\">\n                                    <cui-expandable-title class=\"cui-expandable__title cui-expandable__title--wizard\">\n                                        ${cuiWizard.helpers.getIndicatorMarkup(i)}\n                                    </cui-expandable-title>\n                                    <cui-expandable-body class=\"cui-expandable__body cui-expandable__body--wizard\"></cui-expandable-body>\n                                </cui-expandable>`\n                            )(scope));\n                            expandable.insertBefore(step);\n                            $(step).detach().appendTo(expandable.children()[1]);\n                            cuiWizard.selectors.$expandables.push($(step).parent().parent());\n                        });\n                    }\n                },\n                reRender:{\n                    indicators:(newStep,oldStep) => { // newStep goes from 1 to numberOfSteps+1\n                        cuiWizard.selectors.$indicators.each((i,indicator) => {\n                            if((i+1) < newStep) $(indicator).addClass('visited');\n                            else $(indicator).removeClass('visited');\n                        });\n                        cuiWizard.selectors.$indicators[oldStep-1].classList.remove('active');\n                        cuiWizard.selectors.$indicators[newStep-1].classList.add('active');\n                    },\n                    steps:(newStep,oldStep) => {\n                        cuiWizard.selectors.$expandables.forEach((expandable,i) => {\n                            if((i+1) < newStep) expandable.addClass('visited');\n                            else expandable.removeClass('visited');\n                        });\n                        cuiWizard.selectors.$steps[oldStep-1].classList.remove('active');\n                        cuiWizard.selectors.$steps[newStep-1].classList.add('active');\n                        cuiWizard.selectors.$expandables[oldStep-1].removeClass('expanded');\n                        cuiWizard.selectors.$expandables[newStep-1].addClass('expanded');\n                        cuiWizard.selectors.$expandables[oldStep-1][0].querySelector('.step-indicator').classList.remove('active');\n                        cuiWizard.selectors.$expandables[newStep-1][0].querySelector('.step-indicator').classList.add('active');\n                    },\n                    indicatorContainer:() => {\n                        if(cuiWizard.helpers.thereIsRoomForIndicators() && cuiWizard.config.stepsCollapsed) {\n                            cuiWizard.config.stepsCollapsed = false;\n                            cuiWizard.selectors.$indicatorContainer.removeClass('small');\n                        }\n                        else if(!cuiWizard.helpers.thereIsRoomForIndicators() && !cuiWizard.config.stepsCollapsed) {\n                            cuiWizard.config.stepsCollapsed = true;\n                            cuiWizard.selectors.$indicatorContainer.addClass('small');\n                        }\n                    },\n                    bar:(newStep) => {\n                        if(newStep===1) cuiWizard.selectors.$barFill[0].style.width='0px';\n                        else {\n                            cuiWizard.selectors.$barFill[0].style.width=cuiWizard.selectors.$indicators[newStep-1].offsetLeft - (cuiWizard.selectors.$indicators[0]. scrollWidth/2) + (cuiWizard.selectors.$indicators[newStep-1].scrollWidth/2) + 'px';\n                        }\n                    }\n                },\n                update:(newStep,oldStep) => {\n                    if(cuiWizard.config.mobileMode) cuiWizard.helpers.scrollToStep(newStep);\n                    cuiWizard.reRender.indicators(newStep,cuiWizard.scope.currentStep);\n                    if(cuiWizard.config.mobileStack) cuiWizard.reRender.steps(newStep,cuiWizard.scope.currentStep);\n                    if(cuiWizard.config.bar) cuiWizard.reRender.bar(newStep);\n                    scope.currentStep=cuiWizard.scope.currentStep=newStep;\n                    if(newStep===cuiWizard.config.numberOfSteps) scope.wizardFinished=cuiWizard.scope.wizardFinished=true;\n                    attrs.$set('step',newStep);\n                }\n            };\n            cuiWizard.initScope();\n            cuiWizard.render.indicators();\n            if (cuiWizard.config.bar) cuiWizard.render.bar();\n            cuiWizard.render.steps();\n            cuiWizard.watchers.init();\n            cuiWizard.selectors.$window.resize();\n        }\n    };\n}]);\n\nangular.module('cui-ng')\n.directive('customError', ($q) => {\n    return {\n        restrict: 'A',\n        require:'ngModel',\n        scope: {\n            customError: '=',\n            customErrorLoading: '=?'\n        },\n        link: (scope, attrs, ele, ctrl) => {\n            let promises = {}\n\n            scope.$watch(() => ctrl.$modelValue, (newValue, oldValue) => {\n                angular.forEach(scope.customError, (checkFunction, errorName) => {\n                    const checkFunctionReturn = checkFunction(newValue)\n\n                    if (typeof checkFunctionReturn === 'boolean') {\n                        ctrl.$setValidity(errorName, checkFunctionReturn)\n                    }\n                    else {\n                        scope.customErrorLoading = true\n\n                        if (!promises[errorName]) promises[errorName] = [checkFunctionReturn.promise]\n                        else promises[errorName].push(checkFunctionReturn.promise)\n\n                        $q.all(promises[errorName]).then( res => {\n                            ctrl.$setValidity(errorName, checkFunctionReturn.valid(res[promises[errorName].length-1]))\n                            scope.customErrorLoading = false\n                        }, \n                        err => {\n                            checkFunctionReturn.catch && checkFunctionReturn.catch(err)\n                            scope.customErrorLoading = false\n                        })\n                    }\n                })\n            }, (newValue,oldValue) => newValue !== oldValue )\n        }\n    }\n})\n\n\nangular.module('cui-ng')\n.directive('focusIf', ['$timeout',($timeout) => {\n    return {\n        restrict: 'A',\n        link: (scope, elem, attrs) => {\n            const element = elem[0];\n\n            const focus = (condition) => {\n                if (condition) {\n                    $timeout(() => {\n                        element.focus();\n                    }, scope.$eval(attrs.focusDelay) || 0);\n                }\n            };\n\n            if (attrs.focusIf) {\n                scope.$watch(attrs.focusIf, focus);\n            } else {\n                focus(true);\n            }\n        }\n    };\n}]);\n\nangular.module('cui-ng')\n.directive('inlineEdit', ['$compile', '$timeout','$filter', ($compile, $timeout, $filter) => {\n  return {\n    restrict: 'E',\n    scope:{\n      model: '=',\n      type: '@',\n      options: '=',\n      display: '=',\n      localData: '=',\n      saveCallback: '&onSave',\n      tempEditCallback: '&onEdit',\n      hideSaveButton: '=hideSaveIf'\n    },\n    link: (scope,ele,attrs) => {\n      const inlineEdit = {\n        init: () => {\n          angular.forEach(inlineEdit.scope,(initScope)=>{\n            initScope();\n          });\n        },\n        config:{\n          valueClass:attrs.valueClass || \"cui-field-val__val\",\n          inputClass:attrs.inputClass || \"cui-field-val__val\",\n          labelClass:attrs.labelClass || \"cui-field-val__field\",\n          wrapperClass:attrs.wrapperClass || \"cui-field-val\"\n        },\n        scope:{\n          init:() => {\n            scope.edit=false;\n            scope.focus=false;\n          },\n          functions:() => {\n            scope.toggleEdit = () => {\n              scope.focus = scope.edit = !scope.edit;\n              if(scope.tempEditCallback) scope.editChangeCallback(scope.edit);\n            };\n            scope.matchModels = () => {\n              scope.editInput = scope.model;\n            };\n            scope.saveInput = () => {\n              scope.model = scope.editInput;\n              if(scope.saveCallback()) {\n                $timeout(() => {\n                  scope.saveCallback()();\n                });\n              }\n              inlineEdit.helpers.setDisplayValue();\n            };\n            scope.parseKeyCode = (e) => {\n              switch (event.which){\n                case 13:\n                  scope.saveInput();\n                  scope.toggleEdit();\n                  break;\n                case 27:\n                  scope.toggleEdit();\n                  break;\n              }\n            };\n            scope.editChangeCallback = (editMode) => {\n              if(editMode === false) {\n                scope.tempEditCallback() && scope.tempEditCallback()(undefined);\n                return;\n              }\n              scope.tempEditCallback() && scope.tempEditCallback()(scope.editInput);\n            };\n          },\n          watchers:() => {\n            scope.$watch('display',inlineEdit.helpers.setDisplayValue);\n            scope.$watch('model',inlineEdit.helpers.setDisplayValue);\n          }\n        },\n\n        helpers:{\n          getLabel:() => {\n            let label;\n            if(attrs.label!==undefined) return `{{'${attrs.label}'| translate}}`;\n            else if(attrs.name!==undefined) return attrs.name;\n            else throw new Error('Inline-edit needs 1 of the following attributes: label or name.');\n          },\n          getInput:() => {\n            attrs.type=attrs.type || 'text';\n            switch(attrs.type){\n              case 'dropdown':\n                return `<select ng-model=\"$parent.editInput\" class=\"${inlineEdit.config.inputClass}\" ng-init=\"matchModels()\" ng-options=\"${attrs.optionsExpression}\"\n                  ng-if=\"edit\" ng-change=\"editChangeCallback()\"></select>`\n              case 'auto-complete':\n                return `<div auto-complete selected-object=\"$parent.editInput\" local-data=\"localData\" search-fields=\"${attrs.searchFields}\"\n                  title-field=\"${attrs.titleField}\" input-class=\"${inlineEdit.config.inputClass}\" match-class=\"highlight\" ng-init=\"matchModels()\" auto-match=\"true\"\n                  ng-if=\"edit\" ng-keypress=\"parseKeyCode($event)\" initial-value=\"$parent.editInput.title\" input-changed=\"editChangeCallback()\"></div>`\n              default:\n                return `<input type=\"${attrs.type}\" ng-model=\"$parent.editInput\" class=\"${inlineEdit.config.inputClass}\"\n                  ng-init=\"matchModels()\" ng-if=\"edit\" ng-keyup=\"parseKeyCode($event)\" focus-if=\"focus\" ng-change=\"editChangeCallback()\"/>`\n\n            }\n          },\n          setDisplayValue:() => {\n            if(attrs.type===\"password\") {\n              scope.displayValue = Array(scope.model? scope.model.length+1 : 0).join('•');\n            }\n            else scope.displayValue = scope.display || scope.model;\n          }\n        },\n        render:() => {\n          const element= $compile(\n            `<div class=\"${inlineEdit.config.wrapperClass}\">\n                <span class=\"${inlineEdit.config.labelClass}\">${inlineEdit.helpers.getLabel()}</span>\n                <span ng-if=\"!edit\" class=\"${inlineEdit.config.valueClass}\">{{displayValue}}</span>${inlineEdit.helpers.getInput()}\n            </div>\n            <span class=\"cui-link\" ng-click=\"toggleEdit()\" ng-if=\"!edit\">{{\"cui-edit\" | translate}}</span>\n            <span class=\"cui-link\" ng-if=\"edit && !hideSaveButton\" ng-click=\"saveInput();toggleEdit();\">{{\"cui-update\" | translate}}</span>\n            <span class=\"cui-link\" ng-if=\"edit\" ng-click=\"toggleEdit()\">{{\"cui-cancel\" | translate}}</span>`\n          )(scope);\n          angular.element(ele[0]).html(element);\n        }\n      };\n      inlineEdit.init();\n      inlineEdit.render();\n    }\n  };\n}]);\n\n\n\nangular.module('cui-ng')\n.directive('match', ['$parse', ($parse) => {\n  return {\n    restrict: 'A',\n    require: 'ngModel',\n    link: (scope, element, attrs, ctrl) => {\n      const checkIfMatch = (values) => {\n        ctrl.$setValidity('match', values[0] === (values[1] || ''));\n      };\n\n      scope.$watch(()=> [scope.$eval(attrs.match), ctrl.$viewValue], checkIfMatch, (newValues,oldValues) => !angular.equals(newValues,oldValues));\n    }\n  };\n}]);\n\nangular.module('cui-ng')\n.directive('offClickFilter', (OffClickFilterCache, $parse) => {\n    let filters;\n\n    return {\n        restrict:'A',\n        compile : (elem, attrs)  => {\n            return (scope, element) => {\n                filters = $parse(attrs.offClickFilter)(scope).split(',').map(x => x.trim());\n\n                filters.forEach(filter => {\n                    OffClickFilterCache[filter] ? OffClickFilterCache[filter].push(element[0]) : OffClickFilterCache[filter] = [element[0]];\n                });\n\n                scope.$on('$destroy',()  => {\n                    filters.forEach((filter) => {\n                        if(OffClickFilterCache[filter].length > 1)  {\n                            OffClickFilterCache[filter].splice(OffClickFilterCache[filter].indexOf(element[0]), 1);\n                        }\n                        else {\n                            OffClickFilterCache[filter] = null;\n                            delete OffClickFilterCache[filter];\n                        }\n                    });\n                    element = null;\n                });\n            };\n        }\n    };\n});\n\nangular.module('cui-ng')\n.directive('offClick', ($rootScope, $parse, OffClickFilterCache) => {\n    let id = 0;\n    let listeners = {};\n    // add variable to detect touch users moving..\n    let touchMove = false;\n\n    const targetInFilter = (target, elms) => {\n        if (!target || !elms) return false;\n        const elmsLen = elms.length;\n        for (let i = 0; i < elmsLen; ++i) {\n            const currentElem = elms[i];\n            let containsTarget = false;\n            try {\n                containsTarget = currentElem.contains(target);\n            } catch (e) {\n                // If the node is not an Element (e.g., an SVGElement) node.contains() throws Exception in IE,\n                // see https://connect.microsoft.com/IE/feedback/details/780874/node-contains-is-incorrect\n                // In this case we use compareDocumentPosition() instead.\n                if (typeof currentElem.compareDocumentPosition !== 'undefined') {\n                    containsTarget = currentElem === target || Boolean(currentElem.compareDocumentPosition(target) & 16);\n                }\n            }\n\n            if (containsTarget) {\n                return true;\n            }\n        }\n        return false;\n    }\n\n    const offClickEventHandler = (event) => {\n        // If event is a touchmove adjust touchMove state\n        if( event.type === 'touchmove' ){\n            touchMove = true;\n            // And end function\n            return false;\n        }\n        // This will always fire on the touchend after the touchmove runs...\n        if( touchMove ){\n            // Reset touchmove to false\n            touchMove = false;\n            // And end function\n            return false;\n        }\n        const target = event.target || event.srcElement;\n        angular.forEach(listeners, (listener, i) => {\n            let filters = OffClickFilterCache['*'] || [];\n            if(listener.elm.id && listener.elm.id !== '') {\n                if(OffClickFilterCache['#' + listener.elm.id]) filters = filters.concat(OffClickFilterCache['#'+listener.elm.id]);\n            }\n            // classList is an object in IE10 and 11 iirc, using angular.forEach to iterate both over an array or object values\n            angular.forEach(listener.elm.classList, (className) => {\n                if(OffClickFilterCache['.' + className]) filters = filters.concat(OffClickFilterCache['.' + className]);\n            });\n            if (!(listener.elm.contains(target) || targetInFilter(target, filters))) {\n                $rootScope.$evalAsync(() => {\n                    listener.cb(listener.scope, {\n                        $event: event\n                    });\n                });\n            }\n\n        });\n    }\n\n\n    // Add event listeners to handle various events. Destop will ignore touch events\n    document.addEventListener(\"touchmove\", offClickEventHandler, true);\n    document.addEventListener(\"touchend\", offClickEventHandler, true);\n    document.addEventListener('click', offClickEventHandler, true);\n\n\n    return {\n        restrict: 'A',\n        compile: (elem, attrs) => {\n            const fn = $parse(attrs.offClick);\n\n            const elmId = id++;\n            let removeWatcher;\n\n            return (scope, element) => {\n                const on = () => {\n                    listeners[elmId] = {\n                        elm: element[0],\n                        cb: fn,\n                        scope: scope\n                    };\n                };\n\n                const off = () => {\n                    listeners[elmId] = null;\n                    delete listeners[elmId];\n                };\n\n                if (attrs.offClickIf) {\n                    removeWatcher = $rootScope.$watch(() => $parse(attrs.offClickIf)(scope), (newVal) => {\n                        newVal && on() || !newVal && off()\n                    });\n                } else on();\n\n                scope.$on('$destroy', () => {\n                    off();\n                    if (removeWatcher) {\n                        removeWatcher();\n                    }\n                    element = null;\n                });\n            };\n        }\n    };\n});\n\nangular.module('cui-ng')\n.factory('OffClickFilterCache', () => {\n    let filterCache = {};\n    return filterCache;\n});\n\nangular.module('cui-ng')\n.directive('onEnter',['$timeout',($timeout) => {\n    return {\n        restrict:'A',\n        require: 'ngModel',\n        link:(scope,element,attrs,ctrl) => {\n            element.bind(\"keydown keypress\", (event) => {\n                if(event.which === 13) {\n                    event.preventDefault();\n                    const callback = scope.$eval(attrs.onEnter);\n                    $timeout(() => {\n                        callback(ctrl.$viewValue);\n                    });\n                }\n            });\n\n            scope.$on('destroy',() => {\n                element.unbind();\n            });\n        }\n    };\n}]);\n\nangular.module('cui-ng')\n.directive('paginate',['$compile','$timeout','$interval','$pagination',($compile,$timeout,$interval,$pagination) => {\n    return {\n        restrict: 'AE',\n        scope: {\n            resultsPerPage: '&',\n            count: '&',\n            onPageChange: '&',\n            page: '=ngModel',\n            attachRerenderTo: '='\n        },\n        link: (scope, elem, attrs) => {\n            let resizeInterval;\n            const paginate = {\n                initScope:() => {\n                    scope.paginate = {\n                        currentPage:scope.page? paginate.helpers.normalizePage(scope.page) : 1\n                    };\n                    paginate.helpers.updateConfig();\n                    paginate.render.pageContainer();\n                    if(attrs.attachRerenderTo) scope.attachRerenderTo = paginate.scope.updateConfigAndReRender;\n                    angular.forEach(paginate.scope,(func,key) => {\n                        scope.paginate[key]=func;\n                    });\n                },\n                selectors:{\n                    $paginate:angular.element(elem[0])\n                },\n                config:{\n                    pageClass:attrs.pageClass || 'cui-paginate__page',\n                    activePageClass:attrs.activePageClass || 'cui-paginate__page--active',\n                    ellipsesClass: attrs.ellipsesClass || 'cui-paginate__ellipses',\n                    previousClass: attrs.previousNextClass || 'cui-paginate__previous',\n                    nextClass: attrs.previousNextClass || 'cui-paginate__next',\n                    pageContainerClass: attrs.pageContainerClass || 'cui-paginate__page-container',\n                    ellipsesButton: attrs.ellipses || '...',\n                    previousButton: attrs.previousButton || '',\n                    nextButton: attrs.nextButton || '',\n                    hidePagination: attrs.hidePagination || true\n                },\n                watchers:{\n                    resultsPerPage:() => {\n                        scope.$watch(scope.resultsPerPage,(newCount,oldCount) => {\n                            if(newCount && oldCount && newCount!==oldCount){\n                                scope.page = scope.paginate.currentPage = 1;\n                                paginate.helpers.updateConfig();\n                                paginate.scope.reRender();\n                                $timeout(()=>{\n                                    if(scope.onPageChange()) scope.onPageChange()(scope.paginate.currentPage);\n                                });\n                            }\n                        });\n                    },\n                    page:() => {\n                        scope.$watch('page',(newPage,oldPage) => {\n                            if(newPage && newPage!==scope.paginate.currentPage) {\n                                scope.page = scope.paginate.currentPage = paginate.helpers.normalizePage(newPage);\n                                paginate.helpers.updateConfig();\n                                paginate.scope.reRender();\n                            }\n                        });\n                    },\n                    paginateResize:() => {\n                        resizeInterval=$interval(paginate.helpers.resizeHandler,50);\n                    },\n                    scopeDestroy:() => {\n                        scope.$on('$destroy',() => {\n                            $interval.cancel(resizeInterval); // unbinds the resize interval\n                        });\n                    }\n                },\n                helpers:{\n                    updateConfig:() => {\n                        paginate.config.numberOfPages = paginate.helpers.getNumberOfPages();\n                        paginate.config.howManyPagesWeCanShow = paginate.helpers.howManyPagesWeCanShow();\n                    },\n                    getNumberOfPages:() => Math.ceil(scope.count()/scope.resultsPerPage()),\n                    getWidthOfAPage:() => paginate.helpers.getWidthOfElement($(paginate.render.pageNumber(1))),\n                    getAvailableSpaceForPages:() => {\n                        const paginateWidth = paginate.config.width || paginate.selectors.$paginate.width();\n                        const previousWidth = paginate.helpers.getWidthOfElement(paginate.render.previousButton());\n                        const nextWidth = paginate.helpers.getWidthOfElement(paginate.render.nextButton());\n                        return paginateWidth - ( previousWidth + nextWidth )-1; // - 1 because at certain widths the width() method was off by a pixel\n                    },\n                    getWidthOfElement:(element) => { // this appends the element to the body, get its width, and removes it. Used for measuring.\n                        element.appendTo(document.body);\n                        const width=element.outerWidth(true);\n                        element.remove();\n                        return width;\n                    },\n                    howManyPagesWeCanShow:() => Math.floor(paginate.helpers.getAvailableSpaceForPages()/paginate.helpers.getWidthOfAPage()),\n                    handleStepChange:() => {\n                        scope.page = scope.paginate.currentPage = paginate.helpers.normalizePage(scope.paginate.currentPage);\n                        $timeout(()=>{\n                            if(scope.onPageChange()) scope.onPageChange()(scope.paginate.currentPage);\n                            paginate.scope.reRender();\n                        });\n                    },\n                    resizeHandler:() => {\n                        if(!paginate.config.width) paginate.config.width = paginate.selectors.$paginate.width();\n                        else if(paginate.selectors.$paginate.width() !== paginate.config.width) {\n                            paginate.config.width = paginate.selectors.$paginate.width();\n                            paginate.helpers.updateConfig();\n                            paginate.scope.reRender();\n                        }\n                    },\n                    whatEllipsesToShow:() => {\n                        if(paginate.config.numberOfPages <= paginate.config.howManyPagesWeCanShow) return 'none';\n                        else if(scope.paginate.currentPage < ((paginate.config.howManyPagesWeCanShow/2)+1)) return 'right';\n                        else if(scope.paginate.currentPage < (paginate.config.numberOfPages -  (paginate.config.howManyPagesWeCanShow/2))) return 'both';\n                        else return 'left';\n                    },\n                    normalizePage:(pageNumber) => {\n                        const page = parseInt(pageNumber);\n                        if(page <= paginate.config.numberOfPages && page >= 1){\n                            return page;\n                        }\n                        else if(page < 1){\n                            return 1;\n                        }\n                        else return paginate.config.numberOfPages;\n                    }\n                },\n                scope:{\n                    previous:() => {\n                        if(scope.paginate.currentPage > 1){\n                            scope.paginate.currentPage--;\n                            paginate.helpers.handleStepChange();\n                        }\n                    },\n                    next:() => {\n                        if(scope.paginate.currentPage+1 <= paginate.config.numberOfPages){\n                            scope.paginate.currentPage++;\n                            paginate.helpers.handleStepChange();\n                        }\n                    },\n                    goToPage:(page) => {\n                        if(page === scope.paginate.currentPage) return;\n                        scope.paginate.currentPage = paginate.helpers.normalizePage(page);\n                        paginate.helpers.handleStepChange();\n                    },\n                    reRender:() => {\n                        paginate.selectors.$pageContainer.replaceWith(paginate.render.pageContainer());\n                    },\n                    updateConfigAndReRender:() => {\n                        paginate.helpers.updateConfig();\n                        if(scope.paginate.currentPage > paginate.config.numberOfPages) {\n                            scope.page = scope.paginate.currentPage = paginate.helpers.normalizePage(scope.paginate.currentPage);\n                            paginate.scope.reRender();\n                        }\n                        else {\n                            paginate.scope.reRender();\n                        }\n                    }\n                },\n                render:{\n                    init:() => {\n                        scope.options = $pagination.getPaginationOptions();\n                        if(scope.count() <= scope.options.intervals[0] && scope.options.hidePaginationUnderMin === true) paginate.selectors.$paginate.parent('.cui-paginate__container').css({'display': 'none'});\n                        paginate.selectors.$paginate.append(paginate.render.previousButton());\n                        paginate.selectors.$paginate.append(paginate.render.pageContainer());\n                        paginate.selectors.$paginate.append(paginate.render.nextButton());\n                    },\n                    previousButton:() => {\n                        const previousButton = $compile(\n                            `<span ng-click=\"paginate.previous()\" class=\"${paginate.config.previousClass}\">\n                                ${paginate.config.previousButton}\n                            </span>`\n                        )(scope);\n                        return previousButton;\n                    },\n                    nextButton:() => {\n                        const nextButton = $compile(\n                            `<span ng-click=\"paginate.next()\" class=\"${paginate.config.nextClass}\">\n                                ${paginate.config.nextButton}\n                            </span>`\n                        )(scope);\n                        return nextButton;\n                    },\n                    ellipses:(page) => {\n                        const ngClick=`ng-click=\"paginate.goToPage(${page})\"`;\n                        const ellipses = $compile(`<span ${ngClick} class=\"${paginate.config.ellipsesClass}\">${paginate.config.ellipsesButton}</span>`)(scope);\n                        return ellipses;\n                    },\n                    pageNumber:(page,active) => {\n                        let activeClass, ngClick;\n                        ngClick = `ng-click=\"paginate.goToPage(${page})\"`;\n                        active? activeClass=`${paginate.config.activePageClass}` : activeClass='';\n                        const button=$compile(`<span ${ngClick} class=\"${paginate.config.pageClass} ${activeClass}\">${page}</span>`)(scope);\n                        return button;\n                    },\n                    pagesXToY:(x,y) => {\n                        let pages=[];\n                        do {\n                            const page = paginate.render.pageNumber(x, x===(scope.paginate.currentPage || scope.page ));\n                            pages.push(page);\n                            x++;\n                        }\n                        while(x <= y);\n                        return pages;\n                    },\n                    pageNumbers:() => {\n                        const whatEllipsesToShow = paginate.helpers.whatEllipsesToShow();\n                        let pages = [];\n                        switch (whatEllipsesToShow){\n                            case 'none':\n                                pages.push(paginate.render.pagesXToY(1, paginate.config.numberOfPages));\n                                break;\n                            case 'right':\n                                const ellipsesPoint = paginate.config.howManyPagesWeCanShow - 1;\n                                pages.push(paginate.render.pagesXToY(1,ellipsesPoint-1));\n                                pages.push(paginate.render.ellipses(ellipsesPoint));\n                                pages.push(paginate.render.pageNumber(paginate.config.numberOfPages));\n                                break;\n                            case 'left':\n                                const ellipsesPointLeft = paginate.config.numberOfPages - (paginate.config.howManyPagesWeCanShow-2);\n                                pages.push(paginate.render.pageNumber(1));\n                                pages.push(paginate.render.ellipses(ellipsesPointLeft));\n                                pages.push(paginate.render.pagesXToY(ellipsesPointLeft+1, paginate.config.numberOfPages));\n                                break;\n                            case 'both':\n                                const firstEllipsesPoint=scope.paginate.currentPage - (Math.ceil(paginate.config.howManyPagesWeCanShow/2)-2);\n                                const secondEllipsesPoint=scope.paginate.currentPage + (Math.floor(paginate.config.howManyPagesWeCanShow/2)-1);\n                                pages.push(paginate.render.pageNumber(1));\n                                pages.push(paginate.render.ellipses(firstEllipsesPoint));\n                                pages.push(paginate.render.pagesXToY(firstEllipsesPoint+1, secondEllipsesPoint-1));\n                                pages.push(paginate.render.ellipses(secondEllipsesPoint));\n                                pages.push(paginate.render.pageNumber(paginate.config.numberOfPages));\n                                break;\n                        };\n                        return pages;\n                    },\n                    pageContainer:() => {\n                        const pageContainer = $(`<span class=\"${paginate.config.pageContainerClass}\"></span>`);\n                        paginate.selectors.$pageContainer = pageContainer;\n                        paginate.render.pageNumbers().forEach((page) => {\n                            pageContainer.append(page);\n                        });\n                        return pageContainer;\n                    }\n                }\n            };\n\n            $timeout(() => {\n                paginate.initScope();\n                paginate.render.init();\n                angular.forEach(paginate.watchers,(initWatcher) => {\n                    initWatcher();\n                });\n            });\n        }\n    };\n}]);\n\nangular.module('cui-ng')\n.factory('CuiPasswordInfo',[() => {\n    let policies={};\n    let info={};\n    return { info, policies };\n}])\n.factory('CuiPasswordValidators',['CuiPasswordInfo',(CuiPasswordInfo) => {\n    RegExp.escape = (text) => text.replace(/[-[\\]{}()*+?.,\\\\^$|#\\s]/g, \"\\\\$&\");\n\n    const validators = (policies, id) => {\n        CuiPasswordInfo.info[id] = {}; // Initialize the object that holds the info for this password validation (disallowedWords, disallowedChars)\n        return {\n            lowercase: (modelValue,viewValue) => {\n                if(!modelValue) return false;\n                if(getValidators(policies,id).complex(modelValue,viewValue)) return true;\n                return /.*[a-z].*/.test(viewValue);\n            },\n            uppercase: (modelValue,viewValue) => {\n                if(!modelValue) return false;\n                if(getValidators(policies,id).complex(modelValue,viewValue)) return true;\n                return /.*[A-Z].*/.test(viewValue);\n            },\n            number: (modelValue,viewValue) => {\n                if(!modelValue) return false;\n                if(getValidators(policies,id).complex(modelValue,viewValue)) return true;\n                return /.*[0-9].*/.test(viewValue);\n            },\n            special: (modelValue,viewValue) => {\n                if(!modelValue) return false;\n                if(getValidators(policies,id).complex(modelValue,viewValue)) return true;\n                return !(/^[a-z0-9]+$/i.test(viewValue));\n            },\n            complex: (modelValue,viewValue) => {\n                if(!modelValue) return false;\n                let numberOfUsedClasses=0;\n                if(policies.allowLowerChars){\n                    if (/.*[a-z].*/.test(viewValue)) numberOfUsedClasses++;\n                }\n                if(policies.allowUpperChars){\n                    if (/.*[A-Z].*/.test(viewValue)) numberOfUsedClasses++;\n                }\n                if(policies.allowSpecialChars){\n                    if (!(/^[a-z0-9]+$/i.test(viewValue))) numberOfUsedClasses++;\n                }\n                if(policies.allowNumChars){\n                    if (/.*[0-9].*/.test(viewValue)) numberOfUsedClasses++;\n                }\n                return numberOfUsedClasses >= policies.requiredNumberOfCharClasses;\n            },\n            lowercaseNotAllowed: (modelValue,viewValue) => {\n                if(!viewValue) return true;\n                return !(/.*[a-z].*/.test(viewValue));\n            },\n            uppercaseNotAllowed: (modelValue,viewValue) => {\n                if(!viewValue) return true;\n                return !(/.*[A-Z].*/.test(viewValue));\n            },\n            numberNotAllowed: (modelValue,viewValue) => {\n                if(!viewValue) return true;\n                return !(/.*[0-9].*/.test(viewValue));\n            },\n            specialNotAllowed: (modelValue,viewValue) => {\n                if(!viewValue) return true;\n                return /^[a-z0-9]+$/i.test(viewValue);\n            },\n            disallowedChars: (modelValue,viewValue) => {\n                if(!viewValue) return true;\n                var valid = true;\n                var disallowedChars = [];\n                policies.disallowedChars.split('').forEach((disallowedChar) => {\n                    if(viewValue.indexOf(disallowedChar)> -1){\n                        valid=false;\n                        disallowedChars.push(disallowedChar);\n                    }\n                });\n                CuiPasswordInfo.info[id].disallowedChars = disallowedChars.join(', ');\n                return valid;\n            },\n            disallowedWords: (modelValue,viewValue) => {\n                if(!viewValue) return true;\n                let valid = true;\n                let disallowedWords = [];\n                policies.disallowedWords.forEach((word) => {\n                    if(viewValue.toUpperCase().indexOf(word.toUpperCase())>-1){\n                        valid=false;\n                        disallowedWords.push(word);\n                    }\n                });\n                CuiPasswordInfo.info[id].disallowedWords = disallowedWords.join(', ');\n                return valid;\n            },\n            length: (modelValue,viewValue) => {\n                if(!modelValue) return false;\n                return (viewValue.length <= policies.max) && (viewValue.length >= policies.min);\n            }\n        };\n    };\n\n    const getValidators = (parsedPolicies,id) =>{\n        let validator = {};\n        const passwordValidators = Object.assign({}, validators(parsedPolicies,id));\n        const trueFunction = () => true;\n\n        CuiPasswordInfo.policies[id]=parsedPolicies;\n\n        validator.complex = passwordValidators.complex;\n\n        // if lower chars are not allowed add a check to see if there's a lowercase in the input\n        if (parsedPolicies.allowLowerChars) {\n            validator.lowercase = passwordValidators.lowercase;\n            validator.lowercaseNotAllowed = trueFunction;\n        }\n        else {\n            validator.lowercase = trueFunction;\n            validator.lowercaseNotAllowed = passwordValidators.lowercaseNotAllowed;\n        }\n\n        if (parsedPolicies.allowUpperChars) {\n            validator.uppercase = passwordValidators.uppercase;\n            validator.uppercaseNotAllowed = trueFunction;\n        }\n        else {\n            validator.uppercase = trueFunction;\n            validator.uppercaseNotAllowed = passwordValidators.uppercaseNotAllowed;\n        }\n\n        if (parsedPolicies.allowNumChars){\n            validator.number = passwordValidators.number;\n            validator.numberNotAllowed = trueFunction;\n        }\n        else{\n            validator.number = trueFunction;\n            validator.numberNotAllowed = passwordValidators.numberNotAllowed;\n        }\n\n        if(parsedPolicies.allowSpecialChars){\n            validator.special = passwordValidators.special;\n            validator.specialNotAllowed = trueFunction;\n        }\n        else{\n            validator.special = trueFunction;\n            validator.specialNotAllowed = passwordValidators.specialNotAllowed;\n        }\n\n        if(parsedPolicies.disallowedChars){\n            validator.disallowedChars = passwordValidators.disallowedChars;\n        }\n\n        if(parsedPolicies.disallowedWords){\n            validator.disallowedWords = passwordValidators.disallowedWords;\n        }\n\n        if(parsedPolicies.min || parsedPolicies.max){\n            validator.length = passwordValidators.length;\n        }\n\n        return validator;\n    };\n\n    return { getValidators };\n}])\n.factory('CuiPasswordPolicies', ['CuiPasswordValidators','CuiPasswordInfo', (CuiPasswordValidators,CuiPasswordInfo) => {\n    const policy = {\n        parse: (policies) => {\n            let newParsedPolicies={};\n            if(policies.length){ // if we received an array\n                policies.forEach((policyRulesObject) => {\n                    Object.keys(policyRulesObject).forEach((policyKey) => {\n                        newParsedPolicies[policyKey] = policyRulesObject[policyKey];\n                    });\n                });\n            }\n            else newParsedPolicies = Object.assign({},policies);\n            return newParsedPolicies;\n        }\n    };\n    return policy;\n}])\n.directive('passwordValidation', ['CuiPasswordPolicies','CuiPasswordValidators',(CuiPasswordPolicies,CuiPasswordValidators) => {\n    return {\n        require: 'ngModel',\n        scope: {\n            passwordValidation:'='\n        },\n        restrict: 'A',\n        link: (scope, elem, attrs, ctrl) => {\n            let passwordValidationKey = scope.$id;\n            ctrl.passwordValidationKey = passwordValidationKey;\n\n            scope.$watch('passwordValidation', (newPasswordValidationRules) => {\n                if(newPasswordValidationRules ) {\n                    let parsedPolicies = CuiPasswordPolicies.parse(newPasswordValidationRules);\n                    let validators = CuiPasswordValidators.getValidators(parsedPolicies,passwordValidationKey);\n                    angular.forEach(validators, (checkFunction,validationName) => {\n                      ctrl.$validators[validationName] = checkFunction;\n                    });\n                    ctrl.$validate();\n                }\n            });\n        }\n    };\n}])\n.directive('passwordPopover',['CuiPasswordInfo', (CuiPasswordInfo) => {\n    return {\n        restrict: 'A',\n        link: (scope,elem,attrs) => {\n            let passwordValidationKey = scope.$eval(attrs.ngMessages.replace('.$error','.passwordValidationKey')); // get the passwordValidationKey from the input it's applied to\n\n            scope.$watchCollection(() => CuiPasswordInfo.info[passwordValidationKey], (newPasswordInfo) => {\n                if(newPasswordInfo){\n                    Object.keys(newPasswordInfo).forEach(key => {\n                        scope[key]=newPasswordInfo[key];\n                    });\n                }\n            });\n\n            scope.$watchCollection(() => CuiPasswordInfo.policies[passwordValidationKey], (newPasswordPolicies) => {\n                if(newPasswordPolicies) scope.policies = Object.assign({},newPasswordPolicies);\n            });\n\n            scope.$watchCollection(() => scope.$eval(attrs.ngMessages), (newErrorObject) => {\n                if(newErrorObject) scope.errors = Object.assign({},newErrorObject);\n            });\n        }\n    };\n}]);\n\nangular.module('cui-ng')\n.directive('resultsPerPage', ['$compile','$pagination', ($compile,$pagination) => {\n    return {\n        restrict: 'E',\n        scope: {\n            selected: '=ngModel'\n        },\n        link: (scope, elem, attrs) => {\n            const resultsPerPage = {\n                initScope: () => {\n                    scope.options = $pagination.getPaginationOptions();\n                    scope.selected = $pagination.getUserValue() || scope.options.intervals[0];\n                    scope.intervals = scope.options.intervals\n\n                    scope.$watch('selected', (selected) => {\n                        $pagination.setUserValue(selected);\n                        scope.selected = selected;\n                    });\n                },\n                config: {\n                    selectClass: attrs.class || 'cui-dropdown'\n                },\n                render: () => {\n                    const element = $compile(`<cui-dropdown class=\"${resultsPerPage.config.selectClass}\" dropdown-class=\"cui-dropdown__wrapper cui-dropdown--results-per-page\" ng-model=\"selected\" options=\"intervals\"></cui-dropdown>`)(scope);\n                    angular.element(elem).replaceWith(element);\n                }\n            };\n            resultsPerPage.initScope();\n            resultsPerPage.render();\n        }\n    };\n}]);\n\nvar KEYS = {\n    backspace: 8,\n    tab: 9,\n    enter: 13,\n    escape: 27,\n    space: 32,\n    up: 38,\n    down: 40,\n    left: 37,\n    right: 39,\n    delete: 46,\n    comma: 188\n};\n\nvar MAX_SAFE_INTEGER = 9007199254740991;\nvar SUPPORTED_INPUT_TYPES = ['text', 'email', 'url'];\n\nangular.module('cui-ng')\n.directive('tagsInput', [\"$timeout\", \"$document\", \"$window\", \"tagsInputConfig\", \"tiUtil\", function($timeout, $document, $window, tagsInputConfig, tiUtil) {\n    function TagList(options, events, onTagAdding, onTagRemoving) {\n        var self = {}, getTagText, setTagText, tagIsValid;\n\n        getTagText = function(tag) {\n            return tiUtil.safeToString(tag[options.displayProperty]);\n        };\n\n        setTagText = function(tag, text) {\n            tag[options.displayProperty] = text;\n        };\n\n        tagIsValid = function(tag) {\n            var tagText = getTagText(tag);\n\n            return tagText &&\n                   tagText.length >= options.minLength &&\n                   tagText.length <= options.maxLength &&\n                   options.allowedTagsPattern.test(tagText) &&\n                   !tiUtil.findInObjectArray(self.items, tag, options.keyProperty || options.displayProperty) &&\n                   onTagAdding({ $tag: tag });\n        };\n\n        self.items = [];\n\n        self.addText = function(text) {\n            var tag = {};\n            setTagText(tag, text);\n            return self.add(tag);\n        };\n\n        self.add = function(tag) {\n            var tagText = getTagText(tag);\n\n            if (options.replaceSpacesWithDashes) {\n                tagText = tiUtil.replaceSpacesWithDashes(tagText);\n            }\n\n            setTagText(tag, tagText);\n\n            if (tagIsValid(tag)) {\n                self.items.push(tag);\n                events.trigger('tag-added', { $tag: tag });\n            }\n            else if (tagText) {\n                events.trigger('invalid-tag', { $tag: tag });\n            }\n\n            return tag;\n        };\n\n        self.remove = function(index) {\n            var tag = self.items[index];\n\n            if (onTagRemoving({ $tag: tag }))  {\n                self.items.splice(index, 1);\n                self.clearSelection();\n                events.trigger('tag-removed', { $tag: tag });\n                return tag;\n            }\n        };\n\n        self.select = function(index) {\n            if (index < 0) {\n                index = self.items.length - 1;\n            }\n            else if (index >= self.items.length) {\n                index = 0;\n            }\n\n            self.index = index;\n            self.selected = self.items[index];\n        };\n\n        self.selectPrior = function() {\n            self.select(--self.index);\n        };\n\n        self.selectNext = function() {\n            self.select(++self.index);\n        };\n\n        self.removeSelected = function() {\n            return self.remove(self.index);\n        };\n\n        self.clearSelection = function() {\n            self.selected = null;\n            self.index = -1;\n        };\n\n        self.clearSelection();\n\n        return self;\n    }\n\n    function validateType(type) {\n        return SUPPORTED_INPUT_TYPES.indexOf(type) !== -1;\n    }\n\n    return {\n        restrict: 'E',\n        require: 'ngModel',\n        scope: {\n            tags: '=ngModel',\n            text: '=?',\n            onTagAdding: '&',\n            onTagAdded: '&',\n            onInvalidTag: '&',\n            onTagRemoving: '&',\n            onTagRemoved: '&',\n            onTagClicked: '&'\n        },\n        replace: false,\n        transclude: true,\n        templateUrl: 'ngTagsInput/tags-input.html',\n        controller: [\"$scope\", \"$attrs\", \"$element\", function($scope, $attrs, $element) {\n            $scope.events = tiUtil.simplePubSub();\n\n            tagsInputConfig.load('tagsInput', $scope, $attrs, {\n                template: [String, 'ngTagsInput/tag-item.html'],\n                type: [String, 'text', validateType],\n                placeholder: [String, ''],\n                tabindex: [Number, null],\n                removeTagSymbol: [String, String.fromCharCode(215)],\n                replaceSpacesWithDashes: [Boolean, true],\n                minLength: [Number, 3],\n                maxLength: [Number, MAX_SAFE_INTEGER],\n                addOnEnter: [Boolean, true],\n                addOnSpace: [Boolean, false],\n                addOnComma: [Boolean, true],\n                addOnBlur: [Boolean, true],\n                addOnPaste: [Boolean, false],\n                pasteSplitPattern: [RegExp, /,/],\n                allowedTagsPattern: [RegExp, /.+/],\n                enableEditingLastTag: [Boolean, false],\n                minTags: [Number, 0],\n                maxTags: [Number, MAX_SAFE_INTEGER],\n                displayProperty: [String, 'text'],\n                keyProperty: [String, ''],\n                allowLeftoverText: [Boolean, false],\n                addFromAutocompleteOnly: [Boolean, false],\n                spellcheck: [Boolean, true]\n            });\n\n            $scope.tagList = new TagList($scope.options, $scope.events,\n                tiUtil.handleUndefinedResult($scope.onTagAdding, true),\n                tiUtil.handleUndefinedResult($scope.onTagRemoving, true));\n\n            this.registerAutocomplete = function() {\n                var input = $element.find('input');\n\n                return {\n                    addTag: function(tag) {\n                        return $scope.tagList.add(tag);\n                    },\n                    focusInput: function() {\n                        input[0].focus();\n                    },\n                    getTags: function() {\n                        return $scope.tagList.items;\n                    },\n                    getCurrentTagText: function() {\n                        return $scope.newTag.text();\n                    },\n                    getOptions: function() {\n                        return $scope.options;\n                    },\n                    on: function(name, handler) {\n                        $scope.events.on(name, handler);\n                        return this;\n                    }\n                };\n            };\n\n            this.registerTagItem = function() {\n                return {\n                    getOptions: function() {\n                        return $scope.options;\n                    },\n                    removeTag: function(index) {\n                        if ($scope.disabled) {\n                            return;\n                        }\n                        $scope.tagList.remove(index);\n                    }\n                };\n            };\n        }],\n        link: function(scope, element, attrs, ngModelCtrl) {\n            var hotkeys = [KEYS.enter, KEYS.comma, KEYS.space, KEYS.backspace, KEYS.delete, KEYS.left, KEYS.right],\n                tagList = scope.tagList,\n                events = scope.events,\n                options = scope.options,\n                input = element.find('input'),\n                validationOptions = ['minTags', 'maxTags', 'allowLeftoverText'],\n                setElementValidity;\n\n            setElementValidity = function() {\n                ngModelCtrl.$setValidity('maxTags', tagList.items.length <= options.maxTags);\n                ngModelCtrl.$setValidity('minTags', tagList.items.length >= options.minTags);\n                ngModelCtrl.$setValidity('leftoverText', scope.hasFocus || options.allowLeftoverText ? true : !scope.newTag.text());\n            };\n\n            ngModelCtrl.$isEmpty = function(value) {\n                return !value || !value.length;\n            };\n\n            scope.newTag = {\n                text: function(value) {\n                    if (angular.isDefined(value)) {\n                        scope.text = value;\n                        events.trigger('input-change', value);\n                    }\n                    else {\n                        return scope.text || '';\n                    }\n                },\n                invalid: null\n            };\n\n            scope.track = function(tag) {\n                return tag[options.keyProperty || options.displayProperty];\n            };\n\n            scope.$watch('tags', function(value) {\n                if (value) {\n                    tagList.items = tiUtil.makeObjectArray(value, options.displayProperty);\n                    scope.tags = tagList.items;\n                }\n                else {\n                    tagList.items = [];\n                }\n            });\n\n            scope.$watch('tags.length', function() {\n                setElementValidity();\n\n                // ngModelController won't trigger validators when the model changes (because it's an array),\n                // so we need to do it ourselves. Unfortunately this won't trigger any registered formatter.\n                ngModelCtrl.$validate();\n            });\n\n            attrs.$observe('disabled', function(value) {\n                scope.disabled = value;\n            });\n\n            scope.eventHandlers = {\n                input: {\n                    keydown: function($event) {\n                        events.trigger('input-keydown', $event);\n                    },\n                    focus: function() {\n                        if (scope.hasFocus) {\n                            return;\n                        }\n\n                        scope.hasFocus = true;\n                        events.trigger('input-focus');\n                    },\n                    blur: function() {\n                        $timeout(function() {\n                            var activeElement = $document.prop('activeElement'),\n                                lostFocusToBrowserWindow = activeElement === input[0],\n                                lostFocusToChildElement = element[0].contains(activeElement);\n\n                            if (lostFocusToBrowserWindow || !lostFocusToChildElement) {\n                                scope.hasFocus = false;\n                                events.trigger('input-blur');\n                            }\n                        });\n                    },\n                    paste: function($event) {\n                        $event.getTextData = function() {\n                            var clipboardData = $event.clipboardData || ($event.originalEvent && $event.originalEvent.clipboardData);\n                            return clipboardData ? clipboardData.getData('text/plain') : $window.clipboardData.getData('Text');\n                        };\n                        events.trigger('input-paste', $event);\n                    }\n                },\n                host: {\n                    click: function() {\n                        if (scope.disabled) {\n                            return;\n                        }\n                        input[0].focus();\n                    }\n                },\n                tag: {\n                    click: function(tag) {\n                        events.trigger('tag-clicked', { $tag: tag });\n                    }\n                }\n            };\n\n            events\n                .on('tag-added', scope.onTagAdded)\n                .on('invalid-tag', scope.onInvalidTag)\n                .on('tag-removed', scope.onTagRemoved)\n                .on('tag-clicked', scope.onTagClicked)\n                .on('tag-added', function() {\n                    scope.newTag.text('');\n                })\n                .on('tag-added tag-removed', function() {\n                    scope.tags = tagList.items;\n                    // Ideally we should be able call $setViewValue here and let it in turn call $setDirty and $validate\n                    // automatically, but since the model is an array, $setViewValue does nothing and it's up to us to do it.\n                    // Unfortunately this won't trigger any registered $parser and there's no safe way to do it.\n                    ngModelCtrl.$setDirty();\n                })\n                .on('invalid-tag', function() {\n                    scope.newTag.invalid = true;\n                })\n                .on('option-change', function(e) {\n                    if (validationOptions.indexOf(e.name) !== -1) {\n                        setElementValidity();\n                    }\n                })\n                .on('input-change', function() {\n                    tagList.clearSelection();\n                    scope.newTag.invalid = null;\n                })\n                .on('input-focus', function() {\n                    element.triggerHandler('focus');\n                    ngModelCtrl.$setValidity('leftoverText', true);\n                })\n                .on('input-blur', function() {\n                    if (options.addOnBlur && !options.addFromAutocompleteOnly) {\n                        tagList.addText(scope.newTag.text());\n                    }\n                    element.triggerHandler('blur');\n                    setElementValidity();\n                })\n                .on('input-keydown', function(event) {\n                    var key = event.keyCode,\n                        addKeys = {},\n                        shouldAdd, shouldRemove, shouldSelect, shouldEditLastTag;\n\n                    if (tiUtil.isModifierOn(event) || hotkeys.indexOf(key) === -1) {\n                        return;\n                    }\n\n                    addKeys[KEYS.enter] = options.addOnEnter;\n                    addKeys[KEYS.comma] = options.addOnComma;\n                    addKeys[KEYS.space] = options.addOnSpace;\n\n                    shouldAdd = !options.addFromAutocompleteOnly && addKeys[key];\n                    shouldRemove = (key === KEYS.backspace || key === KEYS.delete) && tagList.selected;\n                    shouldEditLastTag = key === KEYS.backspace && scope.newTag.text().length === 0 && options.enableEditingLastTag;\n                    shouldSelect = (key === KEYS.backspace || key === KEYS.left || key === KEYS.right) && scope.newTag.text().length === 0 && !options.enableEditingLastTag;\n\n                    if (shouldAdd) {\n                        tagList.addText(scope.newTag.text());\n                    }\n                    else if (shouldEditLastTag) {\n                        var tag;\n\n                        tagList.selectPrior();\n                        tag = tagList.removeSelected();\n\n                        if (tag) {\n                            scope.newTag.text(tag[options.displayProperty]);\n                        }\n                    }\n                    else if (shouldRemove) {\n                        tagList.removeSelected();\n                    }\n                    else if (shouldSelect) {\n                        if (key === KEYS.left || key === KEYS.backspace) {\n                            tagList.selectPrior();\n                        }\n                        else if (key === KEYS.right) {\n                            tagList.selectNext();\n                        }\n                    }\n\n                    if (shouldAdd || shouldSelect || shouldRemove || shouldEditLastTag) {\n                        event.preventDefault();\n                    }\n                })\n                .on('input-paste', function(event) {\n                    if (options.addOnPaste) {\n                        var data = event.getTextData();\n                        var tags = data.split(options.pasteSplitPattern);\n\n                        if (tags.length > 1) {\n                            tags.forEach(function(tag) {\n                                tagList.addText(tag);\n                            });\n                            event.preventDefault();\n                        }\n                    }\n                });\n        }\n    };\n}])\n\n\n/**\n * @ngdoc directive\n * @name tiTagItem\n * @module ngTagsInput\n *\n * @description\n * Represents a tag item. Used internally by the tagsInput directive.\n */\n.directive('tiTagItem', [\"tiUtil\", function(tiUtil) {\n    return {\n        restrict: 'E',\n        require: '^tagsInput',\n        template: '<ng-include src=\"$$template\"></ng-include>',\n        scope: { data: '=' },\n        link: function(scope, element, attrs, tagsInputCtrl) {\n            var tagsInput = tagsInputCtrl.registerTagItem(),\n                options = tagsInput.getOptions();\n\n            scope.$$template = options.template;\n            scope.$$removeTagSymbol = options.removeTagSymbol;\n\n            scope.$getDisplayText = function() {\n                return tiUtil.safeToString(scope.data[options.displayProperty]);\n            };\n            scope.$removeTag = function() {\n                tagsInput.removeTag(scope.$index);\n            };\n\n            scope.$watch('$parent.$index', function(value) {\n                scope.$index = value;\n            });\n        }\n    };\n}])\n\n\n/**\n * @ngdoc directive\n * @name autoComplete\n * @module ngTagsInput\n *\n * @description\n * Provides autocomplete support for the tagsInput directive.\n *\n * @param {expression} source Expression to evaluate upon changing the input content. The input value is available as\n *    $query. The result of the expression must be a promise that eventually resolves to an array of strings.\n * @param {string=} [template=NA] URL or id of a custom template for rendering each element of the autocomplete list.\n * @param {string=} [displayProperty=tagsInput.displayText] Property to be rendered as the autocomplete label.\n * @param {number=} [debounceDelay=100] Amount of time, in milliseconds, to wait before evaluating the expression in\n *    the source option after the last keystroke.\n * @param {number=} [minLength=3] Minimum number of characters that must be entered before evaluating the expression\n *    in the source option.\n * @param {boolean=} [highlightMatchedText=true] Flag indicating that the matched text will be highlighted in the\n *    suggestions list.\n * @param {number=} [maxResultsToShow=10] Maximum number of results to be displayed at a time.\n * @param {boolean=} [loadOnDownArrow=false] Flag indicating that the source option will be evaluated when the down arrow\n *    key is pressed and the suggestion list is closed. The current input value is available as $query.\n * @param {boolean=} [loadOnEmpty=false] Flag indicating that the source option will be evaluated when the input content\n *    becomes empty. The $query variable will be passed to the expression as an empty string.\n * @param {boolean=} [loadOnFocus=false] Flag indicating that the source option will be evaluated when the input element\n *    gains focus. The current input value is available as $query.\n * @param {boolean=} [selectFirstMatch=true] Flag indicating that the first match will be automatically selected once\n *    the suggestion list is shown.\n */\n.directive('autoComplete', [\"$document\", \"$timeout\", \"$sce\", \"$q\", \"tagsInputConfig\", \"tiUtil\", function($document, $timeout, $sce, $q, tagsInputConfig, tiUtil) {\n    function SuggestionList(loadFn, options, events) {\n        var self = {}, getDifference, lastPromise, getTagId;\n\n        getTagId = function() {\n            return options.tagsInput.keyProperty || options.tagsInput.displayProperty;\n        };\n\n        getDifference = function(array1, array2) {\n            return array1.filter(function(item) {\n                return !tiUtil.findInObjectArray(array2, item, getTagId(), function(a, b) {\n                    if (options.tagsInput.replaceSpacesWithDashes) {\n                        a = tiUtil.replaceSpacesWithDashes(a);\n                        b = tiUtil.replaceSpacesWithDashes(b);\n                    }\n                    return tiUtil.defaultComparer(a, b);\n                });\n            });\n        };\n\n        self.reset = function() {\n            lastPromise = null;\n\n            self.items = [];\n            self.visible = false;\n            self.index = -1;\n            self.selected = null;\n            self.query = null;\n        };\n        self.show = function() {\n            if (options.selectFirstMatch) {\n                self.select(0);\n            }\n            else {\n                self.selected = null;\n            }\n            self.visible = true;\n        };\n        self.load = tiUtil.debounce(function(query, tags) {\n            self.query = query;\n\n            var promise = $q.when(loadFn({ $query: query }));\n            lastPromise = promise;\n\n            promise.then(function(items) {\n                if (promise !== lastPromise) {\n                    return;\n                }\n\n                items = tiUtil.makeObjectArray(items.data || items, getTagId());\n                items = getDifference(items, tags);\n                self.items = items.slice(0, options.maxResultsToShow);\n\n                if (self.items.length > 0) {\n                    self.show();\n                }\n                else {\n                    self.reset();\n                }\n            });\n        }, options.debounceDelay);\n\n        self.selectNext = function() {\n            self.select(++self.index);\n        };\n        self.selectPrior = function() {\n            self.select(--self.index);\n        };\n        self.select = function(index) {\n            if (index < 0) {\n                index = self.items.length - 1;\n            }\n            else if (index >= self.items.length) {\n                index = 0;\n            }\n            self.index = index;\n            self.selected = self.items[index];\n            events.trigger('suggestion-selected', index);\n        };\n\n        self.reset();\n\n        return self;\n    }\n\n    function scrollToElement(root, index) {\n        var element = root.find('li').eq(index),\n            parent = element.parent(),\n            elementTop = element.prop('offsetTop'),\n            elementHeight = element.prop('offsetHeight'),\n            parentHeight = parent.prop('clientHeight'),\n            parentScrollTop = parent.prop('scrollTop');\n\n        if (elementTop < parentScrollTop) {\n            parent.prop('scrollTop', elementTop);\n        }\n        else if (elementTop + elementHeight > parentHeight + parentScrollTop) {\n            parent.prop('scrollTop', elementTop + elementHeight - parentHeight);\n        }\n    }\n\n    return {\n        restrict: 'E',\n        require: '^tagsInput',\n        scope: { source: '&' },\n        templateUrl: 'ngTagsInput/auto-complete.html',\n        controller: [\"$scope\", \"$element\", \"$attrs\", function($scope, $element, $attrs) {\n            $scope.events = tiUtil.simplePubSub();\n\n            tagsInputConfig.load('autoComplete', $scope, $attrs, {\n                template: [String, 'ngTagsInput/auto-complete-match.html'],\n                debounceDelay: [Number, 100],\n                minLength: [Number, 3],\n                highlightMatchedText: [Boolean, true],\n                maxResultsToShow: [Number, 10],\n                loadOnDownArrow: [Boolean, false],\n                loadOnEmpty: [Boolean, false],\n                loadOnFocus: [Boolean, false],\n                selectFirstMatch: [Boolean, true],\n                displayProperty: [String, '']\n            });\n\n            $scope.suggestionList = new SuggestionList($scope.source, $scope.options, $scope.events);\n\n            this.registerAutocompleteMatch = function() {\n                return {\n                    getOptions: function() {\n                        return $scope.options;\n                    },\n                    getQuery: function() {\n                        return $scope.suggestionList.query;\n                    }\n                };\n            };\n        }],\n        link: function(scope, element, attrs, tagsInputCtrl) {\n            var hotkeys = [KEYS.enter, KEYS.tab, KEYS.escape, KEYS.up, KEYS.down],\n                suggestionList = scope.suggestionList,\n                tagsInput = tagsInputCtrl.registerAutocomplete(),\n                options = scope.options,\n                events = scope.events,\n                shouldLoadSuggestions;\n\n            options.tagsInput = tagsInput.getOptions();\n\n            shouldLoadSuggestions = function(value) {\n                return value && value.length >= options.minLength || !value && options.loadOnEmpty;\n            };\n\n            scope.addSuggestionByIndex = function(index) {\n                suggestionList.select(index);\n                scope.addSuggestion();\n            };\n\n            scope.addSuggestion = function() {\n                var added = false;\n\n                if (suggestionList.selected) {\n                    tagsInput.addTag(angular.copy(suggestionList.selected));\n                    suggestionList.reset();\n                    tagsInput.focusInput();\n\n                    added = true;\n                }\n                return added;\n            };\n\n            scope.track = function(item) {\n                return item[options.tagsInput.keyProperty || options.tagsInput.displayProperty];\n            };\n\n            tagsInput\n                .on('tag-added tag-removed invalid-tag input-blur', function() {\n                    suggestionList.reset();\n                })\n                .on('input-change', function(value) {\n                    if (shouldLoadSuggestions(value)) {\n                        suggestionList.load(value, tagsInput.getTags());\n                    }\n                    else {\n                        suggestionList.reset();\n                    }\n                })\n                .on('input-focus', function() {\n                    var value = tagsInput.getCurrentTagText();\n                    if (options.loadOnFocus && shouldLoadSuggestions(value)) {\n                        suggestionList.load(value, tagsInput.getTags());\n                    }\n                })\n                .on('input-keydown', function(event) {\n                    var key = event.keyCode,\n                        handled = false;\n\n                    if (tiUtil.isModifierOn(event) || hotkeys.indexOf(key) === -1) {\n                        return;\n                    }\n\n                    if (suggestionList.visible) {\n\n                        if (key === KEYS.down) {\n                            suggestionList.selectNext();\n                            handled = true;\n                        }\n                        else if (key === KEYS.up) {\n                            suggestionList.selectPrior();\n                            handled = true;\n                        }\n                        else if (key === KEYS.escape) {\n                            suggestionList.reset();\n                            handled = true;\n                        }\n                        else if (key === KEYS.enter || key === KEYS.tab) {\n                            handled = scope.addSuggestion();\n                        }\n                    }\n                    else {\n                        if (key === KEYS.down && scope.options.loadOnDownArrow) {\n                            suggestionList.load(tagsInput.getCurrentTagText(), tagsInput.getTags());\n                            handled = true;\n                        }\n                    }\n\n                    if (handled) {\n                        event.preventDefault();\n                        event.stopImmediatePropagation();\n                        return false;\n                    }\n                });\n\n            events.on('suggestion-selected', function(index) {\n                scrollToElement(element, index);\n            });\n        }\n    };\n}])\n\n\n.directive('tiAutocompleteMatch', [\"$sce\", \"tiUtil\", function($sce, tiUtil) {\n    return {\n        restrict: 'E',\n        require: '^autoComplete',\n        template: '<ng-include src=\"$$template\"></ng-include>',\n        scope: { data: '=' },\n        link: function(scope, element, attrs, autoCompleteCtrl) {\n            var autoComplete = autoCompleteCtrl.registerAutocompleteMatch(),\n                options = autoComplete.getOptions();\n\n            scope.$$template = options.template;\n            scope.$index = scope.$parent.$index;\n\n            scope.$highlight = function(text) {\n                if (options.highlightMatchedText) {\n                    text = tiUtil.safeHighlight(text, autoComplete.getQuery());\n                }\n                return $sce.trustAsHtml(text);\n            };\n            scope.$getDisplayText =  function() {\n                return tiUtil.safeToString(scope.data[options.displayProperty || options.tagsInput.displayProperty]);\n            };\n        }\n    };\n}])\n\n.directive('tiTranscludeAppend', function() {\n    return function(scope, element, attrs, ctrl, transcludeFn) {\n        transcludeFn(function(clone) {\n            element.append(clone);\n        });\n    };\n})\n\n.directive('tiAutosize', [\"tagsInputConfig\", function(tagsInputConfig) {\n    return {\n        restrict: 'A',\n        require: 'ngModel',\n        link: function(scope, element, attrs, ctrl) {\n            var threshold = tagsInputConfig.getTextAutosizeThreshold(),\n                span, resize;\n\n            span = angular.element('<span class=\"cui-tags__registered-tag\"></span>');\n            span.css('display', 'none')\n                .css('visibility', 'hidden')\n                .css('width', 'auto')\n                .css('white-space', 'pre');\n\n            element.parent().append(span);\n\n            resize = function(originalValue) {\n                var value = originalValue, width;\n\n                if (angular.isString(value) && value.length === 0) {\n                    value = attrs.placeholder;\n                }\n\n                if (value) {\n                    span.text(value);\n                    span.css('display', '');\n                    width = span.prop('offsetWidth');\n                    span.css('display', 'none');\n                }\n\n                element.css('width', width ? width + threshold + 'px' : '');\n\n                return originalValue;\n            };\n\n            ctrl.$parsers.unshift(resize);\n            ctrl.$formatters.unshift(resize);\n\n            attrs.$observe('placeholder', function(value) {\n                if (!ctrl.$modelValue) {\n                    resize(value);\n                }\n            });\n        }\n    };\n}])\n\n.directive('tiBindAttrs', function() {\n    return function(scope, element, attrs) {\n        scope.$watch(attrs.tiBindAttrs, function(value) {\n            angular.forEach(value, function(value, key) {\n                attrs.$set(key, value);\n            });\n        }, true);\n    };\n})\n\n.provider('tagsInputConfig', function() {\n    var globalDefaults = {},\n        interpolationStatus = {},\n        autosizeThreshold = 3;\n\n    /**\n     * @ngdoc method\n     * @name tagsInputConfig#setDefaults\n     * @description Sets the default configuration option for a directive.\n     *\n     * @param {string} directive Name of the directive to be configured. Must be either 'tagsInput' or 'autoComplete'.\n     * @param {object} defaults Object containing options and their values.\n     *\n     * @returns {object} The service itself for chaining purposes.\n     */\n    this.setDefaults = function(directive, defaults) {\n        globalDefaults[directive] = defaults;\n        return this;\n    };\n\n    /**\n     * @ngdoc method\n     * @name tagsInputConfig#setActiveInterpolation\n     * @description Sets active interpolation for a set of options.\n     *\n     * @param {string} directive Name of the directive to be configured. Must be either 'tagsInput' or 'autoComplete'.\n     * @param {object} options Object containing which options should have interpolation turned on at all times.\n     *\n     * @returns {object} The service itself for chaining purposes.\n     */\n    this.setActiveInterpolation = function(directive, options) {\n        interpolationStatus[directive] = options;\n        return this;\n    };\n\n    /**\n     * @ngdoc method\n     * @name tagsInputConfig#setTextAutosizeThreshold\n     * @description Sets the threshold used by the tagsInput directive to re-size the inner input field element based on its contents.\n     *\n     * @param {number} threshold Threshold value, in pixels.\n     *\n     * @returns {object} The service itself for chaining purposes.\n     */\n    this.setTextAutosizeThreshold = function(threshold) {\n        autosizeThreshold = threshold;\n        return this;\n    };\n\n    this.$get = [\"$interpolate\", function($interpolate) {\n        var converters = {};\n        converters[String] = function(value) { return value; };\n        converters[Number] = function(value) { return parseInt(value, 10); };\n        converters[Boolean] = function(value) { return value.toLowerCase() === 'true'; };\n        converters[RegExp] = function(value) { return new RegExp(value); };\n\n        return {\n            load: function(directive, scope, attrs, options) {\n                var defaultValidator = function() { return true; };\n\n                scope.options = {};\n\n                angular.forEach(options, function(value, key) {\n                    var type, localDefault, validator, converter, getDefault, updateValue;\n\n                    type = value[0];\n                    localDefault = value[1];\n                    validator = value[2] || defaultValidator;\n                    converter = converters[type];\n\n                    getDefault = function() {\n                        var globalValue = globalDefaults[directive] && globalDefaults[directive][key];\n                        return angular.isDefined(globalValue) ? globalValue : localDefault;\n                    };\n\n                    updateValue = function(value) {\n                        scope.options[key] = value && validator(value) ? converter(value) : getDefault();\n                    };\n\n                    if (interpolationStatus[directive] && interpolationStatus[directive][key]) {\n                        attrs.$observe(key, function(value) {\n                            updateValue(value);\n                            scope.events.trigger('option-change', { name: key, newValue: value });\n                        });\n                    }\n                    else {\n                        updateValue(attrs[key] && $interpolate(attrs[key])(scope.$parent));\n                    }\n                });\n            },\n            getTextAutosizeThreshold: function() {\n                return autosizeThreshold;\n            }\n        };\n    }];\n})\n\n.factory('tiUtil', [\"$timeout\", function($timeout) {\n    var self = {};\n\n    self.debounce = function(fn, delay) {\n        var timeoutId;\n        return function() {\n            var args = arguments;\n            $timeout.cancel(timeoutId);\n            timeoutId = $timeout(function() { fn.apply(null, args); }, delay);\n        };\n    };\n\n    self.makeObjectArray = function(array, key) {\n        if (!angular.isArray(array) || array.length === 0 || angular.isObject(array[0])) {\n            return array;\n        }\n\n        var newArray = [];\n        array.forEach(function(item) {\n            var obj = {};\n            obj[key] = item;\n            newArray.push(obj);\n        });\n        return newArray;\n    };\n\n    self.findInObjectArray = function(array, obj, key, comparer) {\n        var item = null;\n        comparer = comparer || self.defaultComparer;\n\n        array.some(function(element) {\n            if (comparer(element[key], obj[key])) {\n                item = element;\n                return true;\n            }\n        });\n\n        return item;\n    };\n\n    self.defaultComparer = function(a, b) {\n        // I'm aware of the internationalization issues regarding toLowerCase()\n        // but I couldn't come up with a better solution right now\n        return self.safeToString(a).toLowerCase() === self.safeToString(b).toLowerCase();\n    };\n\n    self.safeHighlight = function(str, value) {\n        if (!value) {\n            return str;\n        }\n\n        function escapeRegexChars(str) {\n            return str.replace(/([.?*+^$[\\]\\\\(){}|-])/g, '\\\\$1');\n        }\n\n        str = self.encodeHTML(str);\n        value = self.encodeHTML(value);\n\n        var expression = new RegExp('&[^;]+;|' + escapeRegexChars(value), 'gi');\n        return str.replace(expression, function(match) {\n            return match.toLowerCase() === value.toLowerCase() ? '<em>' + match + '</em>' : match;\n        });\n    };\n\n    self.safeToString = function(value) {\n        return angular.isUndefined(value) || value === null ? '' : value.toString().trim();\n    };\n\n    self.encodeHTML = function(value) {\n        return self.safeToString(value)\n            .replace(/&/g, '&amp;')\n            .replace(/</g, '&lt;')\n            .replace(/>/g, '&gt;');\n    };\n\n    self.handleUndefinedResult = function(fn, valueIfUndefined) {\n        return function() {\n            var result = fn.apply(null, arguments);\n            return angular.isUndefined(result) ? valueIfUndefined : result;\n        };\n    };\n\n    self.replaceSpacesWithDashes = function(str) {\n        return self.safeToString(str).replace(/\\s/g, '-');\n    };\n\n    self.isModifierOn = function(event) {\n        return event.shiftKey || event.ctrlKey || event.altKey || event.metaKey;\n    };\n\n    self.simplePubSub = function() {\n        var events = {};\n        return {\n            on: function(names, handler) {\n                names.split(' ').forEach(function(name) {\n                    if (!events[name]) {\n                        events[name] = [];\n                    }\n                    events[name].push(handler);\n                });\n                return this;\n            },\n            trigger: function(name, args) {\n                var handlers = events[name] || [];\n                handlers.every(function(handler) {\n                    return self.handleUndefinedResult(handler, true)(args);\n                });\n                return this;\n            }\n        };\n    };\n\n    return self;\n}])\n\n.run([\"$templateCache\", function($templateCache) {\n    $templateCache.put('ngTagsInput/tags-input.html',\n    \"<div class=\\\"cui-tags__host\\\" tabindex=\\\"-1\\\" ng-click=\\\"eventHandlers.host.click()\\\" ti-transclude-append><div class=\\\"cui-tags__container\\\" ng-class=\\\"{'cui-tags__container--focused': hasFocus}\\\"><ul class=\\\"cui-tags__tag-list\\\"><li class=\\\"cui-tags__tag\\\" ng-repeat=\\\"tag in tagList.items track by track(tag)\\\" ng-class=\\\"{'cui-tags__tag--selected': tag == tagList.selected }\\\" ng-click=\\\"eventHandlers.tag.click(tag)\\\"><ti-tag-item data=\\\"::tag\\\"></ti-tag-item></li></ul><input class=\\\"cui-tags__input\\\" autocomplete=\\\"off\\\" ng-model=\\\"newTag.text\\\" ng-model-options=\\\"{getterSetter: true}\\\" ng-keydown=\\\"eventHandlers.input.keydown($event)\\\" ng-focus=\\\"eventHandlers.input.focus($event)\\\" ng-blur=\\\"eventHandlers.input.blur($event)\\\" ng-paste=\\\"eventHandlers.input.paste($event)\\\" ng-trim=\\\"false\\\" ng-class=\\\"{'cui-tags__input--invalid': newTag.invalid}\\\" ng-disabled=\\\"disabled\\\" ti-bind-attrs=\\\"{type: options.type, placeholder: options.placeholder, tabindex: options.tabindex, spellcheck: options.spellcheck}\\\" ti-autosize></div></div>\"\n  );\n\n  $templateCache.put('ngTagsInput/tag-item.html',\n    \"<span ng-bind=\\\"$getDisplayText()\\\"></span> <a class=\\\"cui-tags__remove\\\" ng-click=\\\"$removeTag()\\\" ng-bind=\\\"::$$removeTagSymbol\\\"></a>\"\n  );\n\n  $templateCache.put('ngTagsInput/auto-complete.html',\n    \"<div class=\\\"autocomplete\\\" ng-if=\\\"suggestionList.visible\\\"><ul class=\\\"suggestion-list\\\"><li class=\\\"suggestion-item\\\" ng-repeat=\\\"item in suggestionList.items track by track(item)\\\" ng-class=\\\"{selected: item == suggestionList.selected}\\\" ng-click=\\\"addSuggestionByIndex($index)\\\" ng-mouseenter=\\\"suggestionList.select($index)\\\"><ti-autocomplete-match data=\\\"::item\\\"></ti-autocomplete-match></li></ul></div>\"\n  );\n\n  $templateCache.put('ngTagsInput/auto-complete-match.html',\n    \"<span ng-bind-html=\\\"$highlight($getDisplayText())\\\"></span>\"\n  );\n}]);\n\nangular.module('cui-ng')\n.directive('tether',['$timeout','$parse',($timeout,$parse) => {\n  return {\n    restrict:'A',\n    scope:true,\n    link : (scope,elem,attrs) => {\n      let tether;\n      elem[0].classList.add('hide--opacity'); // this fixes the incorrect positioning when it first renders\n      $timeout(() => {\n        tether = new Tether({\n          element: elem,\n          target: attrs.target,\n          attachment: attrs.attachment || 'top center',\n          targetAttachment: attrs.targetAttachment || 'bottom center',\n          offset: attrs.offset || '0 0',\n          targetOffset: attrs.targetOffset || '0 0',\n          targetModifier: attrs.targetModifier || undefined,\n          constraints: scope.$eval(attrs.constraints) || undefined\n        });\n      }).\n      then(() => {\n        tether.position();\n        elem[0].classList.remove('hide--opacity');\n      });\n    }\n  };\n}]);\n\nangular.module('cui-ng')\n.directive('uiSrefActiveFor',['$state','PubSub',($state,PubSub) => {\n    return {\n        restrict:'A',\n        compile:() => {\n            return {\n                pre:(scope,elem,attrs) => {\n                    let active,\n                        classList = attrs.uiSrefActiveForClasses ? attrs.uiSrefActiveForClasses.split(',').map(x => x.trim()) : ['active']\n\n                    const handleStateChange = (e, { toState }) => {\n                        if(toState.name.indexOf(attrs.uiSrefActiveFor) >= 0 && !active) {\n                            classList.forEach(className => elem[0].classList.add(className))\n                            active = true\n                        }\n                        else if(toState.name.indexOf(attrs.uiSrefActiveFor) < 0 && active) {\n                            classList.forEach(className => elem[0].classList.remove(className))\n                            active = false\n                        }\n                    };\n\n                    const unsub = PubSub.subscribe('stateChange', handleStateChange)\n\n                    handleStateChange(null, { toState: $state.current })\n\n                    scope.$on('$destroy',()=> {\n                        PubSub.unsubscribe(unsub)\n                    })\n                }\n            }\n        }\n    }\n}])\n\nangular.module('cui-ng')\n.directive('uiSrefActiveNested',['$state','PubSub',($state,PubSub) => {\n    return{\n        restrict:'A',\n        compile:() => {\n            return {\n                pre:(scope,elem,attrs) => {\n                    let parentState;\n                    if(!attrs.uiSref) {\n                        throw 'ui-sref-active-nested can only be used on elements with a ui-sref attribute';\n                        return;\n                    }\n                    // if this element is a link to a state that is nested\n                    if(attrs.uiSref.indexOf('.')>-1){\n                        parentState = attrs.uiSref.split('.')[0];\n                    }\n                    // else if it's a parent state\n                    else parentState=attrs.uiSref;\n\n                    let applyActiveClassIfNestedState = (e, { toState }) => {\n                        if(toState.name.indexOf('.')>-1 && toState.name.split('.')[0] === parentState){\n                            elem[0].classList.add(attrs.uiSrefActiveNested);\n                        }\n                        else if(toState.name.indexOf('.')===-1 && toState.name===parentState){\n                            elem[0].classList.add(attrs.uiSrefActiveNested);\n                        }\n                        else elem[0].classList.remove(attrs.uiSrefActiveNested);\n                    };\n\n                    const unsub = PubSub.subscribe('stateChange', applyActiveClassIfNestedState);\n\n                    applyActiveClassIfNestedState(null, { toState: $state.current });\n\n                    scope.$on('$destroy',() => {\n                        PubSub.unsubscribe(unsub);\n                    });\n                }\n            };\n        }\n    };\n}]);\n\nconst goToState = ($state,$rootScope,stateName,toState,toParams,fromState,fromParams) => {\n  $state.go(stateName,toParams,{ notify:false }).then(()=>{\n    $rootScope.$broadcast('$stateChangeSuccess',{toState,toParams,fromState,fromParams});\n  });\n};\n\n\nangular.module('cui.authorization',[])\n.factory('cui.authorization.routing', ['cui.authorization.authorize', '$timeout','$rootScope','$state',(authorize,$timeout,$rootScope,$state) => {\n  const routing = (toState, toParams, fromState, fromParams, userEntitlements,loginRequiredState='loginRequired',nonAuthState='notAuthorized') => {\n\n    let authorized;\n\n    if (toState.access !== undefined) {\n      authorized = authorize.authorize(toState.access.loginRequired, toState.access.requiredEntitlements, toState.access.entitlementType, userEntitlements);\n\n      let stateName;\n\n      switch (authorized){\n        case 'login required':\n          stateName = loginRequiredState;\n        case 'not authorized':\n          stateName = nonAuthState;\n        default :\n          break;\n        case 'authorized':\n          stateName = toState.name;\n          break;\n      };\n\n      goToState($state,$rootScope,stateName,toState,toParams,fromState,fromParams);\n    }\n    else {\n      goToState($state,$rootScope,toState.name,toState,toParams,fromState,fromParams);\n    }\n  };\n\n  return routing;\n}])\n.factory('cui.authorization.authorize', [() => {\n  const authorize = (loginRequired, requiredEntitlements, entitlementType='atLeastOne', userEntitlements) => {\n    let loweredPermissions = [],\n        hasPermission = true,\n        result='not authorized';\n\n    if (loginRequired === true && userEntitlements === undefined) {\n        result = 'login required';\n    }\n    else if ((loginRequired === true && userEntitlements !== undefined) && (requiredEntitlements === undefined || requiredEntitlements.length === 0)) {\n    // Login is required but no specific permissions are specified.\n        result = 'authorized';\n    }\n    else if (requiredEntitlements) {\n        angular.forEach(userEntitlements, (permission) => {\n            loweredPermissions.push(permission.toLowerCase());\n        });\n        for (let i = 0; i < requiredEntitlements.length; i++) {\n            const permission = requiredEntitlements[i].toLowerCase();\n\n            if (entitlementType === 'all') {\n                hasPermission = hasPermission && loweredPermissions.indexOf(permission) > -1;\n                // i1f all the permissions are required and hasPermission is false there is no point carrying on\n                if (hasPermission === false) break;\n            }\n            else if (entitlementType === 'atLeastOne') {\n                hasPermission = loweredPermissions.indexOf(permission) > -1;\n                // if we only need one of the permissions and we have it there is no point carrying on\n                if (hasPermission) break;\n            }\n        }\n        result = hasPermission ? 'authorized' : 'not authorized';\n    }\n    return result;\n  };\n\n    return { authorize }\n}])\n.directive('cuiAccess',['cui.authorization.authorize',(authorize)=>{\n    return{\n        restrict:'A',\n        scope: {\n            userEntitlements:'=',\n            cuiAccess:'='\n        },\n        link: (scope,elem,attrs) => {\n            const requiredEntitlements = scope.cuiAccess && scope.cuiAccess.requiredEntitlements || [];\n            const entitlementType = scope.cuiAccess && scope.cuiAccess.entitlementType || 'atLeastOne';\n\n            const notAuthorizedClasses = attrs.notAuthorizedClasses && attrs.notAuthorizedClasses.split(',').map(className => className.trim());\n            const initalDisplay = elem.css('display');\n\n            const giveAuth = () => {\n                if(notAuthorizedClasses) {\n                    notAuthorizedClasses.forEach(className => elem[0].classList.remove(className));\n                }\n                else elem.css('display',initalDisplay);\n            };\n\n            const removeAuth = () => {\n                if(notAuthorizedClasses) {\n                    notAuthorizedClasses.forEach(className => elem[0].classList.add(className));\n                }\n                else elem.css('display','none');\n            };\n\n\n            scope.$watch('userEntitlements',() => {\n                const authorized=authorize.authorize(true, requiredEntitlements, entitlementType, scope.userEntitlements);\n                if(authorized!=='authorized') removeAuth();\n                else giveAuth();\n            });\n        }\n    };\n}]);\n\n\n})(angular);"]}